{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"GateWizard Documentation","text":"<p>Welcome to GateWizard, a comprehensive tool for membrane protein preparation and molecular dynamics analysis.</p>"},{"location":"#overview","title":"Overview","text":"<p>GateWizard is a Python-based GUI application designed to streamline the workflow of preparing protein structures for molecular dynamics simulations, with a special focus on membrane proteins. It integrates various computational tools to provide a unified interface for structure preparation, analysis, and visualization.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Protein Structure Preparation: Clean PDB files, add missing atoms, and optimize protein structures</li> <li>Propka Integration: Automatic pKa calculations with protonation state assignment</li> <li>Protein Capping: Add ACE/NME caps to protein termini for proper MD simulations</li> <li>Force Field Support: Compatible with Amber force fields (ff14SB, ff19SB, etc.)</li> <li>Membrane System Building: Automated membrane protein insertion and equilibration protocols</li> <li>Trajectory Analysis: RMSD, RMSF, distances, and radius of gyration calculations</li> <li>Energy Analysis: NAMD log file parsing and visualization</li> <li>Modern GUI: Built with CustomTkinter for an intuitive, cross-platform user experience</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#installation","title":"Installation","text":"<pre><code># Create conda environment with dependencies\nconda create -n gatewizard -c conda-forge python sqlite ambertools=24 parmed=4.3.0 -y\n\n# Activate environment\nconda activate gatewizard\n\n# Install GateWizard from PyPI\npip install gatewizard\n</code></pre>"},{"location":"#launch","title":"Launch","text":"<pre><code>gatewizard\n</code></pre>"},{"location":"#upgrade","title":"Upgrade","text":"<pre><code>pip install --upgrade gatewizard\n</code></pre> <p>For more detailed installation instructions, see the Installation Guide.</p>"},{"location":"#documentation-sections","title":"Documentation Sections","text":"<ul> <li>Installation Guide - Detailed installation instructions for all platforms</li> <li>User Guide - Complete guide to using GateWizard features</li> <li>Analysis Features - Trajectory and energy analysis capabilities</li> <li>API Reference - Developer documentation</li> <li>Troubleshooting - Common issues and solutions</li> </ul>"},{"location":"#system-requirements","title":"System Requirements","text":"<ul> <li>Operating System: Linux, macOS, or Windows (with WSL recommended)</li> <li>Python: 3.8 or higher</li> <li>Conda: For managing dependencies (Miniconda or Anaconda)</li> <li>RAM: Minimum 4GB (8GB+ recommended for large systems)</li> <li>Disk Space: ~2GB for installation plus space for your projects</li> </ul>"},{"location":"#getting-help","title":"Getting Help","text":"<p>If you encounter issues or have questions:</p> <ol> <li>Check the Troubleshooting Guide</li> <li>Review the User Guide for usage instructions</li> <li>Submit an issue on GitHub (if repository is public)</li> </ol>"},{"location":"#contributing","title":"Contributing","text":"<p>GateWizard is open-source software. Contributions are welcome! See our development guidelines for more information.</p>"},{"location":"#license","title":"License","text":"<p>GateWizard is licensed under the MIT License.</p> <p>Copyright (c) 2025 Constanza Gonz\u00e1lez and Mauricio Bedoya</p> <p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p> <p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p> <p>THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>"},{"location":"#authors","title":"Authors","text":"<ul> <li>Constanza Gonz\u00e1lez - constanza.gonzalez.villagra@gmail.com</li> <li>Mauricio Bedoya - mbedoya@ucm.cl</li> </ul>"},{"location":"#citation","title":"Citation","text":"<p>If you use GateWizard in your research, please cite:</p> <pre><code>[Citation information to be added]\n</code></pre> <p>Last updated: October 2025</p>"},{"location":"QUICK_REFERENCE/","title":"GateWizard Quick Reference","text":"<p>Quick reference for common GateWizard API operations.</p>"},{"location":"QUICK_REFERENCE/#propka-analysis","title":"Propka Analysis","text":""},{"location":"QUICK_REFERENCE/#basic-analysis","title":"Basic Analysis","text":"<pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer(propka_version=\"3\")\npka_file = analyzer.run_analysis(\"protein.pdb\")\nsummary_file = analyzer.extract_summary(pka_file)\nresidues = analyzer.parse_summary(summary_file)\n</code></pre>"},{"location":"QUICK_REFERENCE/#access-results","title":"Access Results","text":"<pre><code>for res in residues:\n    print(f\"{res['residue']}{res['res_id']} Chain {res['chain']}: pKa={res['pka']:.2f}\")\n</code></pre>"},{"location":"QUICK_REFERENCE/#filter-by-type","title":"Filter by Type","text":"<pre><code>acidic = [r for r in residues if r['residue'] in ['ASP', 'GLU']]\nbasic = [r for r in residues if r['residue'] in ['LYS', 'ARG', 'HIS']]\n</code></pre>"},{"location":"QUICK_REFERENCE/#write-pdb-with-protonation-states","title":"Write PDB with Protonation States","text":"<pre><code># Apply protonation states at target pH\n# NOTE: This only changes residue names (ASP\u2192ASH), does NOT add hydrogens\nstats = analyzer.apply_protonation_states(\n    input_pdb=\"protein.pdb\",\n    output_pdb=\"protein_ph7.4.pdb\",\n    ph=7.4\n)\nprint(f\"Modified {stats['residue_changes']} residues\")\n\n# For MD simulations, add hydrogens with pdb4amber:\n# pdb4amber -i protein_ph7.4.pdb -o protein_prepared.pdb\n\n# With custom states\ncustom_states = {\n    \"HIS67\": \"HID\",      # Delta-protonated histidine\n    \"ASP42_A\": \"ASH\"     # Chain-specific override\n}\nstats = analyzer.apply_protonation_states(\n    input_pdb=\"protein.pdb\",\n    output_pdb=\"protein_custom.pdb\",\n    ph=7.4,\n    custom_states=custom_states\n)\n</code></pre>"},{"location":"QUICK_REFERENCE/#generate-multiple-ph-states","title":"Generate Multiple pH States","text":"<pre><code>for ph in [5.0, 6.0, 7.0, 8.0]:\n    stats = analyzer.apply_protonation_states(\n        input_pdb=\"protein.pdb\",\n        output_pdb=f\"protein_ph{ph:.1f}.pdb\",\n        ph=ph\n    )\n</code></pre>"},{"location":"QUICK_REFERENCE/#system-preparation","title":"System Preparation","text":""},{"location":"QUICK_REFERENCE/#basic-membrane-system","title":"Basic Membrane System","text":"<pre><code>from gatewizard.core.system_builder import SystemBuilder\n\nbuilder = SystemBuilder()\nbuilder.set_configuration(\n    salt_concentration=0.15,\n    dist_wat=17.5\n)\n\nsuccess, msg, job_dir = builder.prepare_system(\n    pdb_file=\"protein.pdb\",\n    working_dir=\"system_prep\",\n    upper_lipids=[\"POPC\", \"POPE\"],\n    lower_lipids=[\"POPC\", \"POPE\"],\n    lipid_ratios=\"3:1//3:1\"\n)\n</code></pre>"},{"location":"QUICK_REFERENCE/#check-output","title":"Check Output","text":"<pre><code>if success:\n    topology = job_dir / \"system.prmtop\"\n    coords = job_dir / \"system.inpcrd\"\n    pdb = job_dir / \"system_solv.pdb\"\n</code></pre>"},{"location":"QUICK_REFERENCE/#equilibration-setup","title":"Equilibration Setup","text":""},{"location":"QUICK_REFERENCE/#basic-protocol","title":"Basic Protocol","text":"<pre><code>from gatewizard.tools.equilibration import NAMDEquilibrationManager\nfrom pathlib import Path\n\nmanager = NAMDEquilibrationManager(\n    working_dir=Path(\"equilibration\"),\n    namd_executable=\"namd3\"\n)\n\nprotocol = {\n    \"Equilibration 1\": {\n        \"name\": \"Equilibration 1\",\n        \"time_ns\": 0.125,\n        \"timestep\": 1.0,\n        \"temperature\": 310.15,\n        \"pressure\": 1.0,\n        \"constraints\": {\n            \"protein_backbone\": 10.0,\n            \"protein_sidechain\": 5.0,\n            \"lipid_head\": 2.0,\n            \"water\": 0.0\n        },\n        \"minimize_steps\": 10000,\n        \"use_gpu\": True,\n        \"cpu_cores\": 4,\n        \"dcd_freq\": 5000\n    }\n}\n</code></pre>"},{"location":"QUICK_REFERENCE/#generate-configs","title":"Generate Configs","text":"<pre><code>system_files = {\n    'prmtop': 'system.prmtop',\n    'inpcrd': 'system.inpcrd',\n    'pdb': 'system_solv.pdb'\n}\n\nfor stage_key, stage_data in protocol.items():\n    stage_index = list(protocol.keys()).index(stage_key)\n\n    config = manager.generate_charmm_gui_config_file(\n        stage_name=stage_key,\n        stage_params=stage_data,\n        stage_index=stage_index,\n        system_files=system_files\n    )\n\n    config_name = manager._get_config_name(stage_key)\n    with open(f\"{config_name}.conf\", 'w') as f:\n        f.write(config)\n</code></pre>"},{"location":"QUICK_REFERENCE/#generate-run-script","title":"Generate Run Script","text":"<pre><code>script = manager.generate_run_script(protocol, \"namd3\")\nwith open(\"run_equilibration.sh\", 'w') as f:\n    f.write(script)\nPath(\"run_equilibration.sh\").chmod(0o755)\n</code></pre>"},{"location":"QUICK_REFERENCE/#analysis","title":"Analysis","text":""},{"location":"QUICK_REFERENCE/#monitor-progress","title":"Monitor Progress","text":"<pre><code>from gatewizard.utils.namd_analysis import get_equilibration_progress\nfrom pathlib import Path\n\nprogress = get_equilibration_progress(Path(\"equilibration\"))\nprint(f\"Progress: {progress['percent_complete']:.1f}%\")\n</code></pre>"},{"location":"QUICK_REFERENCE/#parse-log-file","title":"Parse Log File","text":"<pre><code>from gatewizard.utils.namd_analysis import parse_namd_log\n\nlog_data = parse_namd_log(\"step1_equilibration.log\")\nprint(f\"Avg Temperature: {sum(log_data['temperature'])/len(log_data['temperature']):.2f} K\")\n</code></pre>"},{"location":"QUICK_REFERENCE/#error-handling","title":"Error Handling","text":""},{"location":"QUICK_REFERENCE/#standard-pattern","title":"Standard Pattern","text":"<pre><code>from gatewizard.core.propka import PropkaError\n\ntry:\n    analyzer = PropkaAnalyzer()\n    pka_file = analyzer.run_analysis(\"protein.pdb\")\nexcept FileNotFoundError as e:\n    print(f\"File not found: {e}\")\nexcept PropkaError as e:\n    print(f\"Propka error: {e}\")\nexcept Exception as e:\n    print(f\"Unexpected error: {e}\")\n</code></pre>"},{"location":"QUICK_REFERENCE/#common-dictionary-keys","title":"Common Dictionary Keys","text":""},{"location":"QUICK_REFERENCE/#propka-results","title":"Propka Results","text":"<pre><code>residue = {\n    \"residue\": \"ASP\",      # Residue name\n    \"res_id\": 42,          # Residue number\n    \"chain\": \"A\",          # Chain ID\n    \"pka\": 3.85,           # Predicted pKa\n    \"model_pka\": 3.80      # Model pKa\n}\n</code></pre>"},{"location":"QUICK_REFERENCE/#stage-parameters","title":"Stage Parameters","text":"<pre><code>stage = {\n    \"time_ns\": 0.125,              # Simulation time\n    \"timestep\": 1.0,               # Timestep in fs\n    \"temperature\": 310.15,         # Temperature in K\n    \"pressure\": 1.0,               # Pressure in atm\n    \"constraints\": {               # Restraints (kcal/mol/\u0172)\n        \"protein_backbone\": 10.0,\n        \"protein_sidechain\": 5.0,\n        \"lipid_head\": 2.0,\n        \"water\": 0.0\n    },\n    \"use_gpu\": True,\n    \"cpu_cores\": 4,\n    \"dcd_freq\": 5000\n}\n</code></pre>"},{"location":"QUICK_REFERENCE/#file-locations","title":"File Locations","text":""},{"location":"QUICK_REFERENCE/#after-propka","title":"After Propka","text":"<pre><code>protein.pka                        # Full output\nprotein_summary_of_prediction.txt  # Summary section\n</code></pre>"},{"location":"QUICK_REFERENCE/#after-system-preparation","title":"After System Preparation","text":"<pre><code>job_directory/\n  \u251c\u2500\u2500 system.prmtop          # Topology\n  \u251c\u2500\u2500 system.inpcrd          # Coordinates\n  \u251c\u2500\u2500 system_solv.pdb        # Solvated structure\n  \u2514\u2500\u2500 step3_input.pdb        # Pre-solvation\n</code></pre>"},{"location":"QUICK_REFERENCE/#after-equilibration-setup","title":"After Equilibration Setup","text":"<pre><code>equilibration/\n  \u251c\u2500\u2500 step1.conf                  # Config for stage 1\n  \u251c\u2500\u2500 step2.conf                  # Config for stage 2\n  \u251c\u2500\u2500 step7_production.conf       # Production config\n  \u251c\u2500\u2500 run_equilibration.sh        # Run script\n  \u2514\u2500\u2500 protocol_summary.json       # Protocol definition\n</code></pre>"},{"location":"QUICK_REFERENCE/#tips","title":"Tips","text":""},{"location":"QUICK_REFERENCE/#performance","title":"Performance","text":"<ul> <li>Use <code>use_gpu=True</code> for equilibration stages</li> <li>Increase <code>cpu_cores</code> for larger systems</li> <li>Use <code>timestep=1.0</code> for heavily restrained stages</li> <li>Use <code>timestep=2.0</code> for production</li> </ul>"},{"location":"QUICK_REFERENCE/#file-management","title":"File Management","text":"<ul> <li>Use <code>pathlib.Path</code> for file operations</li> <li>Create output directories before writing</li> <li>Use absolute paths when possible</li> </ul>"},{"location":"QUICK_REFERENCE/#debugging","title":"Debugging","text":"<ul> <li>Check log files: <code>tail -f step*.log</code></li> <li>Verify file existence before processing</li> <li>Use try-except for robust error handling</li> </ul>"},{"location":"analysis/","title":"Analysis Features","text":"<p>Detailed documentation of GateWizard's trajectory and energy analysis capabilities.</p>"},{"location":"analysis/#overview","title":"Overview","text":"<p>GateWizard provides two main types of analysis:</p> <ol> <li>Structural Analysis: For trajectory files (.dcd, .xtc, .trr)</li> <li>Energetic Analysis: For NAMD log files</li> </ol> <p>Both types support multiple files, custom time assignment, and flexible unit selection.</p>"},{"location":"analysis/#structural-analysis","title":"Structural Analysis","text":""},{"location":"analysis/#supported-formats","title":"Supported Formats","text":"<ul> <li>Topology: PSF, PDB, GRO</li> <li>Trajectories: DCD, XTC, TRR, NetCDF</li> </ul>"},{"location":"analysis/#analysis-types","title":"Analysis Types","text":""},{"location":"analysis/#rmsd-root-mean-square-deviation","title":"RMSD (Root Mean Square Deviation)","text":"<p>Purpose: Measure structural deviation from a reference structure.</p> <p>Usage: <pre><code>1. Select RMSD from Analysis Type\n2. Set reference frame (default: first frame)\n3. Choose atom selection (e.g., \"protein and name CA\")\n4. Enable/disable alignment\n5. Run analysis\n</code></pre></p> <p>Output: - Plot: Time vs RMSD - Data: Time points and RMSD values - Units: \u00c5ngstroms (\u00c5) or nanometers (nm)</p> <p>Interpretation: - Low RMSD (~1-3 \u00c5): Structure remains close to reference - High RMSD (&gt;5 \u00c5): Significant structural changes - Plateau: System has equilibrated - Increasing trend: System still evolving</p>"},{"location":"analysis/#rmsf-root-mean-square-fluctuation","title":"RMSF (Root Mean Square Fluctuation)","text":"<p>Purpose: Identify flexible and rigid regions of the protein.</p> <p>Usage: <pre><code>1. Select RMSF from Analysis Type\n2. Choose atom selection (typically C-alpha atoms)\n3. Run analysis\n</code></pre></p> <p>Output: - Plot: Residue number vs RMSF - Data: Per-residue fluctuation values - Units: \u00c5ngstroms (\u00c5) or nanometers (nm)</p> <p>Interpretation: - Low RMSF (&lt;1 \u00c5): Rigid regions (core, secondary structures) - High RMSF (&gt;2 \u00c5): Flexible regions (loops, termini) - Peaks indicate highly mobile residues</p>"},{"location":"analysis/#distance-analysis","title":"Distance Analysis","text":"<p>Purpose: Track distances between specific atoms or groups.</p> <p>Usage: <pre><code>1. Select Distances from Analysis Type\n2. Define atom pairs:\n   - Selection 1: \"resid 10 and name CA\"\n   - Selection 2: \"resid 50 and name CA\"\n3. Run analysis\n</code></pre></p> <p>Output: - Plot: Time vs Distance - Data: Time points and distance values - Units: \u00c5ngstroms (\u00c5) or nanometers (nm)</p> <p>Use Cases: - Salt bridge formation - Domain movements - Ligand-protein interactions - Conformational changes</p>"},{"location":"analysis/#radius-of-gyration","title":"Radius of Gyration","text":"<p>Purpose: Measure overall compactness of the structure.</p> <p>Usage: <pre><code>1. Select Radius of Gyration\n2. Choose atom selection (typically all protein atoms)\n3. Run analysis\n</code></pre></p> <p>Output: - Plot: Time vs Rg - Data: Time points and Rg values - Units: \u00c5ngstroms (\u00c5) or nanometers (nm)</p> <p>Interpretation: - Constant Rg: Stable, compact structure - Increasing Rg: Unfolding or expansion - Decreasing Rg: Compaction or folding</p>"},{"location":"analysis/#time-management-for-trajectories","title":"Time Management for Trajectories","text":""},{"location":"analysis/#without-time-assignment","title":"Without Time Assignment","text":"<p>Uses frame numbers \u00d7 time step: - Automatically calculated from trajectory metadata - Suitable for single, continuous trajectories</p>"},{"location":"analysis/#with-time-assignment","title":"With Time Assignment","text":"<p>Distributes frames evenly across assigned time:</p> <p>Example: <pre><code>File1.dcd: 1000 frames, assigned 10 ns\n  \u2192 Frame 0: 0.0 ns\n  \u2192 Frame 500: 5.0 ns\n  \u2192 Frame 999: 10.0 ns\n\nFile2.dcd: 2000 frames, assigned 50 ns\n  \u2192 Frame 0: 10.0 ns (continues from File1)\n  \u2192 Frame 1000: 35.0 ns\n  \u2192 Frame 1999: 60.0 ns\n</code></pre></p> <p>Benefits: - Accurate time representation for concatenated runs - Proper handling of different sampling rates - Sequential placement of multiple simulations</p>"},{"location":"analysis/#atom-selections","title":"Atom Selections","text":"<p>GateWizard uses MDAnalysis selection syntax:</p> <p>Common Selections: <pre><code>protein                      # All protein atoms\nprotein and name CA          # C-alpha atoms only\nprotein and backbone         # Backbone atoms (N, CA, C, O)\nresid 1:50                   # Residues 1 to 50\nresname ALA                  # All alanine residues\nname CA and resid 10:20      # C-alpha of residues 10-20\nsegid PROA                   # Atoms in segment PROA\n</code></pre></p> <p>Advanced Selections: <pre><code>protein and not name H*              # Protein without hydrogens\n(resid 10:20) or (resid 50:60)      # Multiple regions\naround 5 resname LIG                 # Within 5\u00c5 of ligand\n</code></pre></p>"},{"location":"analysis/#units-and-conversions","title":"Units and Conversions","text":"<p>Distance Units: - \u00c5ngstroms (\u00c5): Default in structural biology - Nanometers (nm): Common in MD simulations - Conversion: 1 nm = 10 \u00c5</p> <p>Time Units: - Picoseconds (ps): Fine-grained time scale - Nanoseconds (ns): Common for simulation lengths - Microseconds (\u00b5s): Long simulations - Conversions: 1 ns = 1000 ps, 1 \u00b5s = 1000 ns</p>"},{"location":"analysis/#energetic-analysis","title":"Energetic Analysis","text":""},{"location":"analysis/#namd-log-file-analysis","title":"NAMD Log File Analysis","text":"<p>Supported Data: - ETITLE: Column headers from log file - ENERGY: Data lines with timesteps and values</p> <p>Available Properties: - TEMP: Temperature (K) - TOTAL: Total energy (kcal/mol) - KINETIC: Kinetic energy (kcal/mol) - POTENTIAL: Potential energy (kcal/mol) - ELECT: Electrostatic energy (kcal/mol) - VDW: van der Waals energy (kcal/mol) - PRESSURE: Pressure (bar) - VOLUME: Volume (\u0172)</p>"},{"location":"analysis/#time-distribution-for-log-files","title":"Time Distribution for Log Files","text":""},{"location":"analysis/#without-time-assignment_1","title":"Without Time Assignment","text":"<p>Uses timestep (TS) column: <pre><code>TS = 0:     0 ps\nTS = 1000:  2 ps (if timestep=2fs, output every 1000 steps)\nTS = 50000: 100 ps\n</code></pre></p>"},{"location":"analysis/#with-time-assignment_1","title":"With Time Assignment","text":"<p>Distributes data points evenly:</p> <p>Example: <pre><code>equilibration.log: 500 points, assigned 5 ns\n  \u2192 Point 0: 0.0 ns\n  \u2192 Point 250: 2.5 ns\n  \u2192 Point 499: 5.0 ns\n\nproduction.log: 5000 points, assigned 100 ns\n  \u2192 Point 0: 5.0 ns (continues from equilibration)\n  \u2192 Point 2500: 55.0 ns\n  \u2192 Point 4999: 105.0 ns\n</code></pre></p> <p>Benefits: - Correct timeline for multi-stage simulations - Proper spacing for different output frequencies - Sequential representation of simulation phases</p>"},{"location":"analysis/#energy-units","title":"Energy Units","text":"<p>kcal/mol (default in NAMD): - Standard in US molecular modeling - 1 kcal/mol = 4.184 kJ/mol</p> <p>kJ/mol (SI unit): - Standard in international publications - Conversion applied automatically when selected</p> <p>Use Cases: - Plot TOTAL energy to check stability - Monitor TEMP for thermostat performance - Check PRESSURE for barostat performance - Compare KINETIC and POTENTIAL for energy distribution</p>"},{"location":"analysis/#multiple-property-plotting","title":"Multiple Property Plotting","text":"<p>Plot multiple properties simultaneously:</p> <ol> <li>Select multiple columns (Ctrl+Click)</li> <li>Each property shown in different color</li> <li>Legend automatically added</li> <li>Y-axis label adjusted for multiple properties</li> </ol> <p>Example: <pre><code>Plot: TOTAL, TEMP, PRESSURE\nResult: Three lines showing:\n  - Energy evolution (left Y-axis)\n  - Temperature stability\n  - Pressure fluctuations\n</code></pre></p>"},{"location":"analysis/#plot-customization","title":"Plot Customization","text":""},{"location":"analysis/#available-options","title":"Available Options","text":"<p>Title and Labels: - Plot Title: Custom description - X-Axis Label: Time (with units) - Y-Axis Label: Property (with units)</p> <p>Units: - X-Axis: ps, ns, \u00b5s - Y-Axis (Distance): \u00c5, nm - Y-Axis (Energy): kcal/mol, kJ/mol</p> <p>Appearance: - Background Color: Dark Gray, Light Gray, White, Black - Line Color: Blue, Red, Green, etc. - Grid: Automatic with transparency</p> <p>Ranges: - X-Min, X-Max: Limit time range - Y-Min, Y-Max: Limit value range - Auto-scaling: Enabled by default</p>"},{"location":"analysis/#export-options","title":"Export Options","text":"<p>Plot Export: - PNG: Raster image (good for presentations) - SVG: Vector image (good for publications) - High resolution available</p> <p>Data Export: - CSV: Spreadsheet format   <pre><code>Time(ns),RMSD(\u00c5)\n0.0,0.0\n0.1,0.5\n0.2,0.8\n</code></pre></p> <ul> <li> <p>JSON: Structured format   <pre><code>{\n  \"time\": [0.0, 0.1, 0.2],\n  \"rmsd\": [0.0, 0.5, 0.8],\n  \"units\": {\"time\": \"ns\", \"rmsd\": \"\u00c5\"}\n}\n</code></pre></p> </li> <li> <p>NumPy: Python analysis   <pre><code>import numpy as np\ndata = np.load('results.npz')\ntime = data['time']\nrmsd = data['rmsd']\n</code></pre></p> </li> </ul>"},{"location":"analysis/#advanced-features","title":"Advanced Features","text":""},{"location":"analysis/#draggable-file-list","title":"Draggable File List","text":"<p>Reorder files by dragging: 1. Click and hold on file bar handle (\u2630) 2. Drag to new position 3. Release to reorder 4. Time distribution updates automatically</p>"},{"location":"analysis/#real-time-progress","title":"Real-Time Progress","text":"<p>During analysis: - Progress bar shows completion - Status messages update - Can cancel long-running analyses</p>"},{"location":"analysis/#batch-processing","title":"Batch Processing","text":"<p>Analyze multiple trajectories: 1. Add all files at once 2. Assign times for each 3. Run analysis once 4. Data combined automatically</p>"},{"location":"analysis/#troubleshooting-analysis","title":"Troubleshooting Analysis","text":""},{"location":"analysis/#issue-rmsd-values-too-high","title":"Issue: RMSD values too high","text":"<p>Possible causes: - Misaligned structures - Wrong reference frame - Including flexible loops</p> <p>Solutions: - Enable alignment option - Try different reference frames - Use more specific atom selection (e.g., secondary structure only)</p>"},{"location":"analysis/#issue-choppy-or-discontinuous-plots","title":"Issue: Choppy or discontinuous plots","text":"<p>Possible causes: - Files not in correct order - Time assignment incorrect - Missing frames</p> <p>Solutions: - Reorder files using drag-and-drop - Verify time assignments - Check trajectory files for completeness</p>"},{"location":"analysis/#issue-energy-values-seem-wrong","title":"Issue: Energy values seem wrong","text":"<p>Possible causes: - Wrong units selected - Log files not from same simulation - Parsing errors</p> <p>Solutions: - Check unit selection (kcal/mol vs kJ/mol) - Verify log files are sequential - Check status messages for warnings</p>"},{"location":"analysis/#issue-memory-errors-with-large-trajectories","title":"Issue: Memory errors with large trajectories","text":"<p>Solutions: - Analyze in smaller chunks - Use more specific atom selections - Increase system RAM - Close other applications</p>"},{"location":"analysis/#best-practices","title":"Best Practices","text":""},{"location":"analysis/#for-structural-analysis","title":"For Structural Analysis","text":"<ol> <li>Always check alignment: Enable for RMSD calculations</li> <li>Use appropriate selections: Backbone for overall structure, C-alpha for simplicity</li> <li>Verify time assignments: Especially for concatenated trajectories</li> <li>Export data regularly: Don't lose analysis results</li> <li>Check convergence: RMSD should plateau</li> </ol>"},{"location":"analysis/#for-energetic-analysis","title":"For Energetic Analysis","text":"<ol> <li>Sequential file ordering: Equilibration \u2192 Production phases</li> <li>Assign times accurately: Match actual simulation times</li> <li>Plot multiple properties: Check system stability</li> <li>Monitor temperature: Should be stable (\u00b11-2 K)</li> <li>Check energy drift: Total energy should be conserved (NVE) or stable (NVT/NPT)</li> </ol>"},{"location":"analysis/#for-publication","title":"For Publication","text":"<ol> <li>Use consistent units: Pick one set and stick to it</li> <li>Export high-resolution plots: SVG for vector graphics</li> <li>Save raw data: CSV or NumPy for later analysis</li> <li>Document parameters: Note selections, reference frames, etc.</li> <li>Check error bars: Consider statistical analysis of multiple runs</li> </ol>"},{"location":"analysis/#example-workflows","title":"Example Workflows","text":""},{"location":"analysis/#workflow-1-basic-rmsd-analysis","title":"Workflow 1: Basic RMSD Analysis","text":"<pre><code>1. Load topology: system.psf\n2. Add trajectory: production.dcd\n3. Assign time: 100 ns\n4. Select: RMSD analysis\n5. Atom selection: protein and name CA\n6. Reference frame: 0\n7. Enable alignment: Yes\n8. Run analysis\n9. Export: plot as PNG, data as CSV\n</code></pre>"},{"location":"analysis/#workflow-2-multi-file-energy-analysis","title":"Workflow 2: Multi-File Energy Analysis","text":"<pre><code>1. Add files:\n   - min.log \u2192 0.1 ns\n   - equil.log \u2192 1.0 ns\n   - prod1.log \u2192 50 ns\n   - prod2.log \u2192 50 ns\n2. Total timeline: 0-101.1 ns\n3. Select properties: TOTAL, TEMP, PRESSURE\n4. Units: X=ns, Y=kcal/mol\n5. Run analysis\n6. Export: data as JSON\n</code></pre>"},{"location":"analysis/#workflow-3-residue-flexibility","title":"Workflow 3: Residue Flexibility","text":"<pre><code>1. Load topology and trajectory\n2. Select: RMSF analysis\n3. Atom selection: protein and name CA\n4. Run analysis\n5. Identify flexible regions (RMSF &gt; 2 \u00c5)\n6. Cross-reference with structure\n7. Export: plot and data\n</code></pre> <p>For more examples and detailed tutorials, see the User Guide.</p>"},{"location":"installation/","title":"Installation Guide","text":"<p>This guide provides detailed instructions for installing GateWizard on different platforms.</p>"},{"location":"installation/#prerequisites","title":"Prerequisites","text":"<p>Before installing GateWizard, ensure you have:</p> <ul> <li>Conda (Miniconda or Anaconda): Download here</li> <li>Git (for cloning the repository): Download here</li> <li>Python 3.8+ (will be installed via conda)</li> </ul>"},{"location":"installation/#quick-installation-from-pypi-recommended","title":"Quick Installation from PyPI (Recommended)","text":"<p>This is the fastest way to get GateWizard up and running:</p> <pre><code># 1. Create conda environment with scientific dependencies\nconda create -n gatewizard -c conda-forge python sqlite ambertools=24 parmed=4.3.0 -y\n\n# 2. Activate the environment\nconda activate gatewizard\n\n# 3. Install GateWizard from PyPI\npip install gatewizard\n\n# 4. Launch GateWizard\ngatewizard\n</code></pre>"},{"location":"installation/#alternative-development-installation","title":"Alternative: Development Installation","text":"<p>For developers or to install from source:</p> <pre><code># 1. Clone the repository\ngit clone https://github.com/maurobedoya/gatewizard.git\ncd gatewizard\n\n# 2. Create environment from file\nconda env create -f environment.yml\n\n# 3. Activate the environment\nconda activate gatewizard\n\n# 4. Install in development mode\npip install -e .\n\n# 5. Launch GateWizard\ngatewizard\n</code></pre>"},{"location":"installation/#platform-specific-instructions","title":"Platform-Specific Instructions","text":""},{"location":"installation/#linux","title":"Linux","text":"<p>GateWizard works natively on Linux. Follow the Quick Installation steps above.</p> <p>Additional Notes: - Ensure you have <code>tkinter</code> support: <code>sudo apt-get install python3-tk</code> (Ubuntu/Debian) - For display issues, ensure X11 is properly configured</p>"},{"location":"installation/#macos","title":"macOS","text":"<p>GateWizard works on macOS with some considerations:</p> <pre><code># Follow the Quick Installation steps, then:\n\n# If you encounter display issues:\nconda install -c conda-forge python.app\n\n# Run using pythonw instead of python\npythonw -m gatewizard\n</code></pre> <p>Known Issues: - On Apple Silicon (M1/M2), some dependencies may require Rosetta 2 - CustomTkinter may have scaling issues on Retina displays</p>"},{"location":"installation/#windows","title":"Windows","text":"<p>GateWizard is best used on Windows with WSL (Windows Subsystem for Linux):</p> <p>Option 1: WSL (Recommended) <pre><code># 1. Install WSL2 with Ubuntu\nwsl --install\n\n# 2. Inside WSL, follow the Linux installation instructions\n# 3. Install X server on Windows (e.g., VcXsrv, X410)\n# 4. Set DISPLAY environment variable in WSL\nexport DISPLAY=:0\n</code></pre></p> <p>Option 2: Native Windows (Experimental) <pre><code># Use Anaconda Prompt\nconda create -n gatewizard -c conda-forge python sqlite ambertools=24 parmed=4.3.0 -y\nconda activate gatewizard\npip install gatewizard\ngatewizard\n</code></pre></p>"},{"location":"installation/#dependencies","title":"Dependencies","text":""},{"location":"installation/#core-python-dependencies","title":"Core Python Dependencies","text":"<p>Automatically installed via pip:</p> <ul> <li>customtkinter &gt;= 5.0.0 - Modern GUI framework</li> <li>numpy &gt;= 1.21.0 - Numerical computing</li> <li>matplotlib &gt;= 3.5.0 - Plotting and visualization</li> <li>MDAnalysis &gt;= 2.0.0 - Molecular analysis</li> <li>propka &gt;= 3.2.0 - pKa calculations</li> <li>biopython - PDB file handling</li> </ul>"},{"location":"installation/#scientific-computing-dependencies","title":"Scientific Computing Dependencies","text":"<p>Must be installed via conda:</p> <ul> <li>AmberTools 24 - Molecular dynamics preparation and analysis</li> <li>Parmed 4.3.0 - Parameter/topology manipulation (must be from conda-forge)</li> </ul>"},{"location":"installation/#verifying-installation","title":"Verifying Installation","text":"<p>After installation, verify that everything works:</p> <pre><code># Activate environment\nconda activate gatewizard\n\n# Check Python version\npython --version  # Should be 3.8+\n\n# Check key dependencies\npython -c \"import customtkinter; print('CustomTkinter:', customtkinter.__version__)\"\npython -c \"import MDAnalysis; print('MDAnalysis:', MDAnalysis.__version__)\"\npython -c \"import parmed; print('ParmEd:', parmed.__version__)\"\n\n# Check AmberTools\nwhich pdb4amber  # Should show path in conda environment\n\n# Launch GateWizard\ngatewizard --version\n</code></pre>"},{"location":"installation/#upgrading-gatewizard","title":"Upgrading GateWizard","text":"<p>To upgrade to the latest version from PyPI:</p> <pre><code># Activate environment\nconda activate gatewizard\n\n# Upgrade GateWizard\npip install --upgrade gatewizard\n\n# Verify new version\ngatewizard --version\n</code></pre> <p>Check for updates: You can check if a newer version is available: <pre><code>pip list --outdated | grep gatewizard\n</code></pre></p> <p>Force reinstall (if needed): If you encounter issues after an update: <pre><code>pip install --force-reinstall gatewizard\n</code></pre></p>"},{"location":"installation/#troubleshooting-installation","title":"Troubleshooting Installation","text":""},{"location":"installation/#issue-importerror-with-numpycompat","title":"Issue: ImportError with numpy.compat","text":"<p>Cause: Version conflict between NumPy and Parmed.</p> <p>Solution: <pre><code># Reinstall Parmed from conda-forge\nconda install -c conda-forge parmed=4.3.0 --force-reinstall\n</code></pre></p>"},{"location":"installation/#issue-pdb4amber-command-not-found","title":"Issue: pdb4amber command not found","text":"<p>Cause: AmberTools not properly installed or environment not activated.</p> <p>Solution: <pre><code># Ensure environment is activated\nconda activate gatewizard\n\n# Reinstall AmberTools\nconda install -c conda-forge ambertools=24\n</code></pre></p>"},{"location":"installation/#issue-customtkinter-gui-not-appearing","title":"Issue: CustomTkinter GUI not appearing","text":"<p>Cause: Display configuration or tkinter missing.</p> <p>Solution: <pre><code># On Linux\nsudo apt-get install python3-tk\n\n# Reinstall CustomTkinter\npip install --force-reinstall customtkinter\n\n# Check display\necho $DISPLAY  # Should show something like :0 or localhost:10.0\n</code></pre></p>"},{"location":"installation/#issue-module-not-found-errors","title":"Issue: Module not found errors","text":"<p>Cause: Installation incomplete or wrong environment.</p> <p>Solution: <pre><code># Ensure you're in the correct environment\nconda activate gatewizard\n\n# Reinstall in development mode\ncd /path/to/gatewizard\npip install -e . --force-reinstall\n</code></pre></p>"},{"location":"installation/#updating-gatewizard","title":"Updating GateWizard","text":""},{"location":"installation/#for-pypi-installation-recommended","title":"For PyPI Installation (Recommended)","text":"<p>To update to the latest version:</p> <pre><code># Activate environment\nconda activate gatewizard\n\n# Update GateWizard\npip install --upgrade gatewizard\n\n# Verify new version\ngatewizard --version\n</code></pre> <p>Tip: GateWizard follows semantic versioning. Check the releases page for changelog and new features.</p>"},{"location":"installation/#for-development-installation","title":"For Development Installation","text":"<p>If you installed from source:</p> <pre><code># Update repository\ncd /path/to/gatewizard\ngit pull origin main\n\n# Update dependencies if needed\nconda env update -f environment.yml\n\n# Reinstall\npip install -e . --force-reinstall\n\n# Restart GateWizard\ngatewizard\n</code></pre>"},{"location":"installation/#uninstallation","title":"Uninstallation","text":"<p>To completely remove GateWizard:</p> <pre><code># Remove conda environment\nconda deactivate\nconda env remove -n gatewizard\n\n# Remove repository (if desired)\nrm -rf /path/to/gatewizard\n</code></pre>"},{"location":"installation/#next-steps","title":"Next Steps","text":"<p>After successful installation:</p> <ol> <li>Read the User Guide to learn about features</li> <li>Try the example workflows</li> <li>Check the Troubleshooting Guide if you encounter issues</li> </ol> <p>For additional help, please contact the developers or check the GitHub repository.</p>"},{"location":"troubleshooting/","title":"Troubleshooting","text":"<p>Common issues and solutions for GateWizard.</p>"},{"location":"troubleshooting/#installation-issues","title":"Installation Issues","text":""},{"location":"troubleshooting/#issue-importerror-with-numpycompat","title":"Issue: ImportError with numpy.compat","text":"<p>Error Message: <pre><code>ImportError: cannot import name 'OLD_NUMERIC_TYPES' from 'numpy.compat'\n</code></pre></p> <p>Cause: Version conflict between NumPy and Parmed.</p> <p>Solution: <pre><code>conda activate gatewizard\nconda install -c conda-forge parmed=4.3.0 --force-reinstall\n</code></pre></p>"},{"location":"troubleshooting/#issue-pdb4amber-command-not-found","title":"Issue: pdb4amber command not found","text":"<p>Error Message: <pre><code>bash: pdb4amber: command not found\n</code></pre></p> <p>Cause: AmberTools not installed or environment not activated.</p> <p>Solution: <pre><code># Check if environment is activated\nconda activate gatewizard\n\n# Verify AmberTools installation\nwhich pdb4amber\n\n# If not found, reinstall\nconda install -c conda-forge ambertools=24\n</code></pre></p>"},{"location":"troubleshooting/#issue-customtkinter-not-found","title":"Issue: CustomTkinter not found","text":"<p>Error Message: <pre><code>ModuleNotFoundError: No module named 'customtkinter'\n</code></pre></p> <p>Solution: <pre><code>conda activate gatewizard\npip install customtkinter --force-reinstall\n</code></pre></p>"},{"location":"troubleshooting/#issue-displaygui-not-appearing","title":"Issue: Display/GUI not appearing","text":"<p>On Linux: <pre><code># Install tkinter support\nsudo apt-get install python3-tk\n\n# Check DISPLAY variable\necho $DISPLAY\n\n# If empty, set it\nexport DISPLAY=:0\n</code></pre></p> <p>On macOS: <pre><code># Install python.app for GUI support\nconda install -c conda-forge python.app\n\n# Run with pythonw\npythonw -m gatewizard\n</code></pre></p> <p>On Windows WSL: <pre><code># Install X server on Windows (VcXsrv, X410)\n# In WSL, set DISPLAY\nexport DISPLAY=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2}'):0\n</code></pre></p>"},{"location":"troubleshooting/#runtime-issues","title":"Runtime Issues","text":""},{"location":"troubleshooting/#issue-gatewizard-crashes-on-startup","title":"Issue: GateWizard crashes on startup","text":"<p>Check 1: Verify Python version <pre><code>python --version  # Should be 3.8+\n</code></pre></p> <p>Check 2: Check dependencies <pre><code>python -c \"import customtkinter\"\npython -c \"import MDAnalysis\"\npython -c \"import parmed\"\n</code></pre></p> <p>Check 3: Run with debug mode <pre><code>gatewizard --debug\n</code></pre></p> <p>Solution: Look at error messages and reinstall problematic packages.</p>"},{"location":"troubleshooting/#issue-gui-appears-but-is-unresponsive","title":"Issue: GUI appears but is unresponsive","text":"<p>Possible causes: - Large file being processed - System resources exhausted - Display server issues</p> <p>Solutions: 1. Wait for operation to complete (check terminal for progress) 2. Close other applications to free memory 3. Restart display server 4. Check system resources: <code>top</code> or <code>htop</code></p>"},{"location":"troubleshooting/#issue-cannot-load-pdb-file","title":"Issue: Cannot load PDB file","text":"<p>Error: \"Invalid PDB file\" or \"Cannot parse file\"</p> <p>Solutions: 1. Verify file format: Ensure it's a valid PDB file    <pre><code>head -n 5 your_file.pdb  # Should show ATOM/HETATM lines\n</code></pre></p> <ol> <li> <p>Clean the PDB: Use Propka with \"Clean PDB\" option enabled</p> </li> <li> <p>Check file permissions:    <pre><code>ls -l your_file.pdb\nchmod 644 your_file.pdb  # If needed\n</code></pre></p> </li> <li> <p>Try different source: If from PDB database, download again</p> </li> </ol>"},{"location":"troubleshooting/#analysis-issues","title":"Analysis Issues","text":""},{"location":"troubleshooting/#issue-rmsd-calculation-fails","title":"Issue: RMSD calculation fails","text":"<p>Error: \"Cannot compute RMSD\"</p> <p>Possible causes: - Topology/trajectory mismatch - Atom selection returns no atoms - Missing frames</p> <p>Solutions: 1. Verify topology matches trajectory:    <pre><code># Check atom counts\ngrep \"^ATOM\" topology.pdb | wc -l\n# Should match trajectory frame size\n</code></pre></p> <ol> <li>Test atom selection:</li> <li>Try simpler selection: just \"protein\"</li> <li> <p>Verify selection syntax</p> </li> <li> <p>Check trajectory integrity:    <pre><code>import MDAnalysis as mda\nu = mda.Universe(\"topology.psf\", \"trajectory.dcd\")\nprint(f\"Frames: {len(u.trajectory)}\")\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#issue-trajectory-loading-is-very-slow","title":"Issue: Trajectory loading is very slow","text":"<p>Causes: - Very large trajectory (&gt;10GB) - Network storage (slow I/O) - Many atoms selected</p> <p>Solutions: 1. Use more specific selection: \"protein and name CA\" instead of \"protein\" 2. Copy to local disk: Faster than network storage 3. Split trajectory: Analyze in smaller chunks 4. Use frame stride: Skip frames if possible</p>"},{"location":"troubleshooting/#issue-energy-plot-shows-weird-values","title":"Issue: Energy plot shows weird values","text":"<p>Symptoms: - Extremely large/small values - Discontinuities - Unexpected units</p> <p>Solutions: 1. Check unit selection:    - Verify kcal/mol vs kJ/mol    - Verify ps vs ns vs \u00b5s</p> <ol> <li>Verify log files are sequential:</li> <li>Check file order</li> <li> <p>Verify time assignments</p> </li> <li> <p>Check for parsing errors:</p> </li> <li>Look at status messages</li> <li> <p>Verify log files are from NAMD</p> </li> <li> <p>Plot individual files:</p> </li> <li>Remove all files</li> <li>Add one at a time</li> <li>Find problematic file</li> </ol>"},{"location":"troubleshooting/#issue-time-distribution-is-wrong","title":"Issue: Time distribution is wrong","text":"<p>Symptoms: - Files overlap on time axis - Gaps in timeline - Wrong total duration</p> <p>Solutions: 1. Check time assignments:    <pre><code>File1: 10 ns (not 10,000 ps)\nFile2: 50 ns\nResult: 0-10 ns, 10-60 ns \u2713\n</code></pre></p> <ol> <li>Verify file order:</li> <li>Use drag-and-drop to reorder</li> <li> <p>Equilibration before production</p> </li> <li> <p>Check for typos: 10 vs 100 ns makes big difference</p> </li> <li> <p>Clear and reassign: Remove all files, re-add in order</p> </li> </ol>"},{"location":"troubleshooting/#issue-plot-is-empty-or-not-updating","title":"Issue: Plot is empty or not updating","text":"<p>Solutions: 1. Verify data exists: Check status messages 2. Check plot ranges: Auto-scale or adjust manually 3. Verify columns selected: For NAMD analysis 4. Re-run analysis: Click \"Run Analysis\" again</p>"},{"location":"troubleshooting/#memory-issues","title":"Memory Issues","text":""},{"location":"troubleshooting/#issue-out-of-memory-error","title":"Issue: Out of memory error","text":"<p>Error: \"MemoryError\" or system freezes</p> <p>Causes: - Trajectory too large for available RAM - Multiple large analyses in memory - Memory leak (rare)</p> <p>Solutions: 1. Reduce atom selection: Use \"name CA\" instead of \"protein\" 2. Analyze in chunks: Split trajectory temporally 3. Close other applications: Free up RAM 4. Increase swap space (Linux):    <pre><code>sudo fallocate -l 8G /swapfile\nsudo chmod 600 /swapfile\nsudo mkswap /swapfile\nsudo swapon /swapfile\n</code></pre> 5. Use a machine with more RAM: For very large systems</p>"},{"location":"troubleshooting/#performance-issues","title":"Performance Issues","text":""},{"location":"troubleshooting/#issue-analysis-is-very-slow","title":"Issue: Analysis is very slow","text":"<p>Symptoms: - Progress bar barely moving - Hours for simple calculation - CPU not fully utilized</p> <p>Solutions: 1. Use simpler selections: Fewer atoms = faster 2. Check system load: Close background processes 3. Use SSD storage: Faster I/O for trajectory reading 4. Verify not swapping: Check memory usage with <code>htop</code> 5. Update libraries: Newer versions may be faster</p>"},{"location":"troubleshooting/#issue-gui-is-laggy","title":"Issue: GUI is laggy","text":"<p>Solutions: 1. Reduce plot updates: Don't update every frame 2. Close unused tabs: Free resources 3. Lower display resolution: If using remote X 4. Restart application: Clear accumulated state</p>"},{"location":"troubleshooting/#filepath-issues","title":"File/Path Issues","text":""},{"location":"troubleshooting/#issue-cannot-find-output-directory","title":"Issue: Cannot find output directory","text":"<p>Error: \"Output directory does not exist\"</p> <p>Solutions: 1. Create directory:    <pre><code>mkdir -p /path/to/output\n</code></pre> 2. Use absolute path: /home/user/output not ~/output 3. Check permissions: Must have write access 4. Verify path exists: No typos in directory name</p>"},{"location":"troubleshooting/#issue-cannot-save-results","title":"Issue: Cannot save results","text":"<p>Error: \"Permission denied\" or \"Cannot write file\"</p> <p>Solutions: 1. Check write permissions:    <pre><code>ls -ld /path/to/directory\n# Should show 'w' for write permission\n</code></pre> 2. Change permissions:    <pre><code>chmod u+w /path/to/directory\n</code></pre> 3. Save to different location: Your home directory 4. Run with proper user: Not as root (usually)</p>"},{"location":"troubleshooting/#propka-issues","title":"Propka Issues","text":""},{"location":"troubleshooting/#issue-propka-calculation-fails","title":"Issue: Propka calculation fails","text":"<p>Error: \"Propka failed\" or \"Cannot calculate pKa\"</p> <p>Solutions: 1. Check PDB format: Must be valid PDB 2. Clean PDB first: Remove heteroatoms 3. Check residue names: Must be standard amino acids 4. Update Propka:    <pre><code>pip install --upgrade propka\n</code></pre></p>"},{"location":"troubleshooting/#issue-protonation-states-seem-wrong","title":"Issue: Protonation states seem wrong","text":"<p>Verify: 1. pH value: Is it set correctly? 2. pKa values: Check against literature 3. Environment effects: Buried residues have shifted pKa</p> <p>Solutions: - Review pKa table in results - Check pKa shifts - Compare with similar structures - Manually adjust if needed</p>"},{"location":"troubleshooting/#platform-specific-issues","title":"Platform-Specific Issues","text":""},{"location":"troubleshooting/#linux","title":"Linux","text":"<p>Issue: libGL error <pre><code>libGL error: No matching fbConfigs or visuals found\n</code></pre> Solution: <pre><code>sudo apt-get install libgl1-mesa-glx\n</code></pre></p> <p>Issue: Permission denied for conda Solution: <pre><code># Fix conda ownership\nsudo chown -R $USER:$USER ~/miniconda3\n</code></pre></p>"},{"location":"troubleshooting/#macos","title":"macOS","text":"<p>Issue: App not trusted Solution: <pre><code># Allow running from unidentified developer\nxattr -d com.apple.quarantine /path/to/gatewizard\n</code></pre></p> <p>Issue: Retina display scaling Solution: Adjust display settings in System Preferences</p>"},{"location":"troubleshooting/#windows-wsl","title":"Windows (WSL)","text":"<p>Issue: X server not connecting Solution: <pre><code># In WSL, set DISPLAY correctly\nexport DISPLAY=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2}'):0\n\n# In X server (VcXsrv), disable access control\n</code></pre></p> <p>Issue: File path issues (Windows vs WSL paths) Solution: Use WSL paths (/mnt/c/...) inside WSL</p>"},{"location":"troubleshooting/#getting-more-help","title":"Getting More Help","text":"<p>If you're still experiencing issues:</p> <ol> <li>Check logs: Look at <code>gatewizard_logging.log</code> in working directory</li> <li>Run in debug mode: <code>gatewizard --debug</code></li> <li>Search issues: Check GitHub issues (if repository is public)</li> <li>Provide details: When asking for help, include:</li> <li>Operating system</li> <li>Python version (<code>python --version</code>)</li> <li>GateWizard version (<code>gatewizard --version</code>)</li> <li>Error messages (full traceback)</li> <li> <p>Steps to reproduce</p> </li> <li> <p>Contact developers:</p> </li> <li>Constanza Gonz\u00e1lez: constanza.gonzalez.villagra@gmail.com</li> <li>Mauricio Bedoya: mbedoya@ucm.cl</li> </ol>"},{"location":"troubleshooting/#faq","title":"FAQ","text":"<p>Q: How much RAM do I need? A: Minimum 4GB, 8GB+ recommended. Large trajectories may need 16GB+.</p> <p>Q: Can I run GateWizard remotely? A: Yes, with X forwarding: <code>ssh -X user@server</code> then run <code>gatewizard</code></p> <p>Q: Does GateWizard work with GPU acceleration? A: Not currently. Analysis is CPU-based.</p> <p>Q: Can I automate GateWizard? A: Python API is available for scripting (see API documentation).</p> <p>Q: What trajectory formats are supported? A: DCD, XTC, TRR, NetCDF, and others via MDAnalysis.</p> <p>Q: How do I cite GateWizard? A: Citation information to be added.</p> <p>This troubleshooting guide is continuously updated. Last update: October 2025</p>"},{"location":"user-guide/","title":"User Guide","text":"<p>This guide covers the main features and workflows in GateWizard.</p>"},{"location":"user-guide/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Getting Started</li> <li>Main Interface</li> <li>Preparation Tab - Structure Preparation</li> <li>Builder Tab - System Building</li> <li>Equilibration Tab - MD Equilibration</li> <li>Analysis Tab</li> <li>Visualization</li> </ol>"},{"location":"user-guide/#getting-started","title":"Getting Started","text":""},{"location":"user-guide/#launching-gatewizard","title":"Launching GateWizard","text":"<pre><code># Basic launch\ngatewizard\n\n# Launch on secondary monitor\ngatewizard --screen 1\n\n# Enable debug logging\ngatewizard --debug\n</code></pre>"},{"location":"user-guide/#first-time-setup","title":"First Time Setup","text":"<p>When you first launch GateWizard:</p> <ol> <li>The main window will appear with multiple tabs</li> <li>Each tab represents a different workflow or feature</li> <li>Start with the Preparation tab for structure preparation</li> <li>Use the Analysis tab for trajectory analysis</li> </ol>"},{"location":"user-guide/#main-interface","title":"Main Interface","text":"<p>The GateWizard interface consists of several main tabs:</p> <ul> <li>Preparation: Protein structure preparation and pKa calculations</li> <li>Builder: Membrane system building and setup</li> <li>Analysis: Trajectory and energy analysis</li> <li>Visualize: Structure and simulation visualization</li> </ul>"},{"location":"user-guide/#navigation","title":"Navigation","text":"<ul> <li>Click on tabs to switch between different features</li> <li>Each tab has its own input/output sections</li> <li>Status messages appear at the bottom of the window</li> <li>Use keyboard shortcuts for quick access (Ctrl+Q to quit)</li> </ul>"},{"location":"user-guide/#preparation-tab-structure-preparation","title":"Preparation Tab - Structure Preparation","text":"<p>The Preparation tab is used for protein structure preparation and protonation state analysis.</p>"},{"location":"user-guide/#basic-workflow","title":"Basic Workflow","text":"<ol> <li>Load PDB File</li> <li>Click \"Browse\" to select your PDB file</li> <li> <p>Or drag and drop a PDB file into the window</p> </li> <li> <p>Set pH Value</p> </li> <li>Enter the desired pH (default: 7.0)</li> <li> <p>This determines protonation states of ionizable residues</p> </li> <li> <p>Configure Options</p> </li> <li>Keep Hydrogens: Retain existing hydrogen atoms</li> <li>Clean PDB: Remove heteroatoms and non-standard residues</li> <li> <p>Protein Capping: Add ACE/NME caps to termini</p> </li> <li> <p>Run Analysis</p> </li> <li>Click \"Run Propka\"</li> <li>Results will show pKa values for each ionizable residue</li> <li> <p>Protonation states are assigned based on pH</p> </li> <li> <p>Export Results</p> </li> <li>Save the prepared structure</li> <li>Export pKa data for further analysis</li> </ol>"},{"location":"user-guide/#protein-capping","title":"Protein Capping","text":"<p>Protein capping adds protective groups to protein termini:</p> <ul> <li>ACE (N-terminus): Acetyl cap prevents artificial charges</li> <li>NME (C-terminus): N-methylamide cap neutralizes terminus</li> </ul> <p>When to use capping: - For fragments or peptides - When termini should not be charged - Before molecular dynamics simulations of protein segments</p> <p>How to use: 1. Enable \"Protein Capping\" checkbox 2. Run Propka analysis 3. Capped structure will be saved automatically</p>"},{"location":"user-guide/#understanding-pka-results","title":"Understanding pKa Results","text":"<p>The results table shows: - Residue: Amino acid and position - pKa: Calculated pKa value - Protonation: State at specified pH - Model pKa: Standard pKa value - Shift: Difference from standard (environmental effects)</p>"},{"location":"user-guide/#builder-tab-system-building","title":"Builder Tab - System Building","text":"<p>The Builder tab provides a comprehensive interface for building membrane protein systems using packmol-memgen and AmberTools.</p>"},{"location":"user-guide/#overview","title":"Overview","text":"<p>The Builder tab automates the process of: 1. Packing your protein into a lipid membrane 2. Adding water and ions 3. Parametrizing the system for molecular dynamics simulations 4. Generating all necessary input files (topology, coordinates, restraints)</p>"},{"location":"user-guide/#workflow-steps","title":"Workflow Steps","text":""},{"location":"user-guide/#1-set-working-directory","title":"1. Set Working Directory","text":"<ul> <li>Purpose: Defines where all generated files will be stored</li> <li>Click \"Browse\" to select or create a folder for your project</li> <li>All output files will be organized in subdirectories within this location</li> </ul>"},{"location":"user-guide/#2-select-working-file-pdb","title":"2. Select Working File (PDB)","text":"<ul> <li>Input: Your prepared protein structure (ideally from Propka analysis)</li> <li>Requirements: </li> <li>Clean PDB format</li> <li>Proper protonation states if using propka results</li> <li>Pre-oriented if using that option</li> <li>Browse to select your PDB file</li> </ul>"},{"location":"user-guide/#3-set-output-folder-name","title":"3. Set Output Folder Name","text":"<ul> <li>Default: \"preparation\"</li> <li>Customizable: Give a meaningful name for your system</li> <li>Result: Creates a subfolder within working directory</li> </ul>"},{"location":"user-guide/#4-configure-lipid-composition","title":"4. Configure Lipid Composition","text":"<p>Upper Leaflet: - Select one or more lipid types (POPC, POPE, POPS, etc.) - Set molar ratios (must sum to 1.0) - Common: 100% POPC for simple systems</p> <p>Lower Leaflet: - Can match upper leaflet (symmetric) or differ (asymmetric) - Supports complex compositions (e.g., 70% POPC + 30% CHOL)</p> <p>Available Lipid Types: - Phospholipids: POPC, POPE, POPS, DOPC, DPPC - Cholesterol: CHOL - Specialized: POPG, DOPE, and many more</p>"},{"location":"user-guide/#5-select-force-fields","title":"5. Select Force Fields","text":"<p>Water Model: TIP3P, TIP4P, SPC/E - Default: TIP3P (most common for biological systems)</p> <p>Protein Force Field: ff14SB, ff19SB, ff14IDPSFF - Default: ff14SB (reliable for most proteins) - ff19SB: Improved backbone parameters</p> <p>Lipid Force Field: lipid21, lipid17, lipid14 - Default: lipid21 (most recent)</p>"},{"location":"user-guide/#6-system-options","title":"6. System Options","text":"<p>Protein is pre-oriented (checked by default) - Your protein is already positioned correctly in membrane - Uncheck if protein needs automatic orientation</p> <p>Run parametrization with tleap (checked by default) - Generates topology (.prmtop) and coordinates (.inpcrd) - Required for MD simulations - Uncheck to only pack the system</p> <p>Add salt (checked by default) - Neutralizes system and adds physiological ionic strength - Concentration: 0.15 M (default, physiological) - Cation: Na+ (default) - Anion: Cl- (default)</p> <p>Water layer thickness: 17.5 \u00c5 (default) - Distance of water above and below membrane/protein - Adjust for larger proteins or specific requirements</p> <p>Skip protonation (preserve propka results) (checked by default) - Preserves your protonation states from Propka analysis - Residue names like GLH, ASH, HIP are kept - Prevents tleap from re-protonating based on default pKa</p>"},{"location":"user-guide/#7-validate-and-start-preparation","title":"7. Validate and Start Preparation","text":"<ol> <li>Click \"Validate Inputs\"</li> <li>Checks all parameters</li> <li>Verifies file existence</li> <li>Ensures lipid ratios are valid</li> <li> <p>Enables \"Start Preparation\" button</p> </li> <li> <p>Click \"Start Preparation\"</p> </li> <li>Launches packmol-memgen to pack the system</li> <li>Runs tleap for parametrization (if enabled)</li> <li>Generates all necessary files</li> <li>Process runs in background</li> </ol>"},{"location":"user-guide/#8-monitor-progress","title":"8. Monitor Progress","text":"<p>The Progress section shows: - Job name and status - Start time - Current stage - Completion status - Links to output directories</p> <p>Refresh button updates the status of all jobs</p>"},{"location":"user-guide/#output-files","title":"Output Files","text":"<p>After successful preparation, you'll find:</p> <p>In <code>{output_folder_name}/</code> directory: - <code>bilayer_*.pdb</code> - Packed system structure - <code>system.prmtop</code> - AMBER topology file - <code>system.inpcrd</code> - AMBER coordinate file - <code>system_solv.pdb</code> - Solvated system PDB - Various log files for troubleshooting</p>"},{"location":"user-guide/#common-use-cases","title":"Common Use Cases","text":"<p>Case 1: Simple Symmetric Membrane <pre><code>Upper Leaflet: POPC 100%\nLower Leaflet: POPC 100%\nForce Field: ff14SB + lipid21\nSalt: 0.15 M NaCl\n</code></pre></p> <p>Case 2: Asymmetric Membrane <pre><code>Upper Leaflet: POPC 70% + CHOL 30%\nLower Leaflet: POPE 50% + POPS 50%\n</code></pre></p> <p>Case 3: Custom Protonation <pre><code>1. Run Propka at pH 5.0\n2. Modify residue names in PDB (GLU \u2192 GLH for protonated)\n3. Enable \"Skip protonation\" in Builder tab\n4. Run preparation\n</code></pre></p>"},{"location":"user-guide/#tips-and-best-practices","title":"Tips and Best Practices","text":"<ol> <li>Always run Propka first to determine correct protonation states</li> <li>Use \"Load Defaults\" to quickly populate recommended force fields</li> <li>Verify lipid ratios sum to 1.0 for each leaflet</li> <li>Check log files if preparation fails</li> <li>Use meaningful names for output folders to organize multiple systems</li> <li>Keep parametrization enabled unless you have specific reasons not to</li> </ol>"},{"location":"user-guide/#troubleshooting","title":"Troubleshooting","text":"<p>\"PDB file not found\": Check file path and permissions</p> <p>\"Invalid lipid ratios\": Ensure ratios sum to exactly 1.0</p> <p>\"Parametrization failed\":  - Check for non-standard residues - Verify protonation states - Review tleap log files</p> <p>\"Process failed\": See log files in output directory for details</p>"},{"location":"user-guide/#equilibration-tab-md-equilibration","title":"Equilibration Tab - MD Equilibration","text":"<p>The Equilibration tab automates the generation and execution of multi-stage equilibration protocols for molecular dynamics simulations using NAMD.</p>"},{"location":"user-guide/#overview_1","title":"Overview","text":"<p>Equilibration is critical before production MD simulations. This tab: 1. Generates a series of equilibration stages with gradually relaxing restraints 2. Creates NAMD input files based on CHARMM-GUI protocols 3. Handles minimization, heating, and equilibration 4. Supports NVT, NPT, NPAT, and NP\u03b3T ensembles 5. Can run simulations in the background</p>"},{"location":"user-guide/#workflow-steps_1","title":"Workflow Steps","text":""},{"location":"user-guide/#1-set-working-directory_1","title":"1. Set Working Directory","text":"<ul> <li>Select the directory containing your prepared system</li> <li>Should contain <code>.prmtop</code> and <code>.inpcrd</code> files from Builder tab</li> </ul>"},{"location":"user-guide/#2-set-output-folder-name","title":"2. Set Output Folder Name","text":"<ul> <li>Default: \"equilibration\"</li> <li>Creates a subfolder for equilibration files</li> <li>Organized by engine: <code>equilibration/namd/</code></li> </ul>"},{"location":"user-guide/#3-select-md-engine","title":"3. Select MD Engine","text":"<p>Currently supported: NAMD - NAMD 2.x and NAMD 3 compatible - GPU acceleration supported - Future: GROMACS, AMBER support planned</p>"},{"location":"user-guide/#4-configure-namd-settings","title":"4. Configure NAMD Settings","text":"<p>NAMD Executable: - Default: \"namd3\" - Change if using namd2 or custom path</p>"},{"location":"user-guide/#5-select-equilibration-scheme","title":"5. Select Equilibration Scheme","text":"<p>Available Schemes:</p> <p>NVT (Constant Volume, Temperature) - For initial equilibration - No pressure control - Quick equilibration</p> <p>NPT (Constant Pressure, Temperature) - Most common for protein systems - Isotropic pressure coupling - Standard for protein-water systems</p> <p>NPAT (Constant Pressure, Area, Temperature) - Recommended for membrane systems - Fixed membrane area (XY plane) - Semi-isotropic pressure (Z-axis only) - Prevents membrane from shrinking/expanding</p> <p>NP\u03b3T (Constant Surface Tension) - Surface tension control - Membrane-water interface systems</p>"},{"location":"user-guide/#6-set-simulation-parameters","title":"6. Set Simulation Parameters","text":"<p>Temperature: 310.15 K (default, 37\u00b0C physiological) - Range: 273-350 K typically - Higher for denaturation studies</p> <p>Pressure: 1.0 bar (default, atmospheric)</p> <p>Timestep: 1.0-2.0 fs - 1.0 fs for minimization/initial stages - 2.0 fs for production with constrained hydrogens</p>"},{"location":"user-guide/#7-configure-protocol-stages","title":"7. Configure Protocol Stages","text":"<p>The equilibration protocol consists of 6 stages + production:</p> <p>Stage 1: Equilibration 1 - Strong Restraints - Duration: 0.125 ns (125 ps) - Includes initial minimization (10,000 steps) - Strong restraints on protein backbone (10 kcal/mol/\u0172) - Purpose: Remove bad contacts</p> <p>Stage 2: Equilibration 2 - Heavy Restraints - Duration: 0.125 ns - Moderate restraints (5-10 kcal/mol/\u0172) - Purpose: Allow side chains to relax</p> <p>Stage 3: Equilibration 3 - Moderate Restraints - Duration: 0.125 ns - Reduced restraints (2-5 kcal/mol/\u0172) - Purpose: Relax protein-lipid interface</p> <p>Stage 4: Equilibration 4 - Light Restraints - Duration: 0.125 ns - Minimal restraints (1-2 kcal/mol/\u0172) - Purpose: Equilibrate lipid headgroups</p> <p>Stage 5: Equilibration 5 - Minimal Restraints - Duration: 0.125 ns - Very light restraints (0.5-1 kcal/mol/\u0172) - Purpose: Final equilibration</p> <p>Stage 6: Equilibration 6 - Final Equilibration - Duration: 0.125 ns - Nearly unrestrained - Purpose: Verify system stability</p> <p>Production - Duration: 1.0 ns (customizable) - No restraints - Full dynamics</p> <p>Per-Stage Customization: - Adjust duration (time_ns) - Set CPU cores or enable GPU - Modify restraint strengths - Change timestep</p>"},{"location":"user-guide/#8-generate-input-files","title":"8. Generate Input Files","text":"<p>Click \"Generate Input Files\"</p> <p>This creates: - NAMD configuration files for each stage - Restraint files (PDB format with beta factors) - Run script (<code>run_equilibration.sh</code>) - Protocol summary (<code>protocol_summary.json</code>)</p> <p>Output Structure: <pre><code>equilibration/namd/\n\u251c\u2500\u2500 step1_equilibration.conf\n\u251c\u2500\u2500 step2_equilibration.conf\n\u251c\u2500\u2500 ...\n\u251c\u2500\u2500 step6_equilibration.conf\n\u251c\u2500\u2500 production.conf\n\u251c\u2500\u2500 step1_restraints.pdb\n\u251c\u2500\u2500 step2_restraints.pdb\n\u251c\u2500\u2500 ...\n\u251c\u2500\u2500 run_equilibration.sh\n\u2514\u2500\u2500 protocol_summary.json\n</code></pre></p>"},{"location":"user-guide/#9-run-equilibration","title":"9. Run Equilibration","text":"<p>Click \"Run Equilibration\"</p> <p>Options: - Background process: Runs independently, terminal can be closed - Progress tracking: Monitor via log files - Stage-by-stage: Each stage runs sequentially - Automatic: Stops on error</p> <p>Monitoring: - Check <code>.log</code> files for each stage - Review DCD trajectory files - Monitor energy output</p>"},{"location":"user-guide/#restraint-system","title":"Restraint System","text":"<p>Restraints gradually released across stages:</p> Stage Protein Backbone Protein Sidechain Lipid Heads Water 1 10.0 5.0 2.0 0.0 2 5.0 2.5 1.0 0.0 3 2.5 1.0 0.5 0.0 4 1.0 0.5 0.1 0.0 5 0.5 0.1 0.0 0.0 6 0.1 0.0 0.0 0.0 Prod 0.0 0.0 0.0 0.0 <p>Units: kcal/mol/\u0172</p>"},{"location":"user-guide/#common-use-cases_1","title":"Common Use Cases","text":"<p>Case 1: Standard Membrane Protein Equilibration <pre><code>Scheme: NPAT\nTemperature: 310.15 K\nPressure: 1.0 bar\nTimestep: 2.0 fs\nProtocol: Default 6-stage + production\nGPU: Enabled for faster stages\n</code></pre></p> <p>Case 2: Quick Test Equilibration <pre><code>Reduce all stage times to 0.05 ns\nTotal: ~0.5 ns\nUse for testing system stability\n</code></pre></p> <p>Case 3: Extended Equilibration <pre><code>Increase each stage to 0.5 ns\nAdd longer production (10+ ns)\nFor large conformational changes\n</code></pre></p>"},{"location":"user-guide/#best-practices","title":"Best Practices","text":"<ol> <li>Always minimize first: Stage 1 includes minimization</li> <li>Use NPAT for membranes: Preserves membrane area</li> <li>Monitor energy: Should stabilize without drift</li> <li>Check temperature: Should be stable within \u00b11-2 K</li> <li>Verify pressure: Fluctuates but centered on target</li> <li>Review trajectories: Visual inspection for artifacts</li> <li>Test on small system first: Verify protocol before production</li> </ol>"},{"location":"user-guide/#running-on-hpc-clusters","title":"Running on HPC Clusters","text":"<p>The generated <code>run_equilibration.sh</code> can be adapted for: - SLURM job scheduler - PBS/Torque systems - SGE clusters</p> <p>Modify the script header to add: <pre><code>#SBATCH --nodes=1\n#SBATCH --ntasks-per-node=16\n#SBATCH --gres=gpu:1\n#SBATCH --time=24:00:00\n</code></pre></p>"},{"location":"user-guide/#troubleshooting_1","title":"Troubleshooting","text":"<p>\"No topology files found\": Run Builder tab first</p> <p>\"NAMD executable not found\":  - Install NAMD or specify full path - Test: <code>namd3 --version</code></p> <p>\"Simulation crashes\": - Check for atom overlaps (increase minimization) - Verify system was properly prepared - Review energy components in log files</p> <p>\"System explodes\": - Timestep too large (try 1.0 fs) - Insufficient minimization - Bad initial structure</p> <p>\"Slow performance\": - Enable GPU if available - Increase CPU cores for non-GPU stages - Check system size vs hardware</p>"},{"location":"user-guide/#analysis-tab","title":"Analysis Tab","text":"<p>The Analysis tab provides tools for analyzing molecular dynamics trajectories and energy data.</p>"},{"location":"user-guide/#structural-analysis","title":"Structural Analysis","text":"<p>Analyze trajectory files (.dcd, .xtc, .trr) with various metrics:</p>"},{"location":"user-guide/#rmsd-root-mean-square-deviation","title":"RMSD (Root Mean Square Deviation)","text":"<p>Measures structural deviation over time:</p> <ol> <li>Load Topology: Select PSF or PDB topology file</li> <li>Add Trajectories: Load one or more trajectory files</li> <li>Assign Time (optional): Specify simulation time for each file</li> <li>Select Analysis Type: Choose \"RMSD\"</li> <li>Configure:</li> <li>Reference frame (default: 0)</li> <li>Atom selection (default: protein)</li> <li>Alignment option</li> <li>Run Analysis: Calculate and plot RMSD</li> </ol>"},{"location":"user-guide/#rmsf-root-mean-square-fluctuation","title":"RMSF (Root Mean Square Fluctuation)","text":"<p>Measures per-residue flexibility:</p> <ol> <li>Load topology and trajectories</li> <li>Select \"RMSF\" analysis type</li> <li>Choose atom selection (backbone, C-alpha, etc.)</li> <li>Run analysis</li> <li>Results show flexibility per residue</li> </ol>"},{"location":"user-guide/#distance-analysis","title":"Distance Analysis","text":"<p>Track distances between specific atoms or residues:</p> <ol> <li>Load topology and trajectories</li> <li>Select \"Distances\"</li> <li>Define atom pairs (e.g., \"resid 10 and name CA\" to \"resid 50 and name CA\")</li> <li>Run analysis</li> <li>Plot shows distance evolution over time</li> </ol>"},{"location":"user-guide/#radius-of-gyration","title":"Radius of Gyration","text":"<p>Measures compactness of the structure:</p> <ol> <li>Load topology and trajectories</li> <li>Select \"Radius of Gyration\"</li> <li>Choose atom selection</li> <li>Run analysis</li> <li>Rg values indicate structural compactness</li> </ol>"},{"location":"user-guide/#energetic-analysis","title":"Energetic Analysis","text":"<p>Analyze NAMD log files for energies, temperature, and pressure:</p> <ol> <li>Load Log Files: Add one or more NAMD .log files</li> <li>Assign Time (optional): Specify simulation time for each file</li> <li>If assigned: Points distributed evenly across time</li> <li>If not assigned: Uses timestep column</li> <li>Select Data: Choose what to plot (TOTENG, TEMP, PRESSURE, etc.)</li> <li>Configure Units:</li> <li>X-Axis: ps, ns, or \u00b5s</li> <li>Y-Axis (Energy): kcal/mol or kJ/mol</li> <li>Plot: Visualize energy evolution</li> </ol>"},{"location":"user-guide/#plot-customization","title":"Plot Customization","text":"<p>Both Structural and Energetic Analysis offer plot customization:</p> <ul> <li>Title: Custom plot title</li> <li>Axis Labels: Customize X and Y labels</li> <li>Units: Change display units</li> <li>Colors: Background and line colors</li> <li>Ranges: Set X and Y axis limits</li> <li>Export: Save plots as PNG or SVG</li> </ul>"},{"location":"user-guide/#exporting-data","title":"Exporting Data","text":"<p>Multiple export formats available:</p> <ul> <li>CSV: Spreadsheet-compatible format</li> <li>JSON: Structured data format</li> <li>NumPy: For Python analysis (.npz files)</li> <li>Plots: PNG or SVG images</li> </ul>"},{"location":"user-guide/#visualization","title":"Visualization","text":"<p>The Visualize tab provides structure viewing and analysis display.</p>"},{"location":"user-guide/#features","title":"Features","text":"<ul> <li>Load and display protein structures</li> <li>View molecular dynamics trajectories</li> <li>Inspect protonation states</li> <li>Examine system setup</li> </ul>"},{"location":"user-guide/#controls","title":"Controls","text":"<ul> <li>Rotate: Left-click and drag</li> <li>Zoom: Scroll wheel</li> <li>Pan: Right-click and drag</li> <li>Reset view: Double-click</li> </ul>"},{"location":"user-guide/#tips-and-best-practices_1","title":"Tips and Best Practices","text":""},{"location":"user-guide/#structure-preparation","title":"Structure Preparation","text":"<ol> <li>Always clean PDB files before analysis</li> <li>Check protonation states carefully</li> <li>Use capping for fragments</li> <li>Verify hydrogen placement</li> </ol>"},{"location":"user-guide/#trajectory-analysis","title":"Trajectory Analysis","text":"<ol> <li>Assign times correctly: For concatenated trajectories, assign each file's duration</li> <li>Choose appropriate selections: Use \"protein and name CA\" for faster RMSD</li> <li>Align structures: Enable alignment for RMSD calculations</li> <li>Check convergence: RMSD should plateau in equilibrated simulations</li> </ol>"},{"location":"user-guide/#energy-analysis","title":"Energy Analysis","text":"<ol> <li>Sequential files: Assign times to place files one after another</li> <li>Unit selection: Choose appropriate units for your field (ns, kcal/mol common in MD)</li> <li>Multiple properties: Plot multiple energy terms to check system stability</li> <li>Export data: Save data for further statistical analysis</li> </ol>"},{"location":"user-guide/#performance","title":"Performance","text":"<ul> <li>Large trajectories (&gt;1000 frames) may take time to load</li> <li>Use atom selections to speed up analysis</li> <li>Close unused tabs to free memory</li> <li>Export results regularly</li> </ul>"},{"location":"user-guide/#keyboard-shortcuts","title":"Keyboard Shortcuts","text":"<ul> <li>Ctrl+Q: Quit application</li> <li>Ctrl+O: Open file (in relevant contexts)</li> <li>Ctrl+S: Save (in relevant contexts)</li> <li>Tab: Navigate between fields</li> </ul>"},{"location":"user-guide/#common-workflows","title":"Common Workflows","text":""},{"location":"user-guide/#workflow-1-prepare-protein-for-md","title":"Workflow 1: Prepare Protein for MD","text":"<ol> <li>Load PDB in Preparation tab</li> <li>Set pH and enable cleaning</li> <li>Run Propka</li> <li>Review and save prepared structure</li> <li>(Optional) Add capping if needed</li> <li>Move to Builder tab for further setup</li> </ol>"},{"location":"user-guide/#workflow-2-analyze-md-trajectory","title":"Workflow 2: Analyze MD Trajectory","text":"<ol> <li>Go to Analysis tab \u2192 Structural Analysis</li> <li>Load topology file (PSF/PDB)</li> <li>Add trajectory files in order</li> <li>Assign times if files are from separate runs</li> <li>Select RMSD analysis</li> <li>Run and examine results</li> <li>Export plot and data</li> </ol>"},{"location":"user-guide/#workflow-3-check-system-stability","title":"Workflow 3: Check System Stability","text":"<ol> <li>Go to Analysis tab \u2192 Energetic Analysis</li> <li>Load NAMD log files</li> <li>Assign simulation times</li> <li>Plot TOTENG, TEMP, and PRESSURE</li> <li>Verify:</li> <li>Energy is stable (no drift)</li> <li>Temperature is constant (\u00b11-2 K)</li> <li>Pressure fluctuates around target</li> <li>Export data for records</li> </ol>"},{"location":"user-guide/#next-steps","title":"Next Steps","text":"<ul> <li>Explore the Analysis Features in detail</li> <li>Check Troubleshooting for common issues</li> <li>Review API Reference for scripting</li> </ul> <p>For questions or issues, please contact the developers.</p>"},{"location":"api/","title":"API Reference Overview","text":"<p>Welcome to the GateWizard API documentation. This reference provides detailed information about all modules, classes, methods, and functions available in GateWizard.</p>"},{"location":"api/#available-modules","title":"Available Modules","text":""},{"location":"api/#preparation-module","title":"Preparation Module","text":"<p>Module for predicting pKa values and managing protonation states in protein structures.</p> <p>Key Features: - pKa prediction and analysis - Protonation state assignment based on pH - Disulfide bond detection and application - Protein capping with ACE/NME groups - pH-dependent protein structure preparation</p> <p>Main Classes: <code>PropkaAnalyzer</code>, <code>ProteinCapper</code></p>"},{"location":"api/#builder-module","title":"Builder Module","text":"<p>Module for building and preparing molecular dynamics simulation systems.</p> <p>Key Features: - System configuration and setup - Integration with CHARMM-GUI - Membrane protein system preparation</p> <p>Main Classes: <code>SystemBuilder</code></p>"},{"location":"api/#equilibration-module","title":"Equilibration Module","text":"<p>Module for managing equilibration protocols and workflows.</p> <p>Key Features: - NAMD equilibration protocol generation - Configuration file management - CHARMM-GUI template integration</p> <p>Main Classes: <code>NAMDEquilibrationManager</code></p>"},{"location":"api/#analysis-module","title":"Analysis Module","text":"<p>Module for analyzing simulation results and monitoring progress.</p> <p>Key Features: - Equilibration progress monitoring - NAMD log file parsing - Result analysis and reporting</p> <p>Main Functions: <code>get_equilibration_progress()</code>, <code>parse_namd_log()</code></p>"},{"location":"api/#quick-links","title":"Quick Links","text":"<ul> <li>Quick Reference - Common patterns and snippets</li> <li>User Guide - Step-by-step tutorials</li> <li>Examples Directory - Complete workflow examples</li> </ul>"},{"location":"api/#getting-help","title":"Getting Help","text":"<p>If you need additional help:</p> <ol> <li>Check the Troubleshooting Guide</li> <li>Review the User Guide for practical examples</li> <li>See complete workflow examples in the <code>examples/</code> directory</li> </ol>"},{"location":"api/#module-organization","title":"Module Organization","text":"<p>Each module documentation page includes:</p> <ul> <li>Import statements - How to import the module</li> <li>Class/Function signatures - Detailed method signatures</li> <li>Parameters - Complete parameter descriptions</li> <li>Returns - Return types and values</li> <li>Examples - Practical code examples</li> <li>Workflows - Complete usage patterns</li> </ul>"},{"location":"api/analysis/","title":"Analysis Module API","text":"<p>Module for analyzing MD trajectories and NAMD energy data with easy-to-use wrapper classes supporting all GUI options.</p>"},{"location":"api/analysis/#overview","title":"Overview","text":"<p>The analysis module provides two main classes:</p> <ul> <li><code>EnergyAnalyzer</code> - Parse and plot NAMD energy data with full customization</li> <li><code>TrajectoryAnalyzer</code> - Calculate and plot RMSD, RMSF, distances, and radius of gyration with complete control</li> </ul> <p>Key Features:</p> <ul> <li>Simple 2-line API for quick analysis</li> <li>Full customization with all GUI options</li> <li>Multi-file support with proper time scaling</li> <li>Unit conversions (\u00c5/nm, ps/ns/\u00b5s, kcal/kJ)</li> <li>Publication-quality plots (300 DPI)</li> </ul>"},{"location":"api/analysis/#import","title":"Import","text":"<pre><code>from gatewizard.utils.namd_analysis import (\n    EnergyAnalyzer,\n    TrajectoryAnalyzer,\n    get_equilibration_progress\n)\n</code></pre>"},{"location":"api/analysis/#using-custom-time-input-in-the-gui","title":"Using Custom Time Input in the GUI","text":""},{"location":"api/analysis/#for-trajectory-files-dcd-xtc-trr","title":"For Trajectory Files (.dcd, .xtc, .trr)","text":"<p>When analyzing multiple trajectory files in the GUI Structural Analysis tab:</p> <ol> <li>Add Files: Click \"Add Files\" or \"Add Folder\" to load trajectory files</li> <li>Input Time: Each file will appear in the list with a time input field showing \"Time (ns)\"</li> <li>Enter Duration: Enter the simulation duration for each file in nanoseconds</li> <li>Example: For a 50 ps simulation, enter <code>0.05</code> (50 ps = 0.05 ns)</li> <li>Auto-Detect: Click \"Auto-Detect Time\" to automatically extract times from DCD headers</li> <li>Reorder: Drag files using the <code>:::</code> handle to reorder if needed</li> </ol> <p>Example File List: <pre><code>:::  step1_equilibration.dcd    [0.05] ns\n:::  step2_equilibration.dcd    [0.05] ns  \n:::  step3_equilibration.dcd    [0.05] ns\n</code></pre> Total time: 0.15 ns (150 ps) continuous</p>"},{"location":"api/analysis/#for-energy-log-files-log","title":"For Energy Log Files (.log)","text":"<p>When analyzing NAMD log files in the GUI Energetic Analysis tab:</p> <ol> <li>Add Files: Click \"Add Files\" or \"Add Folder\" to load NAMD log files</li> <li>Input Time: Each file will appear with a time input field</li> <li>Enter Duration: Enter the simulation duration for each file in nanoseconds</li> <li>Example: For step1_equilibration.log (50 ps), enter <code>0.05</code></li> <li>Auto-Detect: Click \"Auto-Detect Time\" to extract from log file timestamps</li> <li>Plot: The time axis will scale correctly across all files</li> </ol> <p>Example File List: <pre><code>:::  step1_equilibration.log    [0.05] ns\n:::  step2_equilibration.log    [0.05] ns\n:::  step7_production.log       [0.10] ns\n</code></pre></p> <p>Important Notes:</p> <ul> <li>Time input is the duration of each file, not cumulative</li> <li>Files are processed in order - time is sequential (file1: 0-50ps, file2: 50-100ps, etc.)</li> <li>Leave empty or 0 to use default timestep-based calculation</li> <li>Time unit is always nanoseconds in the input fields</li> <li>You can change display units (ps/ns/\u00b5s) in Plot Settings</li> </ul>"},{"location":"api/analysis/#class-energyanalyzer","title":"Class: EnergyAnalyzer","text":"<p>Easy-to-use wrapper for NAMD energy analysis with built-in plotting and customization.</p>"},{"location":"api/analysis/#constructor","title":"Constructor","text":"<pre><code>EnergyAnalyzer(\n    log_file: Union[Path, str, List[Union[Path, str]]],\n    file_times: Optional[Dict[str, float]] = None\n)\n</code></pre> <p>Initialize energy analyzer with NAMD log file(s).</p> <p>Parameters:</p> <p><code>log_file</code> (Path, str, or List): Path to NAMD log file, or list of paths for multi-file analysis</p> <ul> <li>Single file: <code>\"step1_equilibration.log\"</code></li> <li>Multiple files: <code>[\"step1.log\", \"step2.log\", \"step3.log\"]</code></li> </ul> <p><code>file_times</code> (Dict[str, float], optional): Mapping of log filenames to their simulation durations in nanoseconds</p> <ul> <li>Example: <code>{\"step1.log\": 0.05, \"step2.log\": 0.05, \"step3.log\": 0.05}</code></li> <li>Important: Use just the filename (not full path) as the key</li> <li>Time is the duration of each file, not cumulative</li> <li>Note: In the GUI, you can input times for each file directly in the file list</li> </ul> <p>Examples: <pre><code># Single file\nanalyzer = EnergyAnalyzer(\"step1_equilibration.log\")\n\n# Multiple files with custom time\nanalyzer = EnergyAnalyzer(\n    [\"step1.log\", \"step2.log\", \"step3.log\"],\n    file_times={\n        \"step1.log\": 0.05,  # 50 ps = 0.05 ns\n        \"step2.log\": 0.05,\n        \"step3.log\": 0.05\n    }\n)\n</code></pre></p>"},{"location":"api/analysis/#method-plot_energy","title":"Method: <code>plot_energy()</code>","text":"<p>Create a 4-panel energy analysis plot with full customization.</p> <pre><code>plot_energy(\n    energy_units: str = \"kcal/mol\",\n    time_units: str = \"ns\",\n    target_temperature: Optional[float] = None,\n    target_pressure: Optional[float] = None,\n    bg_color: str = \"#2b2b2b\",\n    fig_bg_color: str = \"#212121\",\n    text_color: str = \"Auto\",\n    show_grid: bool = True,\n    title: Optional[str] = None,\n    save: Optional[str] = None,\n    show: bool = False,\n    figsize: tuple = (12, 10),\n    dpi: int = 300\n)\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>energy_units</code> str <code>\"kcal/mol\"</code> Energy units: <code>\"kcal/mol\"</code> or <code>\"kJ/mol\"</code> <code>time_units</code> str <code>\"ns\"</code> Time units: <code>\"ps\"</code>, <code>\"ns\"</code>, or <code>\"\u00b5s\"</code> <code>target_temperature</code> float or None <code>None</code> Target temperature for reference line (K). Defaults to 300.0 K if not provided. <code>target_pressure</code> float or None <code>None</code> Target pressure for reference line (atm). Defaults to 1.0 atm if not provided. <code>bg_color</code> str <code>\"#2b2b2b\"</code> Plot area background color (hex or <code>\"none\"</code>) <code>fig_bg_color</code> str <code>\"#212121\"</code> Figure border background color (hex or <code>\"none\"</code>) <code>text_color</code> str <code>\"Auto\"</code> Text/axes color (<code>\"Auto\"</code>, color name, or hex) <code>show_grid</code> bool <code>True</code> Show grid lines on plots <code>title</code> str or None <code>None</code> Custom main title (auto-generated if None) <code>save</code> str or None <code>None</code> Filename to save plot <code>show</code> bool <code>False</code> Display plot interactively <code>figsize</code> tuple <code>(12, 10)</code> Figure size (width, height) in inches <code>dpi</code> int <code>300</code> Resolution for saved figure <p>Plots Generated:</p> <ol> <li>Total Energy - Convergence over time</li> <li>Potential &amp; Kinetic - Energy components</li> <li>Temperature - Stability with target line</li> <li>Pressure - Fluctuations (or energy components if no pressure)</li> </ol>"},{"location":"api/analysis/#method-plot_properties","title":"Method: <code>plot_properties()</code>","text":"<p>Create custom plots of selected energy/thermodynamic properties with full control over visualization.</p> <p>This method provides complete API access to all GUI plotting capabilities, allowing users to:</p> <ul> <li>Analyze multiple log files with custom time assignments</li> <li>Select specific properties to plot</li> <li>Combine or separate data from multiple files</li> <li>Apply full customization (colors, units, grid, limits, etc.)</li> </ul> <pre><code>plot_properties(\n    properties: Union[str, List[str]],\n    separate_plots: bool = False,\n    energy_units: str = \"kcal/mol\",\n    time_units: str = \"ns\",\n    line_colors: Optional[Union[str, List[str]]] = None,\n    bg_color: str = \"#2b2b2b\",\n    fig_bg_color: str = \"#212121\",\n    text_color: str = \"Auto\",\n    grid_color: str = \"#444444\",\n    show_grid: bool = True,\n    xlim: Optional[tuple] = None,\n    ylim: Optional[tuple] = None,\n    title: Optional[str] = None,\n    save_prefix: Optional[str] = None,\n    show: bool = False,\n    figsize: tuple = (10, 6),\n    dpi: int = 300\n)\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>properties</code> str or List[str] - Property name(s) to plot. See available properties below. <code>separate_plots</code> bool <code>False</code> If True, create individual plots per file; if False, combine all files on same plot <code>energy_units</code> str <code>\"kcal/mol\"</code> Energy units: <code>\"kcal/mol\"</code> or <code>\"kJ/mol\"</code> <code>time_units</code> str <code>\"ns\"</code> Time units: <code>\"ps\"</code>, <code>\"ns\"</code>, or <code>\"\u00b5s\"</code> <code>line_colors</code> str or List[str] <code>None</code> Line color(s). Single color or list for multiple files. Auto-assigned if None. <code>bg_color</code> str <code>\"#2b2b2b\"</code> Plot area background color (hex, color name, or <code>\"none\"</code>) <code>fig_bg_color</code> str <code>\"#212121\"</code> Figure border background color (hex, color name, or <code>\"none\"</code>) <code>text_color</code> str <code>\"Auto\"</code> Text/axes color. <code>\"Auto\"</code> auto-detects from bg luminance. <code>grid_color</code> str <code>\"#444444\"</code> Grid line color (hex or color name) <code>show_grid</code> bool <code>True</code> Show grid lines <code>xlim</code> tuple or None <code>None</code> X-axis limits: <code>(min, max)</code> <code>ylim</code> tuple or None <code>None</code> Y-axis limits: <code>(min, max)</code> <code>title</code> str or None <code>None</code> Custom plot title (auto-generated if None) <code>save_prefix</code> str or None <code>None</code> Prefix for saved filenames. Files saved as <code>{prefix}_{property}.png</code> <code>show</code> bool <code>False</code> Display plot interactively <code>figsize</code> tuple <code>(10, 6)</code> Figure size (width, height) in inches <code>dpi</code> int <code>300</code> Resolution for saved figures <p>Available Properties:</p> <p>Use <code>get_available_properties()</code> method to see all properties in your log file(s).</p> <p>Note: Property names are case-insensitive and support multiple formats. For example, to plot temperature, you can use:</p> <ul> <li><code>\"TEMP\"</code>, <code>\"temp\"</code>, <code>\"Temp\"</code> (short names)</li> <li><code>\"Temperature\"</code>, <code>\"TEMPERATURE\"</code>, <code>\"temperature\"</code> (full names)</li> <li>Any mixed case variation like <code>\"TeMpErAtUrE\"</code> will also work!</li> </ul> <p>The same applies to all properties - use whatever format is most convenient for you.</p> Property Alternative Names Description Units <code>\"TOTAL\"</code> <code>\"Total\"</code>, <code>\"total\"</code>, <code>\"Total Energy\"</code>, etc. Total energy kcal/mol or kJ/mol <code>\"KINETIC\"</code> <code>\"Kinetic\"</code>, <code>\"kinetic\"</code>, <code>\"kin\"</code>, <code>\"Kinetic Energy\"</code> Kinetic energy kcal/mol or kJ/mol <code>\"POTENTIAL\"</code> <code>\"Potential\"</code>, <code>\"potential\"</code>, <code>\"pot\"</code>, <code>\"Potential Energy\"</code> Potential energy kcal/mol or kJ/mol <code>\"ELECT\"</code> <code>\"Elect\"</code>, <code>\"elect\"</code>, <code>\"elec\"</code>, <code>\"Electrostatic Energy\"</code> Electrostatic energy kcal/mol or kJ/mol <code>\"VDW\"</code> <code>\"vdw\"</code>, <code>\"Vdw\"</code>, <code>\"Van der Waals Energy\"</code> van der Waals energy kcal/mol or kJ/mol <code>\"TEMP\"</code> <code>\"temp\"</code>, <code>\"Temp\"</code>, <code>\"Temperature\"</code> Temperature K <code>\"PRESSURE\"</code> <code>\"pressure\"</code>, <code>\"Pressure\"</code>, <code>\"press\"</code>, <code>\"Press\"</code> Pressure bar <code>\"VOLUME\"</code> <code>\"volume\"</code>, <code>\"Volume\"</code>, <code>\"vol\"</code>, <code>\"Vol\"</code> System volume \u0172 <code>\"BOND\"</code> <code>\"bond\"</code>, <code>\"Bond\"</code>, <code>\"Bond Energy\"</code> Bond energy kcal/mol or kJ/mol <code>\"ANGLE\"</code> <code>\"angle\"</code>, <code>\"Angle\"</code>, <code>\"Angle Energy\"</code> Angle energy kcal/mol or kJ/mol <code>\"DIHEDRAL\"</code> <code>\"dihedral\"</code>, <code>\"Dihedral\"</code>, <code>\"Dihedral Energy\"</code> Dihedral energy kcal/mol or kJ/mol <code>\"IMPROPER\"</code> <code>\"improper\"</code>, <code>\"Improper\"</code>, <code>\"Improper Energy\"</code> Improper energy kcal/mol or kJ/mol"},{"location":"api/analysis/#example-1-basic-energy-analysis","title":"Example 1: Basic Energy Analysis","text":"<p>Simplest energy analysis using <code>plot_energy()</code> - 4-panel plot with default settings.</p> <pre><code>from pathlib import Path\nfrom gatewizard.utils.namd_analysis import EnergyAnalyzer\n\n# Get the directory where this script is located\nscript_dir = Path(__file__).parent\ndata_dir = script_dir / \"equilibration_folder\"\n\n# Multiple log files from equilibration_folder\nlog_files = [\n    data_dir / \"step1_equilibration.log\",\n    data_dir / \"step2_equilibration.log\",\n    data_dir / \"step3_equilibration.log\"\n]\n\n# Initialize analyzer with custom time for each file (in nanoseconds)\nanalyzer = EnergyAnalyzer(\n    [str(f) for f in log_files],\n    file_times={\n        \"step1_equilibration.log\": 0.1,  # 100 ps\n        \"step2_equilibration.log\": 0.1,  # 100 ps\n        \"step3_equilibration.log\": 0.1   # 100 ps\n    }\n)\n\n# Generate comprehensive 4-panel energy plot\nanalyzer.plot_energy(target_temperature=300,    # 300 K\n                     target_pressure=1.01325,   # 1.01325 atm (1 bar)\n                     time_units=\"ps\",\n                     save=\"energy_analysis_example_01.png\")\n\nprint(f\"Energy analysis complete!\")\nprint(f\"Plot saved: energy_analysis_example_01.png\")\n</code></pre> <p>Output figure:</p> <p></p> <p>Figure: Default energy plot using the specified NAMD .log files.</p> <p>Multi-File Color Assignment:</p> <p>When plotting multiple files on the same plot, colors are automatically assigned:</p> <ul> <li>If <code>line_colors</code> is a single color: all files use that color</li> <li>If <code>line_colors</code> is a list: each file gets corresponding color</li> <li>If <code>line_colors=None</code>: auto-assigned from matplotlib color cycle</li> </ul> <p>Time Scaling with <code>file_times</code>:</p> <p>The <code>file_times</code> parameter in the constructor allows mapping data points to correct time ranges: <pre><code># Example: 3 files with different simulation times\n# File 1: 0-50 ns (5000 frames)\n# File 2: 50-125 ns (7500 frames)  \n# File 3: 125-200 ns (7500 frames)\n\nanalyzer = EnergyAnalyzer(\n    log_file=[\"file1.log\", \"file2.log\", \"file3.log\"],\n    file_times=[(0, 50), (50, 125), (125, 200)],\n    # or\n    #file_times={\n    #    \"file1.log\": 0.05,  # 50 ps = 0.05 ns\n    #    \"file2.log\": 0.05,\n    #    \"file3.log\": 0.05\n    #}\n)\n\n# Now time axis will correctly show 0-200 ns with proper frame distribution\nanalyzer.plot_properties(properties=\"TEMP\", time_units=\"ns\")\n</code></pre></p>"},{"location":"api/analysis/#method-get_available_properties","title":"Method: <code>get_available_properties()</code>","text":"<p>Get list of all plottable properties available in the loaded log file(s).</p> <pre><code>get_available_properties() -&gt; List[str]\n</code></pre> <p>Returns: List of property names that can be passed to <code>plot_properties()</code></p>"},{"location":"api/analysis/#example-2-get-available-properties","title":"Example 2: Get available properties","text":"<pre><code>from pathlib import Path\nfrom gatewizard.utils.namd_analysis import EnergyAnalyzer\n\n# Get the directory where this script is located\nscript_dir = Path(__file__).parent\n\n# Path to log file in equilibration_folder\nlog_file = script_dir / \"equilibration_folder\" / \"step1_equilibration.log\"\n\n# Initialize energy analyzer\nanalyzer = EnergyAnalyzer(log_file)\nprops = analyzer.get_available_properties()\nprint(f\"Can plot: {', '.join(props)}\")\n# Output: Can plot: Total Energy, Potential Energy, Kinetic Energy, \n# Electrostatic Energy, Van der Waals Energy, Bond Energy, \n# Angle Energy, Dihedral Energy, Improper Energy, Pressure, Volume\n</code></pre>"},{"location":"api/analysis/#example-3-individual-energy-plots","title":"Example 3: Individual energy plots","text":"<pre><code>from pathlib import Path\nfrom gatewizard.utils.namd_analysis import EnergyAnalyzer\n\n# Get the directory where this script is located\nscript_dir = Path(__file__).parent\ndata_dir = script_dir / \"equilibration_folder\"\n\n# Multiple log files from equilibration_folder\nlog_files = [\n    data_dir / \"step1_equilibration.log\",\n    data_dir / \"step2_equilibration.log\",\n    data_dir / \"step3_equilibration.log\",\n    data_dir / \"step4_equilibration.log\",\n    data_dir / \"step5_equilibration.log\",\n    data_dir / \"step6_equilibration.log\",\n    data_dir / \"step7_production.log\"\n]\n\n# Initialize analyzer with custom time for each file (in nanoseconds)\nanalyzer = EnergyAnalyzer(\n    [str(f) for f in log_files],\n    file_times={\n        \"step1_equilibration.log\": 0.1,  # 100 ps\n        \"step2_equilibration.log\": 0.1,  # 100 ps\n        \"step3_equilibration.log\": 0.1,  # 100 ps\n        \"step4_equilibration.log\": 0.1,  # 100 ps\n        \"step5_equilibration.log\": 0.1,  # 100 ps\n        \"step6_equilibration.log\": 0.1,  # 100 ps\n        \"step7_production.log\": 0.1,     # 100 ps\n    }\n)\n\n# Plot specific energy properties\nanalyzer.plot_properties(\n    properties=[\"bond energy\", \"angle energy\", \"dihedral energy\"],\n    energy_units=\"kcal/mol\",\n    time_units=\"ps\",\n    bg_color = \"#ffffff\",\n    fig_bg_color = \"#FFFFFF\",\n    save=\"energy_analysis_example_03.png\",\n    dpi=300,\n)\n\nprint(f\"Energy properties plot complete!\")\nprint(f\"Plot saved: energy_analysis_example_03.png\")\n</code></pre> <p>Example Output:</p> <p></p> <p>Figure: Multiple energy properties plot.</p>"},{"location":"api/analysis/#method-get_statistics","title":"Method: <code>get_statistics()</code>","text":"<p>Get statistical summary of all energy components.</p> <pre><code>get_statistics() -&gt; Dict[str, Dict[str, float]]\n</code></pre> <p>Returns: Dictionary with statistics for each energy term</p> <p>Statistics Provided:</p> <ul> <li><code>mean</code> - Average value</li> <li><code>std</code> - Standard deviation</li> <li><code>min</code> - Minimum value</li> <li><code>max</code> - Maximum value</li> <li><code>initial</code> - First value</li> <li><code>final</code> - Last value</li> </ul> <p>Available Energy Terms:</p> <ul> <li><code>timestep</code>, <code>total</code>, <code>kinetic</code>, <code>potential</code></li> <li><code>elect</code>, <code>vdw</code>, <code>boundary</code>, <code>misc</code></li> <li><code>temp</code>, <code>pressure</code>, <code>volume</code></li> </ul>"},{"location":"api/analysis/#example-4-individual-energy-plots","title":"Example 4: Individual energy plots","text":"<pre><code>from pathlib import Path\nfrom gatewizard.utils.namd_analysis import EnergyAnalyzer\n\n# Get the directory where this script is located\nscript_dir = Path(__file__).parent\n\n# Path to log file in equilibration_folder\nlog_file = script_dir / \"equilibration_folder\" / \"step2_equilibration.log\"\n\n# Initialize energy analyzer\nanalyzer = EnergyAnalyzer(log_file)\n\nstats = analyzer.get_statistics()\n\n# Temperature\ntemp = stats['temp']\nprint(f\"Temperature: {temp['mean']:.1f} \u00b1 {temp['std']:.1f} K\")\nprint(f\"  Range: {temp['min']:.1f} - {temp['max']:.1f} K\")\n\n# Energy\nenergy = stats['bond']\nprint(f\"Bond Energy: {energy['mean']:.0f} kcal/mol\")\nprint(f\"  Final: {energy['final']:.0f} kcal/mol\")\nprint(f\"  Convergence: {abs(energy['final'] - energy['mean']):.0f} kcal/mol\")\n\n# Output: \n# Temperature: 303.6 \u00b1 2.1 K\n#   Range: 299.4 - 306.3 K\n# Bond Energy: 2080 kcal/mol\n#   Final: 2097 kcal/mol\n#   Convergence: 17 kcal/mol\n</code></pre>"},{"location":"api/analysis/#class-trajectoryanalyzer","title":"Class: TrajectoryAnalyzer","text":"<p>Easy-to-use wrapper for MD trajectory analysis with built-in plotting and full customization.</p>"},{"location":"api/analysis/#constructor_1","title":"Constructor","text":"<pre><code>TrajectoryAnalyzer(\n    topology: Path,\n    trajectory: Path | List[Path],\n    file_times: Optional[Dict[str, float]] = None\n)\n</code></pre> <p>Initialize trajectory analyzer with topology and trajectory file(s).</p> <p>Parameters:</p> <ul> <li><code>topology</code> (Path or str): Path to topology file (PSF, PDB, IMPCRD, etc.)</li> <li><code>trajectory</code> (Path, str, or List): Path(s) to trajectory file(s) (DCD, XTC, TRR, etc.)</li> <li>Single file: <code>\"trajectory.dcd\"</code></li> <li>Multiple files: <code>[\"eq1.dcd\", \"eq2.dcd\", \"prod.dcd\"]</code></li> <li><code>file_times</code> (Dict[str, float], optional): Mapping of trajectory filenames to their simulation durations in nanoseconds</li> </ul> <p>Example: <code>{\"eq1.dcd\": 0.05, \"eq2.dcd\": 0.05, \"prod.dcd\": 0.05}</code></p> <ul> <li>Important: Use just the filename (not full path) as the key</li> <li>Time is the duration of that file, not cumulative</li> <li>Note: In the GUI, you can input times for each file directly in the file list</li> </ul> <p>Examples:</p> <p>Single Trajectory: <pre><code>analyzer = TrajectoryAnalyzer(\"system.pdb\", \"trajectory.dcd\")\n</code></pre></p> <p>Multiple Trajectories with Time Scaling: <pre><code>analyzer = TrajectoryAnalyzer(\n    \"system.pdb\",\n    [\"step1_equilibration.dcd\", \"step2_equilibration.dcd\", \"step7_production.dcd\"],\n    file_times={\n        \"step1_equilibration.dcd\": 0.05,  # 50 ps\n        \"step2_equilibration.dcd\": 0.05,  # 50 ps\n        \"step7_production.dcd\": 0.05      # 50 ps\n    }\n)\n# Time axis will be continuous: [0...0.05] [0.05...0.10] [0.10...0.15] ns\n</code></pre></p>"},{"location":"api/analysis/#method-calculate_rmsd","title":"Method: <code>calculate_rmsd()</code>","text":"<p>Calculate RMSD for selected atoms.</p> <pre><code>calculate_rmsd(\n    selection: str = \"protein and backbone\",\n    reference_frame: int = 0,\n    align: bool = True\n) -&gt; Dict[str, np.ndarray]\n</code></pre> <p>Parameters:</p> <ul> <li><code>selection</code> (str): MDTraj selection string</li> <li><code>reference_frame</code> (int): Frame to use as reference (0 = first frame)</li> <li><code>align</code> (bool): If True, perform structural alignment (rotation + translation) before RMSD.                  If False, calculate raw coordinate RMSD without alignment.</li> </ul> <p>Returns: Dictionary with:</p> <ul> <li><code>'time'</code>: Time array in nanoseconds</li> <li><code>'rmsd'</code>: RMSD values in Angstroms</li> </ul> <p>Example: <pre><code>data = analyzer.calculate_rmsd(\"protein and backbone\", align=True)\nprint(f\"Time range: {data['time'][0]:.3f} - {data['time'][-1]:.3f} ns\")\nprint(f\"RMSD range: {data['rmsd'].min():.2f} - {data['rmsd'].max():.2f} \u00c5\")\n</code></pre></p>"},{"location":"api/analysis/#method-plot_rmsd","title":"Method: <code>plot_rmsd()</code>","text":"<p>Plot RMSD with full customization options including line styling, threshold highlighting, and convergence line control.</p> <pre><code>plot_rmsd(\n    selection: str = \"protein and backbone\",\n    reference_frame: int = 0,\n    align: bool = True,\n    distance_units: str = \"\u00c5\",\n    time_units: str = \"ns\",\n    line_color: str = \"blue\",\n    line_width: float = 1.2,\n    line_style: str = \"-\",\n    bg_color: str = \"#2b2b2b\",\n    fig_bg_color: str = \"#212121\",\n    text_color: str = \"Auto\",\n    show_grid: bool = True,\n    xlim: Optional[tuple] = None,\n    ylim: Optional[tuple] = None,\n    title: Optional[str] = None,\n    xlabel: Optional[str] = None,\n    ylabel: Optional[str] = None,\n    highlight_threshold: Optional[float] = None,\n    highlight_color: str = \"orange\",\n    highlight_alpha: float = 0.2,\n    show_convergence: bool = True,\n    convergence_color: str = \"red\",\n    convergence_style: str = \"--\",\n    convergence_width: float = 1.5,\n    hlines: Optional[List[float]] = None,\n    hline_colors: Optional[List[str]] = None,\n    hline_styles: Optional[List[str]] = None,\n    hline_widths: Optional[List[float]] = None,\n    vlines: Optional[List[float]] = None,\n    vline_colors: Optional[List[str]] = None,\n    vline_styles: Optional[List[str]] = None,\n    vline_widths: Optional[List[float]] = None,\n    save: Optional[str] = None,\n    show: bool = False,\n    figsize: tuple = (10, 6),\n    dpi: int = 300\n)\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>selection</code> str <code>\"protein and backbone\"</code> MDTraj selection string <code>reference_frame</code> int <code>0</code> Reference frame index <code>align</code> bool <code>True</code> Perform structural alignment before RMSD <code>distance_units</code> str <code>\"\u00c5\"</code> Distance units: <code>\"\u00c5\"</code> or <code>\"nm\"</code> <code>time_units</code> str <code>\"ns\"</code> Time units: <code>\"ps\"</code>, <code>\"ns\"</code>, or <code>\"\u00b5s\"</code> <code>line_color</code> str <code>\"blue\"</code> Plot line color (matplotlib color or hex) <code>line_width</code> float <code>1.2</code> Line thickness/width <code>line_style</code> str <code>\"-\"</code> Line style: <code>\"-\"</code> (solid), <code>\"--\"</code> (dashed), <code>\"-.\"</code> (dash-dot), <code>\":\"</code> (dotted) <code>bg_color</code> str <code>\"#2b2b2b\"</code> Plot area background (hex or <code>\"none\"</code>) <code>fig_bg_color</code> str <code>\"#212121\"</code> Figure border background (hex or <code>\"none\"</code>) <code>text_color</code> str <code>\"Auto\"</code> Text/axes color (<code>\"Auto\"</code>, color, or hex) <code>show_grid</code> bool <code>True</code> Show grid lines <code>xlim</code> tuple or None <code>None</code> X-axis limits (min, max) <code>ylim</code> tuple or None <code>None</code> Y-axis limits (min, max) <code>title</code> str or None <code>None</code> Custom title (auto-generated if None) <code>xlabel</code> str or None <code>None</code> Custom X-label (auto with units if None) <code>ylabel</code> str or None <code>None</code> Custom Y-label (auto with units if None) <code>highlight_threshold</code> float or None <code>None</code> Highlight regions above this RMSD value <code>highlight_color</code> str <code>\"orange\"</code> Color for highlight region and line <code>highlight_alpha</code> float <code>0.2</code> Alpha transparency for highlight fill <code>show_convergence</code> bool <code>True</code> Show convergence line (mean of last 20% of trajectory) <code>convergence_color</code> str <code>\"red\"</code> Color for convergence line <code>convergence_style</code> str <code>\"--\"</code> Line style for convergence line <code>convergence_width</code> float <code>1.5</code> Width of convergence line <code>hlines</code> list or None <code>None</code> List of Y values for horizontal reference lines <code>hline_colors</code> list or None <code>None</code> List of colors for horizontal lines <code>hline_styles</code> list or None <code>None</code> List of line styles for horizontal lines (default: <code>\"--\"</code>) <code>hline_widths</code> list or None <code>None</code> List of line widths for horizontal lines (default: <code>1.0</code>) <code>vlines</code> list or None <code>None</code> List of X values for vertical reference lines <code>vline_colors</code> list or None <code>None</code> List of colors for vertical lines <code>vline_styles</code> list or None <code>None</code> List of line styles for vertical lines (default: <code>\"--\"</code>) <code>vline_widths</code> list or None <code>None</code> List of line widths for vertical lines (default: <code>1.0</code>) <code>save</code> str or None <code>None</code> Filename to save plot <code>show</code> bool <code>False</code> Display plot interactively <code>figsize</code> tuple <code>(10, 6)</code> Figure size (width, height) <code>dpi</code> int <code>300</code> Resolution for saved figure"},{"location":"api/analysis/#example-5-rmsd-plot","title":"Example 5: RMSD Plot","text":"<pre><code>from pathlib import Path\nfrom gatewizard.utils.namd_analysis import TrajectoryAnalyzer\n\n# Get the directory where this script is located\nscript_dir = Path(__file__).parent\ndata_dir = script_dir / \"equilibration_folder\"\n\n# Path to topology in equilibration_folder\ntopology_file = data_dir / \"system.pdb\"\n\n# Multiple trajectory files from equilibration_folder\ntrajectory_files = [\n    data_dir / \"step1_equilibration.dcd\",\n    data_dir / \"step2_equilibration.dcd\",\n    data_dir / \"step3_equilibration.dcd\"\n]\n\n# Initialize analyzer with custom time for each file (in nanoseconds)\nanalyzer = TrajectoryAnalyzer(\n    topology_file,\n    trajectory_files,\n    file_times={\n        \"step1_equilibration.dcd\": 0.1,  # 100 ps\n        \"step2_equilibration.dcd\": 0.1,  # 100 ps\n        \"step3_equilibration.dcd\": 0.1   # 100 ps\n    }\n)\n\n# Plot RMSD across all trajectories\nanalyzer.plot_rmsd(\n    selection=\"protein and backbone\",\n    time_units=\"ns\",\n    bg_color=\"white\",\n    fig_bg_color=\"white\",\n    text_color=\"black\",\n    show_grid=False,\n    line_color=\"#1f77b4\",\n    line_width=2,\n    #title=\" \",\n    save=\"trajectory_analysis_example_05.png\",\n    dpi=300,\n    # other settings...\n)\n\n\nprint(f\"Multi-file trajectory analysis complete!\")\nprint(f\"Plot saved: trajectory_analysis_example_05.png\")\nprint(f\"Total simulation time: 300 ps\")\n</code></pre>"},{"location":"api/analysis/#method-calculate_rmsf","title":"Method: <code>calculate_rmsf()</code>","text":"<p>Calculate RMSF (Root Mean Square Fluctuation) for selected atoms.</p> <pre><code>calculate_rmsf(\n    selection: str = \"protein and name CA\"\n) -&gt; Dict[str, np.ndarray]\n</code></pre> <p>Parameters:</p> <ul> <li><code>selection</code> (str): MDTraj selection string</li> </ul> <p>Returns: Dictionary with:</p> <ul> <li><code>'resids'</code>: Residue numbers</li> <li><code>'rmsf'</code>: RMSF values in Angstroms</li> <li><code>'resnames'</code>: Residue names (e.g., ALA, GLY, VAL)</li> <li><code>'atom_indices'</code>: Atom indices</li> </ul>"},{"location":"api/analysis/#example-6-rmsf-calculation","title":"Example 6: RMSF Calculation","text":"<pre><code>from pathlib import Path\nfrom gatewizard.utils.namd_analysis import TrajectoryAnalyzer\n\n# Get the directory where this script is located\nscript_dir = Path(__file__).parent\ndata_dir = script_dir / \"equilibration_folder\"\n\n# Path to topology in equilibration_folder\ntopology_file = data_dir / \"system.pdb\"\n\n# Multiple trajectory files from equilibration_folder\ntrajectory_files = [\n    data_dir / \"step1_equilibration.dcd\",\n    data_dir / \"step2_equilibration.dcd\",\n    data_dir / \"step3_equilibration.dcd\"\n]\n\n# Initialize analyzer with custom time for each file (in nanoseconds)\nanalyzer = TrajectoryAnalyzer(\n    topology_file,\n    trajectory_files,\n    file_times={\n        \"step1_equilibration.dcd\": 0.1,  # 100 ps\n        \"step2_equilibration.dcd\": 0.1,  # 100 ps\n        \"step3_equilibration.dcd\": 0.1   # 100 ps\n    }\n)\n\n# Calculate RMSF for alpha carbon atoms\ndata = analyzer.calculate_rmsf(\"protein and name CA\")\nprint(f\"Residues analyzed: {len(data['resids'])}\")\nprint(f\"RMSF range: {data['rmsf'].min():.2f} - {data['rmsf'].max():.2f} \u00c5\")\nprint(f\"Mean RMSF: {data['rmsf'].mean():.2f} \u00c5\")\n\n# Output:\n# Residues analyzed: 26\n# RMSF range: 0.09 - 0.15 \u00c5\n# Mean RMSF: 0.12 \u00c5\n</code></pre>"},{"location":"api/analysis/#method-plot_rmsf","title":"Method: <code>plot_rmsf()</code>","text":"<p>Plot RMSF with full customization including line styling, residue labeling, and flexibility highlighting.</p> <pre><code>plot_rmsf(\n    selection: str = \"protein and name CA\",\n    xaxis_type: str = \"residue_number\",\n    show_residue_labels: bool = True,\n    residue_name_format: str = \"single\",\n    label_frequency: str = \"auto\",\n    distance_units: str = \"\u00c5\",\n    line_color: str = \"blue\",\n    line_width: float = 1.2,\n    line_style: str = \"-\",\n    bg_color: str = \"#2b2b2b\",\n    fig_bg_color: str = \"#212121\",\n    text_color: str = \"Auto\",\n    show_grid: bool = True,\n    xlim: Optional[tuple] = None,\n    ylim: Optional[tuple] = None,\n    title: Optional[str] = None,\n    xlabel: Optional[str] = None,\n    ylabel: Optional[str] = None,\n    highlight_threshold: Optional[float] = None,\n    highlight_color: str = \"orange\",\n    highlight_alpha: float = 0.2,\n    hlines: Optional[List[float]] = None,\n    hline_colors: Optional[List[str]] = None,\n    hline_styles: Optional[List[str]] = None,\n    hline_widths: Optional[List[float]] = None,\n    vlines: Optional[List[float]] = None,\n    vline_colors: Optional[List[str]] = None,\n    vline_styles: Optional[List[str]] = None,\n    vline_widths: Optional[List[float]] = None,\n    save: Optional[str] = None,\n    show: bool = False,\n    figsize: tuple = (12, 6),\n    dpi: int = 300\n)\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>selection</code> str <code>\"protein and name CA\"</code> MDTraj selection string <code>xaxis_type</code> str <code>\"residue_number\"</code> X-axis type: <code>\"residue_number\"</code>, <code>\"residue_type_number\"</code>, <code>\"atom_index\"</code> <code>show_residue_labels</code> bool <code>True</code> Show residue labels on X-axis <code>residue_name_format</code> str <code>\"single\"</code> Residue format: <code>\"single\"</code> (A, G, V) or <code>\"triple\"</code> (ALA, GLY, VAL) <code>label_frequency</code> str <code>\"auto\"</code> Label frequency: <code>\"all\"</code>, <code>\"auto\"</code>, <code>\"every_2\"</code>, <code>\"every_5\"</code>, <code>\"every_10\"</code>, <code>\"every_20\"</code> <code>distance_units</code> str <code>\"\u00c5\"</code> Distance units: <code>\"\u00c5\"</code> or <code>\"nm\"</code> <code>line_color</code> str <code>\"blue\"</code> Plot line color (matplotlib color or hex) <code>line_width</code> float <code>1.2</code> Line thickness/width <code>line_style</code> str <code>\"-\"</code> Line style: <code>\"-\"</code> (solid), <code>\"--\"</code> (dashed), <code>\"-.\"</code> (dash-dot), <code>\":\"</code> (dotted) <code>highlight_threshold</code> float or None <code>None</code> If set, highlight residues above this RMSF value <code>highlight_color</code> str <code>\"orange\"</code> Color for highlight region and threshold line <code>highlight_alpha</code> float <code>0.2</code> Alpha transparency for highlight fill region <code>hlines</code> list or None <code>None</code> List of Y values for horizontal reference lines <code>hline_colors</code> list or None <code>None</code> List of colors for horizontal lines (cycles if fewer than lines) <code>hline_styles</code> list or None <code>None</code> List of line styles for horizontal lines (default: <code>\"--\"</code>) <code>hline_widths</code> list or None <code>None</code> List of line widths for horizontal lines (default: 1.0) <code>vlines</code> list or None <code>None</code> List of X values (residue numbers) for vertical reference lines <code>vline_colors</code> list or None <code>None</code> List of colors for vertical lines (cycles if fewer than lines) <code>vline_styles</code> list or None <code>None</code> List of line styles for vertical lines (default: <code>\"--\"</code>) <code>vline_widths</code> list or None <code>None</code> List of line widths for vertical lines (default: 1.0) ...other params Same as <code>plot_rmsd()</code> for colors, grid, limits, etc. <p>X-Axis Types:</p> <ul> <li><code>\"residue_number\"</code> - Simple numbers: 1, 2, 3, ...</li> <li><code>\"residue_type_number\"</code> - Type + number: ALA1, GLY2, VAL3, ...</li> <li><code>\"atom_index\"</code> - Atom indices: 0, 15, 30, ...</li> </ul> <p>Label Frequencies:</p> <ul> <li><code>\"all\"</code> - Every residue labeled</li> <li><code>\"auto\"</code> - Smart frequency based on count (&lt;20: all, &lt;50: every_2, &lt;100: every_5, &lt;200: every_10, else: every_20)</li> <li><code>\"every_2\"</code>, <code>\"every_5\"</code>, <code>\"every_10\"</code>, <code>\"every_20\"</code> - Specific intervals</li> </ul>"},{"location":"api/analysis/#example-7-rmsf-plotting","title":"Example 7: RMSF Plotting","text":"<pre><code>from pathlib import Path\nfrom gatewizard.utils.namd_analysis import TrajectoryAnalyzer\n\n# Get the directory where this script is located\nscript_dir = Path(__file__).parent\ndata_dir = script_dir / \"equilibration_folder\"\n\n# Path to topology in equilibration_folder\ntopology_file = data_dir / \"system.pdb\"\n\n# Multiple trajectory files from equilibration_folder\ntrajectory_files = [\n    data_dir / \"step1_equilibration.dcd\",\n    data_dir / \"step2_equilibration.dcd\",\n    data_dir / \"step3_equilibration.dcd\",\n    data_dir / \"step4_equilibration.dcd\",\n    data_dir / \"step5_equilibration.dcd\",  \n    data_dir / \"step6_equilibration.dcd\",\n    data_dir / \"step7_production.dcd\",\n]\n\n# Initialize analyzer with custom time for each file (in nanoseconds)\nanalyzer = TrajectoryAnalyzer(\n    topology_file,\n    trajectory_files,\n    file_times={\n        \"step1_equilibration.dcd\": 0.1,  # 100 ps\n        \"step2_equilibration.dcd\": 0.1,  # 100 ps\n        \"step3_equilibration.dcd\": 0.1,   # 100 ps\n        \"step4_equilibration.dcd\": 0.1,  # 100 ps\n        \"step5_equilibration.dcd\": 0.1,  # 100 ps\n        \"step6_equilibration.dcd\": 0.1,  # 100 ps\n        \"step7_production.dcd\": 0.1      # 100 ps\n    }\n)\n\n# Plot RMSF across all trajectories\nanalyzer.plot_rmsf(\n    selection=\"protein and name C\",\n    xaxis_type= \"residue_type_number\",\n    residue_name_format=\"triple\",\n    label_frequency=\"all\",\n    highlight_threshold=0.6,\n    highlight_color=\"red\",\n    bg_color=\"white\",\n    fig_bg_color=\"white\",\n    text_color=\"black\",\n    show_grid=False,\n    line_color=\"#1f77b4\",\n    line_width=2,\n    #title=\" \",\n    save=\"trajectory_analysis_example_07.png\",\n    dpi=300,\n    # other settings...\n)\n</code></pre> <p>Output figure:</p> <p></p> <p>Figure: RMSF plot for multiple with threshold highlight.</p>"},{"location":"api/analysis/#method-calculate_distances","title":"Method: <code>calculate_distances()</code>","text":"<p>Calculate distances between atom selections over time.</p> <pre><code>calculate_distances(\n    selections: Dict[str, tuple]\n) -&gt; Dict[str, Dict[str, np.ndarray]]\n</code></pre> <p>Parameters:</p> <ul> <li><code>selections</code> (dict): Dictionary of <code>{name: (selection1, selection2)}</code></li> </ul> <p>Returns: Dictionary with distance data for each named selection:</p> <ul> <li><code>'time'</code>: Time array in nanoseconds</li> <li><code>'distance'</code>: Distance array in Angstroms</li> </ul> <p>Example: <pre><code>results = analyzer.calculate_distances({\n    \"gate\": (\"resid 1-3 and name CA\", \"resid 18-20 and name CA\"),\n    \"binding_site\": (\"resid 100-110\", \"resname LIG\")\n})\n\nfor name, data in results.items():\n    print(f\"{name}:\")\n    print(f\"  Time: {data['time'][0]:.3f} - {data['time'][-1]:.3f} ns\")\n    print(f\"  Distance: {data['distance'].mean():.2f} \u00b1 {data['distance'].std():.2f} \u00c5\")\n</code></pre></p>"},{"location":"api/analysis/#method-plot_distances","title":"Method: <code>plot_distances()</code>","text":"<p>Plot distances with full customization including line styling.</p> <pre><code>plot_distances(\n    selections: Dict[str, tuple],\n    distance_units: str = \"\u00c5\",\n    time_units: str = \"ns\",\n    line_colors: Optional[List[str]] = None,\n    line_width: float = 1.2,\n    line_style: str = \"-\",\n    bg_color: str = \"#2b2b2b\",\n    fig_bg_color: str = \"#212121\",\n    text_color: str = \"Auto\",\n    show_grid: bool = True,\n    xlim: Optional[tuple] = None,\n    ylim: Optional[tuple] = None,\n    title: Optional[str] = None,\n    xlabel: Optional[str] = None,\n    ylabel: Optional[str] = None,\n    show_mean_lines: bool = True,\n    hlines: Optional[List[float]] = None,\n    hline_colors: Optional[List[str]] = None,\n    hline_styles: Optional[List[str]] = None,\n    hline_widths: Optional[List[float]] = None,\n    vlines: Optional[List[float]] = None,\n    vline_colors: Optional[List[str]] = None,\n    vline_styles: Optional[List[str]] = None,\n    vline_widths: Optional[List[float]] = None,\n    save: Optional[str] = None,\n    show: bool = False,\n    figsize: tuple = (10, 6),\n    dpi: int = 300\n)\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>selections</code> dict - Dictionary of <code>{name: (sel1, sel2)}</code> <code>distance_units</code> str <code>\"\u00c5\"</code> Distance units: <code>\"\u00c5\"</code> or <code>\"nm\"</code> <code>time_units</code> str <code>\"ns\"</code> Time units: <code>\"ps\"</code>, <code>\"ns\"</code>, or <code>\"\u00b5s\"</code> <code>line_colors</code> list or None <code>None</code> List of colors for each distance pair <code>line_width</code> float <code>1.2</code> Line thickness/width <code>line_style</code> str <code>\"-\"</code> Line style: <code>\"-\"</code> (solid), <code>\"--\"</code> (dashed), <code>\"-.\"</code> (dash-dot), <code>\":\"</code> (dotted) <code>show_mean_lines</code> bool <code>True</code> Show dashed mean distance lines <code>hlines</code> list or None <code>None</code> List of Y values for horizontal reference lines <code>hline_colors</code> list or None <code>None</code> List of colors for horizontal lines (cycles if fewer than lines) <code>hline_styles</code> list or None <code>None</code> List of line styles for horizontal lines (default: <code>\"--\"</code>) <code>hline_widths</code> list or None <code>None</code> List of line widths for horizontal lines (default: 1.0) <code>vlines</code> list or None <code>None</code> List of X values (time points) for vertical reference lines <code>vline_colors</code> list or None <code>None</code> List of colors for vertical lines (cycles if fewer than lines) <code>vline_styles</code> list or None <code>None</code> List of line styles for vertical lines (default: <code>\"--\"</code>) <code>vline_widths</code> list or None <code>None</code> List of line widths for vertical lines (default: 1.0) ...other params Same as <code>plot_rmsd()</code>"},{"location":"api/analysis/#example-8-distances","title":"Example 8: Distances","text":"<pre><code>from pathlib import Path\nfrom gatewizard.utils.namd_analysis import TrajectoryAnalyzer\n\n# Get the directory where this script is located\nscript_dir = Path(__file__).parent\ndata_dir = script_dir / \"equilibration_folder\"\n\n# Path to topology in equilibration_folder\ntopology_file = data_dir / \"system.pdb\"\n\n# Multiple trajectory files from equilibration_folder\ntrajectory_files = [\n    data_dir / \"step1_equilibration.dcd\",\n    data_dir / \"step2_equilibration.dcd\",\n    data_dir / \"step3_equilibration.dcd\",\n    data_dir / \"step4_equilibration.dcd\",\n    data_dir / \"step5_equilibration.dcd\",  \n    data_dir / \"step6_equilibration.dcd\",\n    data_dir / \"step7_production.dcd\",\n]\n\n# Initialize analyzer with custom time for each file (in nanoseconds)\nanalyzer = TrajectoryAnalyzer(\n    topology_file,\n    trajectory_files,\n    file_times={\n        \"step1_equilibration.dcd\": 0.1,  # 100 ps\n        \"step2_equilibration.dcd\": 0.1,  # 100 ps\n        \"step3_equilibration.dcd\": 0.1,   # 100 ps\n        \"step4_equilibration.dcd\": 0.1,  # 100 ps\n        \"step5_equilibration.dcd\": 0.1,  # 100 ps\n        \"step6_equilibration.dcd\": 0.1,  # 100 ps\n        \"step7_production.dcd\": 0.1      # 100 ps\n    }\n)\n# Calculate and plot distances between selections\nanalyzer.plot_distances(\n    selections={\n        \"gate_distance\": (\"resid 1 and name C\", \"resid 28 and name C\"),\n        \"domain_distance\": (\"resid 1-2 and name C\", \"resid 9-10 and name C\")\n    },\n    bg_color=\"white\",\n    fig_bg_color=\"white\",\n    text_color=\"black\",\n    line_width=3,\n    save=\"trajectory_analysis_example_08_distances.png\"\n)\n\nprint(f\"Distances plot saved: trajectory_analysis_example_08_distances.png\")\n</code></pre> <p>Output figure:</p> <p></p> <p>Figure: Distances plot for multiple defined regions on the protein.</p>"},{"location":"api/analysis/#method-calculate_radius_of_gyration","title":"Method: <code>calculate_radius_of_gyration()</code>","text":"<p>Calculate radius of gyration over trajectory.</p> <pre><code>calculate_radius_of_gyration(\n    selection: str = \"protein\"\n) -&gt; Dict[str, np.ndarray]\n</code></pre> <p>Parameters:</p> <ul> <li><code>selection</code> (str): MDTraj selection string</li> </ul> <p>Returns: Dictionary with:</p> <ul> <li><code>'time'</code>: Time array in nanoseconds</li> <li><code>'rg'</code>: Radius of gyration in Angstroms</li> </ul> <p>Example: <pre><code>data = analyzer.calculate_radius_of_gyration(\"protein\")\nprint(f\"Rg range: {data['rg'].min():.2f} - {data['rg'].max():.2f} \u00c5\")\nprint(f\"Mean Rg: {data['rg'].mean():.2f} \u00c5\")\n</code></pre></p>"},{"location":"api/analysis/#method-plot_radius_of_gyration","title":"Method: <code>plot_radius_of_gyration()</code>","text":"<p>Plot radius of gyration with full customization including line styling and convergence control.</p> <pre><code>plot_radius_of_gyration(\n    selection: str = \"protein\",\n    distance_units: str = \"\u00c5\",\n    time_units: str = \"ns\",\n    line_color: str = \"purple\",\n    line_width: float = 1.2,\n    line_style: str = \"-\",\n    bg_color: str = \"#2b2b2b\",\n    fig_bg_color: str = \"#212121\",\n    text_color: str = \"Auto\",\n    show_grid: bool = True,\n    xlim: Optional[tuple] = None,\n    ylim: Optional[tuple] = None,\n    title: Optional[str] = None,\n    xlabel: Optional[str] = None,\n    ylabel: Optional[str] = None,\n    show_convergence: bool = True,\n    convergence_color: str = \"red\",\n    convergence_style: str = \"--\",\n    convergence_width: float = 1.5,\n    hlines: Optional[List[float]] = None,\n    hline_colors: Optional[List[str]] = None,\n    hline_styles: Optional[List[str]] = None,\n    hline_widths: Optional[List[float]] = None,\n    vlines: Optional[List[float]] = None,\n    vline_colors: Optional[List[str]] = None,\n    vline_styles: Optional[List[str]] = None,\n    vline_widths: Optional[List[float]] = None,\n    save: Optional[str] = None,\n    show: bool = False,\n    figsize: tuple = (10, 6),\n    dpi: int = 300\n)\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>selection</code> str <code>\"protein\"</code> MDTraj selection string <code>distance_units</code> str <code>\"\u00c5\"</code> Distance units: <code>\"\u00c5\"</code> or <code>\"nm\"</code> <code>time_units</code> str <code>\"ns\"</code> Time units: <code>\"ps\"</code>, <code>\"ns\"</code>, or <code>\"\u00b5s\"</code> <code>line_color</code> str <code>\"purple\"</code> Plot line color (matplotlib color or hex) <code>line_width</code> float <code>1.2</code> Line thickness/width <code>line_style</code> str <code>\"-\"</code> Line style: <code>\"-\"</code> (solid), <code>\"--\"</code> (dashed), <code>\"-.\"</code> (dash-dot), <code>\":\"</code> (dotted) <code>show_convergence</code> bool <code>True</code> Show convergence line (mean of last 20% of trajectory) <code>convergence_color</code> str <code>\"red\"</code> Color for convergence line <code>convergence_style</code> str <code>\"--\"</code> Line style for convergence line <code>convergence_width</code> float <code>1.5</code> Width of convergence line <code>hlines</code> list or None <code>None</code> List of Y values for horizontal reference lines <code>hline_colors</code> list or None <code>None</code> List of colors for horizontal lines (cycles if fewer than lines) <code>hline_styles</code> list or None <code>None</code> List of line styles for horizontal lines (default: <code>\"--\"</code>) <code>hline_widths</code> list or None <code>None</code> List of line widths for horizontal lines (default: 1.0) <code>vlines</code> list or None <code>None</code> List of X values (time points) for vertical reference lines <code>vline_colors</code> list or None <code>None</code> List of colors for vertical lines (cycles if fewer than lines) <code>vline_styles</code> list or None <code>None</code> List of line styles for vertical lines (default: <code>\"--\"</code>) <code>vline_widths</code> list or None <code>None</code> List of line widths for vertical lines (default: 1.0) ...other params Same as <code>plot_rmsd()</code> for colors, grid, limits, etc."},{"location":"api/analysis/#example-9-radius-of-gyration","title":"Example 9: Radius of gyration","text":"<pre><code>from pathlib import Path\nfrom gatewizard.utils.namd_analysis import TrajectoryAnalyzer\n\n# Get the directory where this script is located\nscript_dir = Path(__file__).parent\ndata_dir = script_dir / \"equilibration_folder\"\n\n# Path to topology in equilibration_folder\ntopology_file = data_dir / \"system.pdb\"\n\n# Multiple trajectory files from equilibration_folder\ntrajectory_files = [\n    data_dir / \"step1_equilibration.dcd\",\n    data_dir / \"step2_equilibration.dcd\",\n    data_dir / \"step3_equilibration.dcd\",\n    data_dir / \"step4_equilibration.dcd\",\n    data_dir / \"step5_equilibration.dcd\",  \n    data_dir / \"step6_equilibration.dcd\",\n    data_dir / \"step7_production.dcd\",\n]\n\n# Initialize analyzer with custom time for each file (in nanoseconds)\nanalyzer = TrajectoryAnalyzer(\n    topology_file,\n    trajectory_files,\n    file_times={\n        \"step1_equilibration.dcd\": 0.1,  # 100 ps\n        \"step2_equilibration.dcd\": 0.1,  # 100 ps\n        \"step3_equilibration.dcd\": 0.1,   # 100 ps\n        \"step4_equilibration.dcd\": 0.1,  # 100 ps\n        \"step5_equilibration.dcd\": 0.1,  # 100 ps\n        \"step6_equilibration.dcd\": 0.1,  # 100 ps\n        \"step7_production.dcd\": 0.1      # 100 ps\n    }\n)\n# Calculate and plot radius of gyration of a selection\nanalyzer.plot_radius_of_gyration(\n    selection=\"protein\",\n    bg_color=\"white\",\n    fig_bg_color=\"white\",\n    text_color=\"black\",\n    line_width=3,\n    save=\"trajectory_analysis_example_09_rdgyr.png\",\n    dpi=300,\n)\n</code></pre>"},{"location":"api/analysis/#method-plot_comprehensive","title":"Method: <code>plot_comprehensive()</code>","text":"<p>Create a 4-panel analysis plot with RMSD, RMSF, Rg, and statistics.</p> <pre><code>plot_comprehensive(\n    save: Optional[str] = None,\n    show: bool = False,\n    figsize: tuple = (14, 10),\n    dpi: int = 300\n)\n</code></pre> <p>Parameters:</p> <ul> <li><code>save</code> (str, optional): Filename to save plot</li> <li><code>show</code> (bool): Display plot interactively</li> <li><code>figsize</code> (tuple): Figure size</li> <li><code>dpi</code> (int): Resolution</li> </ul> <p>Example: <pre><code>analyzer.plot_comprehensive(save=\"comprehensive_analysis.png\")\n</code></pre></p>"},{"location":"api/analysis/#tips-best-practices","title":"Tips &amp; Best Practices","text":""},{"location":"api/analysis/#1-always-provide-file_times-for-multiple-files","title":"1. Always Provide file_times for Multiple Files","text":"<pre><code># \u2705 GOOD: Proper time scaling\nfile_times = {\n    \"step1_equilibration.dcd\": 0.05,  # 50 ps\n    \"step2_equilibration.dcd\": 0.05,\n    \"step3_equilibration.dcd\": 0.05\n}\n\n# \u274c BAD: Frame-based time (incorrect)\nfile_times = None  # Will use frame indices\n</code></pre>"},{"location":"api/analysis/#2-match-units-to-your-analysis","title":"2. Match Units to Your Analysis","text":"<pre><code># Short simulations (&lt; 1 ns)\ntime_units=\"ps\", distance_units=\"\u00c5\"\n\n# Medium simulations (1-100 ns)\ntime_units=\"ns\", distance_units=\"\u00c5\"\n\n# Long simulations (&gt; 100 ns)\ntime_units=\"ns\", distance_units=\"nm\"\n</code></pre>"},{"location":"api/analysis/#3-rmsf-labeling-for-different-protein-sizes","title":"3. RMSF Labeling for Different Protein Sizes","text":"<pre><code># Small protein (&lt; 100 residues)\nlabel_frequency=\"every_2\"\n\n# Medium protein (100-300 residues)\nlabel_frequency=\"every_5\"\n\n# Large protein (&gt; 300 residues)\nlabel_frequency=\"every_10\" or \"every_20\"\n</code></pre>"},{"location":"api/analysis/#4-color-schemes","title":"4. Color Schemes","text":"<pre><code># Dark theme (presentations)\nbg_color=\"#2b2b2b\", text_color=\"Auto\"\n\n# Light theme (publications)\nbg_color=\"#ffffff\", text_color=\"black\"\n\n# Transparent (overlays)\nbg_color=\"none\", fig_bg_color=\"none\"\n</code></pre>"},{"location":"api/analysis/#function-get_equilibration_progress","title":"Function: get_equilibration_progress()","text":"<p>Get progress information from NAMD equilibration logs.</p> <pre><code>get_equilibration_progress(\n    log_directory: Path,\n    output_file: Optional[Path] = None\n) -&gt; Dict[str, NAMDProgress]\n</code></pre> <p>Parameters:</p> <ul> <li><code>log_directory</code> (Path): Directory containing NAMD log files</li> <li><code>output_file</code> (Path, optional): Save progress summary to JSON</li> </ul> <p>Returns: Dictionary of progress information for each stage</p> <p>Example: <pre><code>from gatewizard.utils.namd_analysis import get_equilibration_progress\n\nprogress = get_equilibration_progress(\"equilibration/\")\nfor stage, info in progress.items():\n    print(f\"{stage}: {info.progress_percent:.1f}% complete\")\n</code></pre></p>"},{"location":"api/analysis/#line-styling-and-customization","title":"Line Styling and Customization","text":"<p>All trajectory analysis plotting methods (<code>plot_rmsd()</code>, <code>plot_rmsf()</code>, <code>plot_distances()</code>, <code>plot_radius_of_gyration()</code>) support line styling options for full control over plot appearance.</p>"},{"location":"api/analysis/#common-line-parameters","title":"Common Line Parameters","text":"<p>Available in all plotting methods:</p> Parameter Type Default Description <code>line_color</code> str varies Color name (e.g., <code>\"blue\"</code>) or hex code (e.g., <code>\"#1f77b4\"</code>) <code>line_width</code> float <code>1.2</code> Line thickness (e.g., <code>0.8</code>, <code>1.5</code>, <code>2.5</code>) <code>line_style</code> str <code>\"-\"</code> Line style (see options below)"},{"location":"api/analysis/#line-style-options","title":"Line Style Options","text":"Style Value Visual Use Case Solid <code>\"-\"</code> \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Default, standard plots Dashed <code>\"--\"</code> \u2500\u2500 \u2500\u2500 \u2500\u2500 Highlighting, predictions Dash-dot <code>\"-.\"</code> \u2500\u2500 \u00b7 \u2500\u2500 \u00b7 Alternative highlighting Dotted <code>\":\"</code> \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 Subtle lines, backgrounds"},{"location":"api/analysis/#rmsd-radius-of-gyration-specific","title":"RMSD &amp; Radius of Gyration Specific","text":"<p>Additional convergence line control for <code>plot_rmsd()</code> and <code>plot_radius_of_gyration()</code>:</p> Parameter Type Default Description <code>show_convergence</code> bool <code>True</code> Toggle convergence line on/off <code>convergence_color</code> str <code>\"red\"</code> Color for convergence line <code>convergence_style</code> str <code>\"--\"</code> Line style for convergence <code>convergence_width</code> float <code>1.5</code> Width of convergence line"},{"location":"api/analysis/#rmsd-specific","title":"RMSD Specific","text":"<p>Threshold highlighting for <code>plot_rmsd()</code>:</p> Parameter Type Default Description <code>highlight_threshold</code> float or None <code>None</code> Highlight regions above this RMSD value (in \u00c5 or nm)"},{"location":"api/analysis/#rmsf-specific","title":"RMSF Specific","text":"<p>Flexibility highlighting for <code>plot_rmsf()</code>:</p> Parameter Type Default Description <code>highlight_threshold</code> float or None <code>None</code> Highlight residues above this RMSF value (in \u00c5 or nm)"},{"location":"api/analysis/#quick-reference-examples","title":"Quick Reference Examples","text":"<p>Thick Dashed Line: <pre><code>analyzer.plot_rmsd(line_width=2.5, line_style=\"--\")\n</code></pre></p> <p>Thin Dotted Line: <pre><code>analyzer.plot_rmsf(line_width=0.8, line_style=\":\")\n</code></pre></p> <p>Custom Convergence (Green Dash-dot): <pre><code>analyzer.plot_rmsd(\n    convergence_color=\"green\",\n    convergence_style=\"-.\",\n    convergence_width=2.0\n)\n</code></pre></p> <p>No Convergence Line: <pre><code>analyzer.plot_radius_of_gyration(show_convergence=False)\n</code></pre></p> <p>RMSD with Threshold: <pre><code>analyzer.plot_rmsd(highlight_threshold=3.0)  # Highlight &gt; 3.0 \u00c5\n</code></pre></p> <p>RMSF with Flexibility Threshold: <pre><code>analyzer.plot_rmsf(highlight_threshold=2.0)  # Highlight &gt; 2.0 \u00c5\n</code></pre></p>"},{"location":"api/analysis/#mdtraj-selection-syntax","title":"MDTraj Selection Syntax","text":""},{"location":"api/analysis/#common-selections","title":"Common Selections","text":"<pre><code>\"protein\"                          # All protein atoms\n\"protein and backbone\"             # Backbone atoms (N, CA, C, O)\n\"protein and name CA\"              # C-alpha atoms only\n\"resid 50-150\"                     # Residues 50 to 150\n\"resid 50-70 and name CA\"          # C-alpha of residues 50-70\n\"resname LIG\"                      # Ligand with residue name LIG\n\"protein and not name H*\"          # Protein without hydrogens\n\"within 5 of resname LIG\"          # Atoms within 5\u00c5 of ligand\n</code></pre>"},{"location":"api/analysis/#combining-selections","title":"Combining Selections","text":"<pre><code>\"(resid 1-50) or (resid 100-150)\"    # Two regions\n\"protein and (name CA or name N)\"    # Multiple atom names\n\"resid 25 and name NH1 NH2\"          # Multiple atoms in residue\n</code></pre>"},{"location":"api/analysis/#examples","title":"Examples","text":"<p>Complete working examples are available in <code>tests/analysis_examples/</code>. Each example demonstrates specific analysis capabilities and can be run directly.</p>"},{"location":"api/analysis/#example-10-dark-theme-rmsd-analysis-full-customization","title":"Example 10: Dark Theme RMSD Analysis - Full Customization","text":"<p>Complete RMSD customization with dark themes showing all available plot options.</p> <pre><code>from pathlib import Path\nfrom gatewizard.utils.namd_analysis import TrajectoryAnalyzer\n\n# Get the directory where this script is located\nscript_dir = Path(__file__).parent\ndata_dir = script_dir / \"equilibration_folder\"\n\n# ============================================================================\n# Dark Theme RMSD Analysis - Full Customization\n# ============================================================================\n\ntopology_file = data_dir / \"system.pdb\"\n# Multiple trajectory files from equilibration_folder\ntrajectory_files = [\n    data_dir / \"step1_equilibration.dcd\",\n    data_dir / \"step2_equilibration.dcd\",\n    data_dir / \"step3_equilibration.dcd\",\n    data_dir / \"step4_equilibration.dcd\",\n]\n\n# Initialize analyzer with custom time for each file (in nanoseconds)\nanalyzer = TrajectoryAnalyzer(\n    topology_file,\n    trajectory_files,\n    file_times={\n        \"step1_equilibration.dcd\": 0.1,  # 100 ps\n        \"step2_equilibration.dcd\": 0.1,  # 100 ps\n        \"step3_equilibration.dcd\": 0.1,   # 100 ps\n        \"step4_equilibration.dcd\": 0.1,  # 100 ps\n    }\n)\n\n# RMSD plot with full dark theme customization\nanalyzer.plot_rmsd(\n    selection=\"protein and backbone\",\n    reference_frame=0,\n    align=True,\n    distance_units=\"\u00c5\",\n    time_units=\"ps\",\n    line_color=\"#00d9ff\",        # Bright cyan\n    line_width=2.0,\n    line_style=\"-\",\n    bg_color=\"#1a1a2e\",          # Dark blue-black\n    fig_bg_color=\"#16213e\",      # Darker border\n    text_color=\"#eee\",           # Light gray\n    show_grid=True,\n    xlim=None,\n    ylim=None,\n    title=\"Dark Theme RMSD - Full Customization\",\n    xlabel=\"Time (ps)\",\n    ylabel=\"RMSD (\u00c5)\",\n    highlight_threshold=None,\n    highlight_color=\"orange\",\n    highlight_alpha=0.2,\n    show_convergence=True,\n    convergence_color=\"#ff006e\",  # Magenta\n    convergence_style=\"--\",\n    convergence_width=2.0,\n    hlines=None,\n    hline_colors=None,\n    hline_styles=None,\n    hline_widths=None,\n    vlines=None,\n    vline_colors=None,\n    vline_styles=None,\n    vline_widths=None,\n    save=\"dark_theme_rmsd_example_10.png\",\n    show=False,\n    figsize=(12, 7),\n    dpi=300\n)\n\nprint(f\"Dark theme RMSD plot saved: dark_theme_rmsd_example_10.png\")\n\n# ============================================================================\n# Dark Theme RMSD - With Threshold and Reference Lines\n# ============================================================================\n\nanalyzer.plot_rmsd(\n    selection=\"protein and backbone\",\n    align=True,\n    distance_units=\"\u00c5\",\n    time_units=\"ps\",\n    line_color=\"#7fff00\",        # Chartreuse\n    line_width=1.8,\n    line_style=\"-\",\n    bg_color=\"#0d1117\",          # GitHub dark\n    fig_bg_color=\"#010409\",\n    text_color=\"#c9d1d9\",\n    show_grid=True,\n    title=\"Dark Theme RMSD - With Threshold and Reference Lines\",\n    xlabel=\"Time (ps)\",\n    ylabel=\"RMSD (\u00c5)\",\n    highlight_threshold=0.25,     # Highlight regions &gt; 0.25 \u00c5\n    highlight_color=\"#ff6b6b\",   # Red highlight\n    highlight_alpha=0.5,\n    show_convergence=True,\n    convergence_color=\"#ffd700\",  # Gold\n    convergence_style=\"-.\",\n    convergence_width=1.5,\n    hlines=[0.1, 0.2, 0.25],      # Horizontal reference lines\n    hline_colors=[\"#4ecdc4\", \"#95e1d3\", \"#ff6b6b\"],  # Teal to red gradient\n    hline_styles=[\":\", \":\", \":\"],\n    hline_widths=[1.0, 1.0, 1.0],\n    save=\"dark_theme_rmsd_with_lines_example_10.png\",\n    figsize=(12, 7),\n    dpi=300\n)\n\nprint(f\"Dark theme RMSD with lines saved: dark_theme_rmsd_with_lines_example_10.png\")\n\n# ============================================================================\n# Dark Theme RMSD - Minimal Style\n# ============================================================================\n\nanalyzer.plot_rmsd(\n    selection=\"protein and backbone\",\n    align=True,\n    distance_units=\"\u00c5\",\n    time_units=\"ps\",\n    line_color=\"#ffffff\",        # Pure white line\n    line_width=1.5,\n    line_style=\"-\",\n    bg_color=\"#000000\",          # Pure black\n    fig_bg_color=\"#000000\",\n    text_color=\"#ffffff\",\n    show_grid=False,             # No grid for minimal look\n    title=\"\",                    # No title\n    show_convergence=False,      # No convergence line\n    save=\"dark_theme_rmsd_minimal_example_10.png\",\n    figsize=(10, 6),\n    dpi=300\n)\n\nprint(f\"Dark theme RMSD minimal saved: dark_theme_rmsd_minimal_example_10.png\")\n\nprint(f\"\\nAll dark theme RMSD figures created with:\")\nprint(f\"  - Custom dark backgrounds\")\nprint(f\"  - Full customization options\")\nprint(f\"  - High resolution (300 DPI)\")\n</code></pre> <p>Output figures Three dark-themed RMSD plots:</p> <p></p> <p>Figure: Dark theme RMSD plot</p> <p></p> <p>Figure: Dark theme RMSD with lines</p> <p></p> <p>Figure: Dark theme RMSD minimal</p>"},{"location":"api/analysis/#see-also","title":"See Also","text":"<ul> <li>User Guide - Complete usage guide</li> <li>Examples - Working code examples</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"api/builder/","title":"Builder Module","text":"<p>Module for preparing membrane protein systems with automated lipid bilayer construction, solvation, and parametrization. This module includes:</p> <ul> <li>Membrane system building with packmol-memgen</li> <li>Custom lipid composition (asymmetric membranes supported)</li> <li>Force field selection and validation</li> <li>Salt addition and ionic strength control</li> <li>Two-stage Propka workflow support</li> <li>Automated parametrization with pdb4amber and tleap</li> </ul>"},{"location":"api/builder/#import","title":"Import","text":"<pre><code>from gatewizard.core.system_builder import SystemBuilder\nfrom gatewizard.tools.force_fields import ForceFieldManager\n</code></pre>"},{"location":"api/builder/#class-systembuilder","title":"Class: SystemBuilder","text":"<p>Main class for building membrane protein systems with complete control over lipid composition, force fields, and system parameters.</p>"},{"location":"api/builder/#constructor","title":"Constructor","text":"<pre><code>SystemBuilder()\n</code></pre> <p>Parameters: None</p> <p>Returns: <code>SystemBuilder</code> instance</p> <p>Default Configuration:</p> Parameter Default Description <code>water_model</code> <code>\"tip3p\"</code> Water model for solvation <code>protein_ff</code> <code>\"ff19SB\"</code> Protein force field <code>lipid_ff</code> <code>\"lipid21\"</code> Lipid force field <code>preoriented</code> <code>True</code> Protein already oriented for membrane insertion <code>parametrize</code> <code>True</code> Run parametrization with tleap <code>salt_concentration</code> <code>0.15</code> Salt concentration in M (molar) <code>cation</code> <code>\"K+\"</code> Cation type for salt <code>anion</code> <code>\"Cl-\"</code> Anion type for salt <code>dist_wat</code> <code>17.5</code> Water layer thickness in \u00c5 <code>notprotonate</code> <code>False</code> Skip protonation (preserve residue names)"},{"location":"api/builder/#example-1-basic-configuration","title":"Example 1: Basic Configuration","text":"<pre><code>from gatewizard.core.system_builder import SystemBuilder\n\nbuilder = SystemBuilder()\nprint(f\"Default water model: {builder.config['water_model']}\")\nprint(f\"Default protein force field: {builder.config['protein_ff']}\")\n</code></pre>"},{"location":"api/builder/#configuration-methods","title":"Configuration Methods","text":""},{"location":"api/builder/#method-set_configuration","title":"Method: set_configuration()","text":"<p>Update configuration parameters for system building.</p> <pre><code>set_configuration(**kwargs)\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>water_model</code> <code>str</code> <code>\"tip3p\"</code> Water model (tip3p, tip4p, spce, opc) <code>protein_ff</code> <code>str</code> <code>\"ff19SB\"</code> Protein force field (ff14SB, ff19SB) <code>lipid_ff</code> <code>str</code> <code>\"lipid21\"</code> Lipid force field (lipid17, lipid21) <code>preoriented</code> <code>bool</code> <code>True</code> Whether protein is pre-oriented <code>parametrize</code> <code>bool</code> <code>True</code> Run parametrization after packing <code>salt_concentration</code> <code>float</code> <code>0.15</code> Salt concentration in M <code>cation</code> <code>str</code> <code>\"K+\"</code> Cation type (Na+, K+, etc.) <code>anion</code> <code>str</code> <code>\"Cl-\"</code> Anion type (Cl-, Br-, etc.) <code>dist_wat</code> <code>float</code> <code>17.5</code> Water layer thickness in \u00c5 <code>notprotonate</code> <code>bool</code> <code>False</code> Skip protonation during parametrization <code>add_salt</code> <code>bool</code> <code>True</code> Whether to add salt to system <p>Returns: None</p>"},{"location":"api/builder/#example-2-custom-configuration","title":"Example 2: Custom Configuration","text":"<pre><code>from gatewizard.core.system_builder import SystemBuilder\n\nbuilder = SystemBuilder()\n\n# Configure for specific system\nbuilder.set_configuration(\n    water_model=\"tip3p\",\n    protein_ff=\"ff14SB\",\n    lipid_ff=\"lipid21\",\n    salt_concentration=0.15,\n    cation=\"Na+\",\n    anion=\"Cl-\",\n    dist_wat=20.0,  # Larger water layer\n    preoriented=True\n)\n</code></pre>"},{"location":"api/builder/#example-3-available-water-models","title":"Example 3: Available Water Models","text":"<pre><code>from gatewizard.tools.force_fields import ForceFieldManager\n\nff_manager = ForceFieldManager()\n\n# Get available water models\nwater_models = ff_manager.get_water_models()\n\nprint(\"\\nAvailable Water Models:\")\nfor water in water_models:\n    print(f\"  - {water}\")\n\nprint(f\"\\nTotal: {len(water_models)} water models available\")\n</code></pre>"},{"location":"api/builder/#example-4-available-protein-force-fields","title":"Example 4: Available Protein Force Fields","text":"<pre><code>from gatewizard.tools.force_fields import ForceFieldManager\n\nff_manager = ForceFieldManager()\n\n# Get available protein force fields\nprotein_ffs = ff_manager.get_protein_force_fields()\n\nprint(\"\\nAvailable Protein Force Fields:\")\nfor protein_ff in protein_ffs:\n    print(f\"  - {protein_ff}\")\n\nprint(f\"\\nTotal: {len(protein_ffs)} protein force fields available\")\n</code></pre>"},{"location":"api/builder/#example-5-available-lipid-force-fields","title":"Example 5: Available Lipid Force Fields","text":"<pre><code>from gatewizard.tools.force_fields import ForceFieldManager\n\nff_manager = ForceFieldManager()\n\n# Get available lipid force fields\nlipid_ffs = ff_manager.get_lipid_force_fields()\n\nprint(\"\\nAvailable Lipid Force Fields:\")\nfor lipid_ff in lipid_ffs:\n    print(f\"  - {lipid_ff}\")\n\nprint(f\"\\nTotal: {len(lipid_ffs)} lipid force fields available\")\n</code></pre>"},{"location":"api/builder/#validation-methods","title":"Validation Methods","text":"<p>Before preparing systems, you can validate your inputs and check force field compatibility.</p>"},{"location":"api/builder/#method-validate_system_inputs","title":"Method: validate_system_inputs()","text":"<p>Validate all inputs before system preparation.</p> <pre><code>validate_system_inputs(\n    pdb_file: str,\n    upper_lipids: List[str],\n    lower_lipids: List[str],\n    lipid_ratios: str = \"\",\n    **kwargs\n) -&gt; Tuple[bool, str]\n</code></pre> <p>Parameters:</p> Parameter Type Required Description <code>pdb_file</code> <code>str</code> Yes Path to input PDB file <code>upper_lipids</code> <code>List[str]</code> Yes List of lipids for upper leaflet <code>lower_lipids</code> <code>List[str]</code> Yes List of lipids for lower leaflet <code>lipid_ratios</code> <code>str</code> No Lipid ratios string <code>**kwargs</code> <code>Any</code> No Additional parameters to validate <p>Returns: <code>Tuple[bool, str]</code></p> <ul> <li><code>bool</code>: Validation status</li> <li><code>str</code>: Error message (empty if valid)</li> </ul> <p>Validation Checks:</p> <ol> <li>PDB file exists and is readable</li> <li>All lipid types are valid/available</li> <li>Lipid ratios match number of lipids</li> <li>Ratios are positive numbers</li> <li>Force field combinations are compatible</li> <li>Ion types are valid</li> </ol>"},{"location":"api/builder/#example-6-input-validation","title":"Example 6: Input Validation","text":"<pre><code>from gatewizard.core.system_builder import SystemBuilder\n\nbuilder = SystemBuilder()\n\n# Validate inputs before preparation\nvalid, error_msg = builder.validate_system_inputs(\n    pdb_file=\"protein_protonated_prepared.pdb\",\n    upper_lipids=[\"POPC\", \"POPE\"],\n    lower_lipids=[\"POPC\", \"POPE\"],\n    lipid_ratios=\"7:3//7:3\",\n    water_model=\"tip3p\",\n    protein_ff=\"ff14SB\",\n    lipid_ff=\"lipid21\"\n)\n\nif valid:\n    print(\"\u2713 All inputs are valid, proceeding with preparation\")\n    # Now call prepare_system()\nelse:\n    print(f\"\u2717 Validation failed: {error_msg}\")\n    # Fix issues before proceeding\n</code></pre>"},{"location":"api/builder/#example-7-force-field-validation","title":"Example 7: Force Field Validation","text":"<pre><code>from gatewizard.tools.force_fields import ForceFieldManager\n\nff_manager = ForceFieldManager()\nvalid, message = ff_manager.validate_combination(\"tip3p\", \"ff14SB\", \"lipid21\")\n\nif valid:\n    print(\"\u2713 Force field combination is compatible\")\nelse:\n    print(f\"\u2717 Incompatible: {message}\")\n</code></pre>"},{"location":"api/builder/#core-preparation-methods","title":"Core Preparation Methods","text":""},{"location":"api/builder/#method-prepare_system","title":"Method: prepare_system()","text":"<p>Prepare a complete membrane protein system with lipid bilayer, water, and ions.</p> <pre><code>prepare_system(\n    pdb_file: str,\n    working_dir: str,\n    upper_lipids: List[str],\n    lower_lipids: List[str],\n    lipid_ratios: str = \"\",\n    **kwargs\n) -&gt; Tuple[bool, str, Optional[Path]]\n</code></pre> <p>Parameters:</p> Parameter Type Required Description <code>pdb_file</code> <code>str</code> Yes Path to input PDB file (oriented protein) <code>working_dir</code> <code>str</code> Yes Working directory for output files <code>upper_lipids</code> <code>List[str]</code> Yes List of lipid types for upper leaflet <code>lower_lipids</code> <code>List[str]</code> Yes List of lipid types for lower leaflet <code>lipid_ratios</code> <code>str</code> No Lipid molar ratios (format: \"ratio1:ratio2//ratio3:ratio4\") <code>output_folder_name</code> <code>str</code> No Custom output folder name (kwarg) <code>**kwargs</code> <code>Any</code> No Additional configuration parameters (override defaults) <p>Returns: <code>Tuple[bool, str, Optional[Path]]</code></p> <ul> <li><code>bool</code>: Success status</li> <li><code>str</code>: Status message</li> <li><code>Optional[Path]</code>: Job directory path (None if failed)</li> </ul> <p>Lipid Ratios Format:</p> <p>The <code>lipid_ratios</code> string specifies molar ratios for each leaflet:</p> <ul> <li>Format: <code>\"upper_ratio1:upper_ratio2//lower_ratio1:lower_ratio2\"</code></li> <li>Ratios must match the order of lipids in the lipid lists</li> <li>Ratios are normalized automatically (don't need to sum to 1.0)</li> <li>Use <code>//</code> to separate upper and lower leaflet ratios</li> </ul> <p>Available Lipids:</p> Category Lipid Types Phosphatidylcholine (PC) DHPC, DLPC, DMPC, DPPC, DSPC, DOPC, POPC, PLPC, SOPC Phosphatidylethanolamine (PE) DHPE, DLPE, DMPE, DPPE, DSPE, DOPE, POPE, PLPE, SOPE Phosphatidylserine (PS) DHPS, DLPS, DMPS, DPPS, DSPS, DOPS, POPS, PLPS, SOPS Phosphatidylglycerol (PG) DHPG, DLPG, DMPG, DPPG, DSPG, DOPG, POPG, PLPG, SOPG Phosphatidic Acid (PA) DHPA, DLPA, DMPA, DPPA, DSPA, DOPA, POPA, PLPA, SOPA Sphingomyelins PSM, ASM, LSM, MSM, HSM, OSM Cholesterol CHL1 Other CARDIOLIPIN, PIP, PIP2 <p>Output Files:</p> <p>In <code>{output_folder_name}/</code> directory:</p> <ul> <li><code>bilayer_*.pdb</code> - Packed system (protein in membrane)</li> <li><code>bilayer_*_lipid.pdb</code> - Lipid bilayer with CRYST1 info (for equilibration)</li> <li><code>system.prmtop</code> - AMBER topology file (if parametrize=True)</li> <li><code>system.inpcrd</code> - AMBER coordinate file (if parametrize=True)</li> <li><code>system_solv.pdb</code> - Solvated system in PDB format</li> <li><code>system_4amber.pdb</code> - PDB prepared by pdb4amber</li> <li><code>tleap.in</code> - tleap input script</li> <li><code>logs/preparation.log</code> - Main execution log</li> <li><code>logs/parametrization.log</code> - Parametrization log</li> <li><code>status.json</code> - Job status tracking</li> <li><code>run_preparation.sh</code> - Execution script</li> </ul> <p>Raises:</p> <ul> <li><code>FileNotFoundError</code> - If input PDB file doesn't exist</li> <li><code>SystemBuilderError</code> - If validation fails or system preparation fails</li> </ul> <p>Note: System preparation runs in the background. The method returns immediately after launching the job. Monitor progress using the log files or the JobMonitor class (see monitoring example below).</p>"},{"location":"api/builder/#example-8-simple-symmetric-membrane","title":"Example 8: Simple Symmetric Membrane","text":"<pre><code>from gatewizard.core.system_builder import SystemBuilder\n\nbuilder = SystemBuilder()\n\n# Configure system\nbuilder.set_configuration(\n    water_model=\"tip3p\",\n    protein_ff=\"ff14SB\",\n    lipid_ff=\"lipid21\",\n    salt_concentration=0.15,\n    cation=\"K+\",\n    anion=\"Cl-\"\n)\n\n# Prepare system with 100% POPC (symmetric)\nsuccess, message, job_dir = builder.prepare_system(\n    pdb_file=\"protein_protonated_prepared.pdb\",\n    working_dir=\"./systems\",\n    upper_lipids=[\"POPC\"],\n    lower_lipids=[\"POPC\"],\n    lipid_ratios=\"1//1\",  # 100% POPC both leaflets\n    output_folder_name=\"popc_membrane\"\n)\n\nif success:\n    print(f\"\u2713 System preparation started in background\")\n    print(f\"  {message}\")\n    print(f\"  Job directory: {job_dir}\")\n    print(f\"  Monitor progress: {job_dir / 'preparation.log'}\")\n    print(f\"  When complete, files will be at:\")\n    print(f\"    - Topology: {job_dir / 'system.prmtop'}\")\n    print(f\"    - Coordinates: {job_dir / 'system.inpcrd'}\")\nelse:\n    print(f\"\u2717 Preparation failed: {message}\")\n</code></pre>"},{"location":"api/builder/#example-9-monitoring-job-progress","title":"Example 9: Monitoring Job Progress","text":"<pre><code>from gatewizard.core.job_monitor import JobMonitor\nfrom pathlib import Path\nimport time\n\n# Create monitor for your working directory\nmonitor = JobMonitor(working_directory=Path(\"./systems\"))\n\n# Scan for jobs\nmonitor.scan_for_jobs(force=True)\n\n# Get active jobs\nactive_jobs = monitor.get_active_jobs()\n\nif active_jobs:\n    print(f\"\u2713 Found {len(active_jobs)} active job(s)\")\n\n    for job_id, job_info in active_jobs.items():\n        print(f\"\\nJob: {job_info.job_dir.name}\")\n        print(f\"  Status: {job_info.status.value}\")\n        print(f\"  Progress: {job_info.progress:.1f}%\")\n        print(f\"  Current step: {job_info.current_step}\")\n        print(f\"  Elapsed: {job_info.elapsed_time:.1f}s\")\n\n        # Show completed steps\n        if job_info.steps_completed:\n            print(f\"  Completed steps:\")\n            for step in job_info.steps_completed:\n                print(f\"    \u2713 {step}\")\nelse:\n    print(\"No active jobs found\")\n\n# Check for completed jobs\ncompleted_jobs = monitor.get_completed_jobs()\nif completed_jobs:\n    print(f\"\\n\u2713 Found {len(completed_jobs)} completed job(s)\")\n    for job_id, job_info in completed_jobs.items():\n        print(f\"  - {job_info.job_dir.name}: {job_info.status.value}\")\n</code></pre>"},{"location":"api/builder/#example-10-asymmetric-membrane-with-multiple-lipids","title":"Example 10: Asymmetric Membrane with Multiple Lipids","text":"<pre><code>from gatewizard.core.system_builder import SystemBuilder\n\nbuilder = SystemBuilder()\n\n# Configure for asymmetric membrane\nbuilder.set_configuration(\n    water_model=\"tip3p\",\n    protein_ff=\"ff14SB\",\n    lipid_ff=\"lipid21\",\n    # Note: When using anionic lipids (POPS, POPG, etc.), the system may require\n    # a higher salt concentration for neutralization. If you get an error like:\n    # \"The concentration of ions required to neutralize the system is higher than\n    # the concentration specified\", increase salt_concentration or use add_salt=False.\n    # POPS is anionic (-1 charge), so 50% POPS in lower leaflet adds significant\n    # negative charge requiring more cations for neutralization.\n    salt_concentration=0.5,  # Increased from default 0.15 M due to anionic lipids\n    dist_wat=20.0  # Thicker water layer\n)\n\n# Upper leaflet: 70% POPC + 30% cholesterol\n# Lower leaflet: 50% POPE + 50% POPS (anionic)\nsuccess, message, job_dir = builder.prepare_system(\n    pdb_file=\"protein_protonated_prepared.pdb\",\n    working_dir=\"./systems\",\n    upper_lipids=[\"POPC\", \"CHL1\"],\n    lower_lipids=[\"POPE\", \"POPS\"],\n    lipid_ratios=\"7:3//5:5\",  # Ratios normalized automatically\n    output_folder_name=\"asymmetric_membrane\"\n)\n\nif success:\n    print(f\"\u2713 System preparation started in background\")\n    print(f\"  {message}\")\n    print(f\"  Upper leaflet: 70% POPC, 30% CHL1\")\n    print(f\"  Lower leaflet: 50% POPE, 50% POPS\")\n    print(f\"  Job directory: {job_dir}\")\n    print(f\"  Monitor: {job_dir / 'logs/preparation.log'}\")\nelse:\n    print(f\"\u2717 Preparation failed: {message}\")\n</code></pre>"},{"location":"api/builder/#example-11-complex-composition-plasma-membrane-mimic","title":"Example 11: Complex Composition (Plasma Membrane Mimic)","text":"<pre><code>from gatewizard.core.system_builder import SystemBuilder\n\nbuilder = SystemBuilder()\n\n# Plasma membrane-like composition\n# Upper: PC-rich with cholesterol\n# Lower: PE/PS-rich (cytoplasmic side)\nsuccess, message, job_dir = builder.prepare_system(\n    pdb_file=\"protein_protonated_prepared.pdb\",\n    working_dir=\"./systems\",\n    upper_lipids=[\"POPC\", \"POPE\", \"CHL1\"],\n    lower_lipids=[\"POPE\", \"POPS\", \"CHL1\"],\n    lipid_ratios=\"5:2:3//4:4:2\",  # Upper: 50% POPC, 20% POPE, 30% CHL1\n                                   # Lower: 40% POPE, 40% POPS, 20% CHL1\n    output_folder_name=\"plasma_membrane\",\n    salt_concentration=0.5,\n    cation=\"Na+\",  # Use sodium instead of potassium\n    dist_wat=25.0  # Extra water for large protein\n)\n\nif success:\n    print(f\"\u2713 System preparation started in background\")\n    print(f\"  {message}\")\n    print(f\"  Job directory: {job_dir}\")\n    print(f\"  Monitor: {job_dir / 'logs/preparation.log'}\")\nelse:\n    print(f\"\u2717 Preparation failed: {message}\")\n</code></pre>"},{"location":"api/builder/#example-12-packing-only-no-parametrization","title":"Example 12: Packing Only (No Parametrization)","text":"<pre><code>from gatewizard.core.system_builder import SystemBuilder\n\nbuilder = SystemBuilder()\n\n# Only pack the system, don't parametrize\n# Useful for visual inspection before parametrization\nsuccess, message, job_dir = builder.prepare_system(\n    pdb_file=\"protein_protonated_prepared.pdb\",\n    working_dir=\"./systems\",\n    upper_lipids=[\"POPC\"],\n    lower_lipids=[\"POPC\"],\n    lipid_ratios=\"1//1\",\n    output_folder_name=\"packed_only\",\n    parametrize=False  # Skip parametrization\n)\n\nif success:\n    print(f\"\u2713 Packing started in background (no parametrization)\")\n    print(f\"  {message}\")\n    print(f\"  Job directory: {job_dir}\")\n    print(f\"  Monitor: {job_dir / 'logs/preparation.log'}\")\n    print(f\"  When complete, inspect: {job_dir / 'bilayer_*.pdb'}\")\nelse:\n    print(f\"\u2717 Preparation failed: {message}\")\n</code></pre>"},{"location":"api/builder/#example-13-custom-salt-concentration","title":"Example 13: Custom Salt Concentration","text":"<pre><code>from gatewizard.core.system_builder import SystemBuilder\n\nbuilder = SystemBuilder()\n\n# High salt concentration for ionic strength studies\nsuccess, message, job_dir = builder.prepare_system(\n    pdb_file=\"protein_protonated_prepared.pdb\",\n    working_dir=\"./systems\",\n    upper_lipids=[\"POPC\", \"POPS\"],\n    lower_lipids=[\"POPC\", \"POPS\"],\n    lipid_ratios=\"8:2//8:2\",  # 80% POPC, 20% POPS\n    output_folder_name=\"high_salt\",\n    salt_concentration=2.0,  # 2000 mM (high salt)\n    cation=\"Na+\",\n    anion=\"Cl-\"\n)\n\nif success:\n    print(f\"\u2713 System preparation started in background\")\n    print(f\"  {message}\")\n    print(f\"  High salt: 2.0 M NaCl\")\n    print(f\"  Job directory: {job_dir}\")\n    print(f\"  Monitor: {job_dir / 'logs/preparation.log'}\")\nelse:\n    print(f\"\u2717 Preparation failed: {message}\")\n</code></pre>"},{"location":"api/builder/#example-14-no-salt-charge-neutralization-only","title":"Example 14: No Salt (Charge Neutralization Only)","text":"<pre><code>from gatewizard.core.system_builder import SystemBuilder\n\nbuilder = SystemBuilder()\n\n# Neutralize system charges only (no extra salt)\nsuccess, message, job_dir = builder.prepare_system(\n    pdb_file=\"protein_protonated_prepared.pdb\",\n    working_dir=\"./systems\",\n    upper_lipids=[\"POPC\"],\n    lower_lipids=[\"POPC\"],\n    lipid_ratios=\"1//1\",\n    output_folder_name=\"no_salt\",\n    salt_concentration=0.0,  # Only neutralize, no extra salt\n    add_salt=True  # Still add ions for neutralization\n)\n\nif success:\n    print(f\"\u2713 System preparation started in background\")\n    print(f\"  {message}\")\n    print(f\"  Neutralization only, no extra salt\")\n    print(f\"  Job directory: {job_dir}\")\n    print(f\"  Monitor: {job_dir / 'logs/preparation.log'}\")\nelse:\n    print(f\"\u2717 Preparation failed: {message}\")\n</code></pre>"},{"location":"api/builder/#job-monitoring","title":"Job Monitoring","text":"<p>Since system preparation runs in the background, GateWizard provides the <code>JobMonitor</code> class to track progress, check status, and manage running jobs.</p>"},{"location":"api/builder/#class-jobmonitor","title":"Class: JobMonitor","text":"<p>Monitor and track system preparation jobs.</p>"},{"location":"api/builder/#example-15-jobmonitor-class","title":"Example 15: JobMonitor class","text":"<pre><code>from gatewizard.core.job_monitor import JobMonitor\nfrom pathlib import Path\n\nmonitor = JobMonitor(working_directory=Path(\"./systems\"))\n</code></pre> <p>Constructor Parameters:</p> Parameter Type Default Description <code>working_directory</code> <code>Path</code> or <code>str</code> <code>Path.cwd()</code> Directory to monitor for jobs <p>Returns: <code>JobMonitor</code> instance</p>"},{"location":"api/builder/#method-scan_for_jobs","title":"Method: scan_for_jobs()","text":"<p>Scan the working directory for preparation jobs.</p> <pre><code>monitor.scan_for_jobs(force=False)\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>force</code> <code>bool</code> <code>False</code> Force scan even if within scan interval (3 seconds) <p>Returns: None (updates internal job list)</p> <p>Description: Scans the working directory for subdirectories containing <code>status.json</code> files, which indicate active or completed preparation jobs.</p>"},{"location":"api/builder/#method-get_active_jobs","title":"Method: get_active_jobs()","text":"<p>Get all currently running jobs.</p> <pre><code>active_jobs = monitor.get_active_jobs()\n</code></pre> <p>Returns: <code>Dict[str, JobInfo]</code></p> <ul> <li>Dictionary mapping job IDs to <code>JobInfo</code> objects</li> <li>Only includes jobs with status <code>RUNNING</code></li> </ul>"},{"location":"api/builder/#method-get_completed_jobs","title":"Method: get_completed_jobs()","text":"<p>Get all completed or errored jobs.</p> <pre><code>completed_jobs = monitor.get_completed_jobs()\n</code></pre> <p>Returns: <code>Dict[str, JobInfo]</code></p> <ul> <li>Dictionary mapping job IDs to <code>JobInfo</code> objects</li> <li>Includes jobs with status <code>COMPLETED</code> or <code>ERROR</code></li> </ul>"},{"location":"api/builder/#method-get_job","title":"Method: get_job()","text":"<p>Get specific job by ID.</p> <pre><code>job = monitor.get_job(job_id)\n</code></pre> <p>Parameters:</p> Parameter Type Required Description <code>job_id</code> <code>str</code> Yes Job identifier (usually the full job directory path) <p>Returns: <code>Optional[JobInfo]</code></p> <ul> <li><code>JobInfo</code> object if job exists</li> <li><code>None</code> if job not found</li> </ul>"},{"location":"api/builder/#method-refresh_job","title":"Method: refresh_job()","text":"<p>Force refresh of a specific job's status.</p> <pre><code>success = monitor.refresh_job(job_id)\n</code></pre> <p>Parameters:</p> Parameter Type Required Description <code>job_id</code> <code>str</code> Yes Job identifier to refresh <p>Returns: <code>bool</code></p> <ul> <li><code>True</code> if job was refreshed successfully</li> <li><code>False</code> if job not found or refresh failed</li> </ul>"},{"location":"api/builder/#jobinfo-object","title":"JobInfo Object","text":"<p>Each job is represented by a <code>JobInfo</code> object with the following attributes:</p> Attribute Type Description <code>job_id</code> <code>str</code> Unique job identifier <code>job_dir</code> <code>Path</code> Job directory path <code>status</code> <code>JobStatus</code> Current status (RUNNING, COMPLETED, ERROR, UNKNOWN) <code>progress</code> <code>float</code> Progress percentage (0.0 - 100.0) <code>current_step</code> <code>str</code> Name of current processing step <code>steps_completed</code> <code>List[str]</code> List of completed step names <code>elapsed_time</code> <code>float</code> Elapsed time in seconds <code>start_time</code> <code>datetime</code> Job start timestamp <code>end_time</code> <code>Optional[datetime]</code> Job end timestamp (None if running) <p>JobStatus Values:</p> <ul> <li><code>RUNNING</code> - Job is currently executing</li> <li><code>COMPLETED</code> - Job finished successfully</li> <li><code>ERROR</code> - Job encountered an error</li> <li><code>UNKNOWN</code> - Status cannot be determined</li> </ul>"},{"location":"api/builder/#example-16-real-time-progress-tracking","title":"Example 16: Real-time Progress Tracking","text":"<pre><code>from gatewizard.core.job_monitor import JobMonitor\nfrom pathlib import Path\nimport time\n\n# Start a system preparation (runs in background)\nfrom gatewizard.core.system_builder import SystemBuilder\n\nbuilder = SystemBuilder()\nsuccess, message, job_dir = builder.prepare_system(\n    pdb_file=\"protein_protonated_prepared.pdb\",\n    working_dir=\"./systems\",\n    upper_lipids=[\"POPC\"],\n    lower_lipids=[\"POPC\"],\n    lipid_ratios=\"1//1\"\n)\n\nif success:\n    print(f\"\u2713 Job started: {job_dir}\")\n\n    # Monitor progress in real-time\n    monitor = JobMonitor(working_directory=Path(\"./systems\"))\n\n    while True:\n        monitor.scan_for_jobs(force=True)\n        active_jobs = monitor.get_active_jobs()\n\n        if not active_jobs:\n            # Job completed\n            completed = monitor.get_completed_jobs()\n            if completed:\n                for job_id, job_info in completed.items():\n                    if str(job_dir) in job_id:\n                        print(f\"\\n\u2713 Job completed: {job_info.status.value}\")\n                        print(f\"  Total time: {job_info.elapsed_time:.1f}s\")\n                        break\n            break\n\n        # Show progress\n        for job_id, job_info in active_jobs.items():\n            if str(job_dir) in job_id:\n                print(f\"\\rProgress: {job_info.progress:.1f}% - {job_info.current_step}\", end=\"\", flush=True)\n\n        time.sleep(2)  # Check every 2 seconds\n</code></pre>"},{"location":"api/builder/#example-17-monitoring-batch-job-management","title":"Example 17: Monitoring Batch Job Management","text":"<pre><code>from gatewizard.core.job_monitor import JobMonitor\nfrom pathlib import Path\n\n# Monitor all jobs in a directory\nmonitor = JobMonitor(working_directory=Path(\"./systems\"))\nmonitor.scan_for_jobs(force=True)\n\n# Check active jobs\nactive_jobs = monitor.get_active_jobs()\nprint(f\"\\n{'='*60}\")\nprint(f\"ACTIVE JOBS: {len(active_jobs)}\")\nprint(f\"{'='*60}\")\n\nfor job_id, job_info in active_jobs.items():\n    print(f\"\\n\ud83d\udcc1 {job_info.job_dir.name}\")\n    print(f\"   Status: {job_info.status.value}\")\n    print(f\"   Progress: {job_info.progress:.1f}%\")\n    print(f\"   Current: {job_info.current_step}\")\n    print(f\"   Runtime: {job_info.elapsed_time:.0f}s\")\n\n    if job_info.steps_completed:\n        print(f\"   Completed steps:\")\n        for step in job_info.steps_completed:\n            print(f\"     \u2713 {step}\")\n\n# Check completed jobs\ncompleted_jobs = monitor.get_completed_jobs()\nprint(f\"\\n{'='*60}\")\nprint(f\"COMPLETED JOBS: {len(completed_jobs)}\")\nprint(f\"{'='*60}\")\n\nfor job_id, job_info in completed_jobs.items():\n    status_icon = \"\u2713\" if job_info.status.value == \"completed\" else \"\u2717\"\n    print(f\"{status_icon} {job_info.job_dir.name}: {job_info.status.value} ({job_info.elapsed_time:.0f}s)\")\n</code></pre>"},{"location":"api/builder/#monitoring-tips","title":"Monitoring Tips","text":"<p>Real-time monitoring:</p> <ul> <li>Use <code>scan_for_jobs(force=True)</code> to bypass the 3-second scan interval</li> <li>Check status every 1-2 seconds for responsive progress updates</li> <li>Use <code>flush=True</code> in print statements for immediate display</li> </ul> <p>Long-running jobs:</p> <ul> <li>Check status periodically (every 30-60 seconds)</li> <li>Log progress to file for later review</li> <li>Use <code>elapsed_time</code> to estimate remaining time</li> </ul> <p>Multiple jobs:</p> <ul> <li>Monitor entire working directory for batch processing</li> <li>Filter jobs by status for targeted monitoring</li> <li>Use job_dir.name for user-friendly display</li> </ul> <p>Debugging:</p> <ul> <li>Check <code>job_dir / 'logs/preparation.log'</code> for detailed output</li> <li>Check <code>job_dir / 'logs/parametrization.log'</code> if parametrization fails</li> <li>Examine <code>status.json</code> for detailed job state</li> </ul> <p>Manual log inspection: <pre><code># Follow preparation log in real-time\ntail -f systems/popc_membrane/logs/preparation.log\n\n# Check for errors\ngrep -i error systems/popc_membrane/logs/*.log\n\n# View job status\ncat systems/popc_membrane/status.json\n</code></pre></p>"},{"location":"api/builder/#tips-and-best-practices","title":"Tips and Best Practices","text":""},{"location":"api/builder/#lipid-selection","title":"Lipid Selection","text":"<p>For simple systems:</p> <ul> <li>Use 100% POPC for both leaflets (symmetric membrane)</li> <li>Well-characterized, stable, and widely used</li> <li>Good starting point for method development</li> </ul> <p>For realistic membranes:</p> <ul> <li>Include cholesterol (10-30%) for membrane stability</li> <li>Use PE lipids (POPE) for inner leaflet (more physiological)</li> <li>Add PS lipids (POPS) for negative charge (cytoplasmic side)</li> </ul> <p>For specialized studies:</p> <ul> <li>Use asymmetric compositions (different upper/lower)</li> <li>Match experimental lipid compositions when available</li> <li>Consider protein's native membrane environment</li> </ul>"},{"location":"api/builder/#force-field-selection","title":"Force Field Selection","text":"<p>Default recommendation (most stable):</p> <ul> <li>Water: tip3p</li> <li>Protein: ff14SB</li> <li>Lipid: lipid21</li> </ul> <p>For latest parameters:</p> <ul> <li>Water: opc</li> <li>Protein: ff19SB</li> <li>Lipid: lipid21</li> </ul>"},{"location":"api/builder/#salt-concentration","title":"Salt Concentration","text":"<p>Physiological (default):</p> <ul> <li>0.15 M (150 mM) NaCl or KCl</li> <li>Mimics intracellular or extracellular conditions</li> </ul> <p>High salt studies:</p> <ul> <li>0.5-1.0 M for ionic strength effects</li> <li>May require longer equilibration</li> </ul> <p>Charge neutralization only:</p> <ul> <li>Set <code>salt_concentration=0.0</code></li> <li>System will still be neutralized with minimum ions</li> </ul>"},{"location":"api/builder/#water-layer-thickness","title":"Water Layer Thickness","text":"<p>Default (17.5 \u00c5):</p> <ul> <li>Sufficient for most membrane proteins</li> <li>~3-4 water layers above/below membrane</li> </ul> <p>Large proteins or complexes:</p> <ul> <li>Increase to 20-25 \u00c5</li> <li>Ensures adequate solvation</li> </ul> <p>Minimize system size:</p> <ul> <li>Decrease to 15 \u00c5 (minimum recommended)</li> <li>Faster simulations but ensure full solvation</li> </ul>"},{"location":"api/builder/#protein-orientation","title":"Protein Orientation","text":"<p>Pre-oriented proteins:</p> <ul> <li>Use OPM database</li> <li>Protein already positioned in membrane plane</li> <li>Set <code>preoriented=True</code> (default)</li> </ul> <p>Non-oriented proteins:</p> <ul> <li>Let packmol-memgen use MEMEMBED for orientation</li> <li>Set <code>preoriented=False</code></li> <li>Adds extra time to preparation</li> </ul>"},{"location":"api/builder/#troubleshooting","title":"Troubleshooting","text":"<p>\"PDB file not found\":</p> <ul> <li>Check absolute/relative paths</li> <li>Verify file permissions</li> <li>Ensure PDB file is valid format</li> </ul> <p>\"Packing failed\":</p> <ul> <li>Protein may be too large for default settings</li> <li>Try increasing <code>dist_wat</code> parameter</li> <li>Check protein orientation (OPM database)</li> <li>Verify protein is pre-oriented if using <code>preoriented=True</code></li> </ul> <p>\"Parametrization failed\":</p> <ul> <li>Check logs/parametrization.log for details</li> <li>May have non-standard residues</li> <li>Verify protonation states (use Propka workflow)</li> <li>Check for missing atoms or unusual residue names</li> </ul> <p>\"Invalid lipid ratios\":</p> <ul> <li>Ensure ratios match number of lipids</li> <li>Format: \"ratio1:ratio2//ratio3:ratio4\"</li> <li>Ratios don't need to sum to 1.0 (auto-normalized)</li> <li>Example: \"7:3//5:5\" for 2 lipids per leaflet</li> </ul> <p>\"Force field compatibility error\":</p> <ul> <li>Use ForceFieldManager to check combinations</li> <li>Not all force fields are compatible</li> <li>Use recommended combinations for stability</li> </ul>"},{"location":"api/builder/#performance-tips","title":"Performance Tips","text":"<p>Faster preparation:</p> <ul> <li>Use symmetric membranes (same upper/lower)</li> <li>Fewer lipid types (1-2 per leaflet)</li> <li>Pre-oriented proteins</li> <li>Smaller water layers (15-17.5 \u00c5)</li> </ul> <p>More realistic systems:</p> <ul> <li>Asymmetric membranes (different leaflets)</li> <li>Multiple lipid types (3-4 per leaflet)</li> <li>Include cholesterol</li> <li>Larger water layers (20-25 \u00c5)</li> <li>Use Propka workflow for correct protonation</li> </ul>"},{"location":"api/builder/#see-also","title":"See Also","text":"<ul> <li>Preparation Module - Protonation state analysis</li> <li>Equilibration Module - MD equilibration protocols</li> <li>User Guide - Builder Tab - GUI workflow</li> <li>Examples on GitHub - Complete workflow examples</li> </ul>"},{"location":"api/equilibration/","title":"Equilibration Module","text":"<p>Module for setting up NAMD equilibration protocols for membrane protein systems. Generates configuration files, restraint files, and run scripts for multi-stage equilibration simulations using AMBER force fields.</p>"},{"location":"api/equilibration/#import","title":"Import","text":"<pre><code>from gatewizard.tools.equilibration import NAMDEquilibrationManager\n</code></pre>"},{"location":"api/equilibration/#class-namdequilibrationmanager","title":"Class: NAMDEquilibrationManager","text":"<p>Manager for NAMD equilibration simulations with support for multi-stage protocols, flexible restraints, and ensemble control.</p>"},{"location":"api/equilibration/#constructor","title":"Constructor","text":"<pre><code>NAMDEquilibrationManager(working_dir: Path, namd_executable: str = \"namd3\")\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>working_dir</code> <code>Path</code> Required Working directory containing system files <code>namd_executable</code> <code>str</code> <code>\"namd3\"</code> NAMD executable name or path <p>Returns: <code>NAMDEquilibrationManager</code> instance</p>"},{"location":"api/equilibration/#quick-start","title":"Quick Start","text":""},{"location":"api/equilibration/#example-1-automatic-file-detection-simplest","title":"Example 1: Automatic File Detection (Simplest)","text":"<pre><code>from pathlib import Path\nfrom gatewizard.tools.equilibration import NAMDEquilibrationManager\n\n# Point to folder with system files\nsystem_folder = Path(\"popc_membrane\")\n\n# Define equilibration stages\nstages = [\n    {\n        'name': 'Equilibration 1',\n        'time_ns': 0.125,\n        'steps': 125000,\n        'ensemble': 'NVT',\n        'temperature': 310.15,\n        'timestep': 1.0,\n        'minimize_steps': 10000,\n        'constraints': {\n            'protein_backbone': 10.0,\n            'protein_sidechain': 5.0,\n            'lipid_head': 2.5,\n            'lipid_tail': 2.5,\n            'water': 0.0,\n            'ions': 10.0,\n            'other': 0.0\n        }\n    }\n]\n\n# Setup with automatic file detection (no system_files needed!)\n# scheme_type is auto-detected from the 'ensemble' field in stages\nmanager = NAMDEquilibrationManager(system_folder)\nresult = manager.setup_namd_equilibration(\n    stage_params_list=stages,\n    output_name=\"equilibration_example_01\"\n)\n\n# Note that output folder is created inside the system_folder\n\nprint(f\"Setup complete: {result['namd_dir']}\")\n# Run with: cd {result['namd_dir']} &amp;&amp; ./run_equilibration.sh\n</code></pre>"},{"location":"api/equilibration/#example-2-explicit-file-paths-alternative","title":"Example 2: Explicit File Paths (Alternative)","text":"<pre><code>from pathlib import Path\nfrom gatewizard.tools.equilibration import NAMDEquilibrationManager\n\n# Point to folder with system files\nsystem_folder = Path(\"popc_membrane\")\n\n# Explicitly define system files (if auto-detection doesn't work)\nsystem_files = {\n    'prmtop': str(system_folder / 'system.prmtop'),\n    'inpcrd': str(system_folder / 'system.inpcrd'),\n    'pdb': str(system_folder / 'system.pdb'),\n    'bilayer_pdb': str(system_folder / 'bilayer_protein_protonated_prepared_lipid.pdb')\n}\n\n# Define equilibration stages\nstages = [\n    {\n        'name': 'Equilibration 1',\n        'time_ns': 0.125,\n        'steps': 125000,\n        'ensemble': 'NVT',\n        'temperature': 310.15,\n        'timestep': 1.0,\n        'minimize_steps': 10000,\n        'constraints': {\n            'protein_backbone': 10.0,\n            'protein_sidechain': 5.0,\n            'lipid_head': 2.5,\n            'lipid_tail': 2.5,\n            'water': 0.0,\n            'ions': 10.0,\n            'other': 0.0\n        }\n    }\n]\n\n# Setup with explicit file paths\n# scheme_type is auto-detected from the 'ensemble' field in stages\nmanager = NAMDEquilibrationManager(system_folder)\nresult = manager.setup_namd_equilibration(\n    system_files=system_files,\n    stage_params_list=stages,\n    output_name=\"equilibration_example_02\"\n)\n\nprint(f\"Setup complete: {result['namd_dir']}\")\n# Run with: cd {result['namd_dir']} &amp;&amp; ./run_equilibration.sh\n</code></pre>"},{"location":"api/equilibration/#helper-methods","title":"Helper Methods","text":""},{"location":"api/equilibration/#method-find_system_files","title":"Method: find_system_files()","text":"<p>Automatically detect system files in the working directory. Useful for verifying which files will be used before running setup.</p> <pre><code>find_system_files() -&gt; Optional[Dict[str, str]]\n</code></pre> <p>Parameters: None</p> <p>Returns: <code>Optional[Dict[str, str]]</code></p> <ul> <li>Dictionary with detected file paths, or <code>None</code> if required files not found</li> <li>Keys: <code>'prmtop'</code>, <code>'inpcrd'</code>, <code>'pdb'</code>, <code>'bilayer_pdb'</code></li> </ul> <p>Detection Priority:</p> <ol> <li>Topology: <code>*.prmtop</code> files</li> <li>Coordinates: <code>*.inpcrd</code> \u2192 <code>*.crd</code> \u2192 <code>*.rst</code></li> <li>System PDB: <code>system.pdb</code> \u2192 any non-bilayer <code>*.pdb</code></li> <li>Bilayer PDB: <code>bilayer*_lipid.pdb</code> (with CRYST1) \u2192 <code>bilayer_*.pdb</code> \u2192 <code>*_bilayer.pdb</code></li> </ol>"},{"location":"api/equilibration/#example-3","title":"Example 3:","text":"<pre><code>from pathlib import Path\nfrom gatewizard.tools.equilibration import NAMDEquilibrationManager\n\nmanager = NAMDEquilibrationManager(Path(\"popc_membrane\"))\n\n# Check which files will be used\nsystem_files = manager.find_system_files()\nif system_files:\n    print(\"Detected files:\")\n    for key, path in system_files.items():\n        print(f\"  {key}: {Path(path).name}\")\n\n    # Now run setup with auto-detection\n    #result = manager.setup_namd_equilibration(\n    #    stage_params_list=stages\n    #)\nelse:\n    print(\"Required files not found - please check working directory\")\n\n# Output:\n# Detected files:\n#   prmtop: system.prmtop\n#   inpcrd: system.inpcrd\n#   pdb: system.pdb\n#   bilayer_pdb: bilayer_protein_protonated_prepared_lipid.pdb\n</code></pre>"},{"location":"api/equilibration/#core-method","title":"Core Method","text":""},{"location":"api/equilibration/#method-setup_namd_equilibration","title":"Method: setup_namd_equilibration()","text":"<p>Complete equilibration setup with automatic file generation. This method:</p> <ol> <li>Auto-detects system files (if not provided)</li> <li>Creates output directory structure</li> <li>Copies system files (prmtop, inpcrd, pdb) to NAMD directory</li> <li>Generates NAMD configuration files for each stage</li> <li>Creates restraint files based on constraints</li> <li>Generates executable run script</li> <li>Creates protocol summary JSON</li> </ol> <pre><code>setup_namd_equilibration(\n    system_files: Optional[Dict[str, str]] = None,\n    stage_params_list: List[Dict[str, Any]] = None,\n    output_name: str = \"equilibration\",\n    scheme_type: str = \"NPT\",\n    namd_executable: str = \"namd3\"\n) -&gt; Dict[str, Any]\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>system_files</code> <code>Optional[Dict[str, str]]</code> <code>None</code> System file paths (see below). If <code>None</code>, auto-detects files in working_dir <code>stage_params_list</code> <code>List[Dict[str, Any]]</code> Required List of stage parameter dictionaries (see below). Each stage must include <code>ensemble</code> field <code>output_name</code> <code>str</code> <code>\"equilibration\"</code> Base name for output folder <code>scheme_type</code> <code>Optional[str]</code> <code>None</code> (Optional) Equilibration scheme (NVT, NPT, NPAT, NPgT). If <code>None</code>, auto-detected from first stage's <code>ensemble</code> field <code>namd_executable</code> <code>str</code> <code>\"namd3\"</code> NAMD executable name/path <p>Returns: <code>Dict[str, Any]</code> with keys:</p> <ul> <li><code>namd_dir</code> (<code>Path</code>): NAMD output directory path</li> <li><code>config_files</code> (<code>List[Path]</code>): Generated .conf files</li> <li><code>run_script</code> (<code>Path</code>): Executable run script path</li> <li><code>summary_file</code> (<code>Path</code>): Protocol summary JSON path</li> </ul>"},{"location":"api/equilibration/#system-files-dictionary","title":"System Files Dictionary","text":"<p>Auto-Detection (Recommended):</p> <p>If <code>system_files=None</code> (default), the method will automatically search the working directory for:</p> <ul> <li><code>*.prmtop</code> - AMBER topology file</li> <li><code>*.inpcrd</code>, <code>*.crd</code>, or <code>*.rst</code> - AMBER coordinate file</li> <li><code>system.pdb</code> - System PDB file</li> <li><code>bilayer*_lipid.pdb</code> - Bilayer PDB with CRYST1 record (highest priority)</li> </ul> <p>Manual Specification (Alternative):</p> <p>If auto-detection fails or you need specific files, provide a dictionary with these keys:</p> Key Type Description <code>prmtop</code> <code>str</code> Path to AMBER topology file (system.prmtop) <code>inpcrd</code> <code>str</code> Path to AMBER coordinate file (system.inpcrd) <code>pdb</code> <code>str</code> Path to system PDB file (system.pdb) <code>bilayer_pdb</code> <code>str</code> REQUIRED Path to bilayer PDB with CRYST1 record <p>Important: CRYST1 Box Dimensions</p> <p>The <code>bilayer_pdb</code> file must contain a CRYST1 record that defines the periodic box dimensions. This file is typically:</p> <ul> <li>Named <code>bilayer_*_lipid.pdb</code> (from packmol-memgen --parametrize)</li> <li>Generated during system preparation</li> <li>Contains the header: <code>CRYST1   70.335   70.833   85.067  90.00  90.00  90.00 P 1</code></li> </ul> <p>Warning: Without proper CRYST1 information, NAMD will use incorrect box dimensions, leading to simulation failures.</p>"},{"location":"api/equilibration/#stage-parameters-dictionary","title":"Stage Parameters Dictionary","text":"<p>Each stage in <code>stage_params_list</code> must be a dictionary with the following structure:</p> <p>Required Parameters:</p> Parameter Type Description <code>name</code> <code>str</code> Stage name (e.g., \"Equilibration 1\"). Note: Names are optional and used primarily for logging and user feedback. The actual configuration file names are generated sequentially (step1, step2, etc.) regardless of the name you provide <code>time_ns</code> <code>float</code> Simulation time in nanoseconds <code>steps</code> <code>int</code> Number of MD steps <code>ensemble</code> <code>str</code> Ensemble type (NVT, NPT, NPAT, NPgT) <code>temperature</code> <code>float</code> Temperature in Kelvin <code>timestep</code> <code>float</code> Timestep in femtoseconds (1.0 or 2.0) <code>constraints</code> <code>Dict[str, float]</code> Restraint forces (see below) <p>Optional Parameters:</p> Parameter Type Default Description <code>minimize_steps</code> <code>int</code> <code>0</code> Minimization steps before MD (first stage only) <code>pressure</code> <code>float</code> <code>1.0</code> Pressure in bar (NPT, NPAT, NPgT only) <code>surface_tension</code> <code>float</code> <code>0.0</code> Surface tension in dyn/cm (NPAT only) <code>dcd_freq</code> <code>int</code> <code>5000</code> DCD output frequency (steps) <code>use_gpu</code> <code>bool</code> <code>True</code> Enable GPU acceleration <code>cpu_cores</code> <code>int</code> <code>1</code> Number of CPU cores <code>gpu_id</code> <code>int</code> <code>0</code> GPU device ID <code>num_gpus</code> <code>int</code> <code>1</code> Number of GPUs to use <code>custom_template</code> <code>str</code> <code>None</code> Explicitly specify CHARMM-GUI template file (e.g., <code>'step6.3_equilibration.inp'</code>) <p>Constraints Dictionary:</p> <p>Restraint forces in kcal/mol/\u00c5\u00b2. Applied to atomic groups:</p> Key Description Typical Values <code>protein_backbone</code> Protein backbone atoms (CA, C, N, O) 10.0 \u2192 5.0 \u2192 1.0 \u2192 0.0 <code>protein_sidechain</code> Protein sidechain heavy atoms 5.0 \u2192 2.5 \u2192 0.5 \u2192 0.0 <code>lipid_head</code> Lipid head group atoms (P, O) 5.0 \u2192 2.5 \u2192 1.0 \u2192 0.0 <code>lipid_tail</code> Lipid tail carbon atoms 5.0 \u2192 2.5 \u2192 0.5 \u2192 0.0 <code>water</code> Water molecules (usually unrestrained) 0.0 <code>ions</code> Ion atoms (K+, Cl-, etc.) 10.0 \u2192 0.0 <code>other</code> Other molecules/ligands 0.0"},{"location":"api/equilibration/#ensemble-types","title":"Ensemble Types","text":"Ensemble Full Name Control Use Case NVT Canonical Temperature Initial heating, fixed box NPT Isothermal-isobaric Temp + Pressure (isotropic) General equilibration NPAT Constant surface tension Temp + Pressure (anisotropic) + Surface tension Membrane systems (recommended) NPgT Constant surface tension Temp + Pressure + Surface tension Alternative membrane ensemble"},{"location":"api/equilibration/#advanced-features","title":"Advanced Features","text":""},{"location":"api/equilibration/#per-stage-ensemble-selection","title":"Per-Stage Ensemble Selection","text":"<p>Each stage can use a different ensemble by specifying the <code>ensemble</code> field. This allows flexible equilibration protocols:</p> <pre><code>stages = [\n    {'name': 'Equilibration 1', 'ensemble': 'NVT', ...},   # Heat with NVT\n    {'name': 'Equilibration 2', 'ensemble': 'NPT', ...},   # Equilibrate with NPT\n    {'name': 'Equilibration 3', 'ensemble': 'NPAT', ...},  # Relax membrane with NPAT\n]\n</code></pre> <p>How it works:</p> <ul> <li>The <code>scheme_type</code> parameter is auto-detected from the first stage's <code>ensemble</code> field</li> <li>Each stage uses its own <code>ensemble</code> to select the appropriate CHARMM-GUI template</li> <li>When a stage's ensemble differs from the protocol default, a warning is logged</li> <li>Templates are automatically loaded from the correct ensemble folder (01_NVT, 02_NPT, 03_NPAT, 04_NPgT)</li> </ul> <p>Example: Mixed Ensemble Protocol</p> <pre><code>stages = [\n    {\n        'name': 'Initial Heating',\n        'ensemble': 'NVT',      # Uses NVT template\n        'time_ns': 0.25,\n        'temperature': 310.15,\n        'timestep': 1.0,\n        'minimize_steps': 10000,\n        'constraints': {'protein_backbone': 10.0, ...}\n    },\n    {\n        'name': 'Pressure Equilibration',\n        'ensemble': 'NPT',      # Uses NPT template (warning logged)\n        'time_ns': 0.5,\n        'temperature': 310.15,\n        'pressure': 1.0,\n        'timestep': 1.0,\n        'constraints': {'protein_backbone': 5.0, ...}\n    },\n    {\n        'name': 'Membrane Relaxation',\n        'ensemble': 'NPAT',     # Uses NPAT template (warning logged)\n        'time_ns': 1.0,\n        'temperature': 310.15,\n        'pressure': 1.0,\n        'surface_tension': 0.0,\n        'timestep': 2.0,\n        'constraints': {'protein_backbone': 1.0, ...}\n    }\n]\n\n# Setup automatically detects scheme_type='NVT' from first stage\n# Stages 2-3 use different ensembles with appropriate templates\nresult = manager.setup_namd_equilibration(stage_params_list=stages)\n</code></pre> <p>Output: <pre><code>INFO - Auto-detected scheme_type from stages: NVT\nINFO - Generated: step1_equilibration.conf\nWARNING - Stage 2 (Pressure Equilibration) uses ensemble 'NPT' but protocol default is 'NVT'. Using 'NPT' template.\nINFO - Generated: step2_equilibration.conf\nWARNING - Stage 3 (Membrane Relaxation) uses ensemble 'NPAT' but protocol default is 'NVT'. Using 'NPAT' template.\nINFO - Generated: step3_equilibration.conf\n</code></pre></p>"},{"location":"api/equilibration/#custom-template-selection","title":"Custom Template Selection","text":"<p>For advanced control, explicitly specify which CHARMM-GUI template to use with the <code>custom_template</code> parameter:</p> <pre><code>stages = [\n    {\n        'name': 'Strong Restraints',\n        'ensemble': 'NPT',\n        'custom_template': 'step6.1_equilibration.inp',  # Use template from stage 1\n        'time_ns': 0.25,\n        'constraints': {'protein_backbone': 10.0, ...}\n    },\n    {\n        'name': 'Medium Restraints',\n        'ensemble': 'NPT',\n        'custom_template': 'step6.3_equilibration.inp',  # Use template from stage 3\n        'time_ns': 0.5,\n        'constraints': {'protein_backbone': 5.0, ...}\n    },\n    {\n        'name': 'Light Restraints',\n        'ensemble': 'NPAT',\n        'custom_template': 'step6.5_equilibration.inp',  # Use template from stage 5\n        'time_ns': 1.0,\n        'constraints': {'protein_backbone': 1.0, ...}\n    }\n]\n</code></pre> <p>Use cases for custom templates:</p> <ul> <li>Skip intermediate equilibration stages (use step6.5 directly)</li> <li>Repeat a specific stage with different parameters</li> <li>Mix templates from different equilibration phases</li> <li>Test different template configurations</li> </ul> <p>Available templates per ensemble:</p> <ul> <li><code>step6.1_equilibration.inp</code> through <code>step6.6_equilibration.inp</code> (6 equilibration stages)</li> <li><code>step7_production.inp</code> (production stage)</li> </ul>"},{"location":"api/equilibration/#custom-stage-names","title":"Custom Stage Names","text":"<p>Stage names can be anything - they don't need to follow the \"Equilibration N\" convention:</p> <pre><code>stages = [\n    {'name': 'Initial Heating', ...},           # Maps to step1\n    {'name': 'Pressure Equilibration', ...},    # Maps to step2\n    {'name': 'Membrane Relaxation', ...},       # Maps to step3\n    {'name': 'Production Preparation', ...},    # Maps to step4\n]\n</code></pre> <p>How it works:</p> <ul> <li>Custom names are automatically mapped to sequential step numbers (step1, step2, step3, ...)</li> <li>Config files use sequential naming: <code>step1_equilibration.conf</code>, <code>step2_equilibration.conf</code>, etc.</li> <li>Restart files are properly chained: <code>step2</code> loads from <code>step1</code>, <code>step3</code> loads from <code>step2</code>, etc.</li> <li><code>inputname</code> variables are correctly set for all stages</li> </ul>"},{"location":"api/equilibration/#working-examples","title":"Working Examples","text":""},{"location":"api/equilibration/#example-4-three-stage-protocol","title":"Example 4: Three-Stage Protocol","text":"<pre><code>from pathlib import Path\nfrom gatewizard.tools.equilibration import NAMDEquilibrationManager\n\n# Point to system folder\nwork_dir = Path(__file__).parent / \"popc_membrane\"\n\nstages = [\n    {\n        'name': 'Equilibration 1',\n        'time_ns': 0.125,\n        'steps': 125000,\n        'ensemble': 'NVT',\n        'temperature': 303.15,\n        'timestep': 1.0,\n        'minimize_steps': 10000,\n        'constraints': {\n            'protein_backbone': 10.0,\n            'protein_sidechain': 5.0,\n            'lipid_head': 2.5,\n            'lipid_tail': 2.5,\n            'water': 0.0,\n            'ions': 10.0,\n            'other': 0.0\n        }\n    },\n    {\n        'name': 'Equilibration 2',\n        'time_ns': 0.125,\n        'steps': 125000,\n        'ensemble': 'NVT',\n        'temperature': 303.15,\n        'timestep': 1.0,\n        'constraints': {\n            'protein_backbone': 5.0,\n            'protein_sidechain': 2.5,\n            'lipid_head': 2.5,\n            'lipid_tail': 2.5,\n            'water': 0.0,\n            'ions': 0.0,\n            'other': 0.0\n        }\n    },\n    {\n        'name': 'Equilibration 3',\n        'time_ns': 0.125,\n        'steps': 125000,\n        'ensemble': 'NPT',\n        'temperature': 303.15,\n        'pressure': 1.0,\n        'timestep': 1.0,\n        'constraints': {\n            'protein_backbone': 2.5,\n            'protein_sidechain': 1.0,\n            'lipid_head': 1.0,\n            'lipid_tail': 1.0,\n            'water': 0.0,\n            'ions': 0.0,\n            'other': 0.0\n        }\n    }\n]\n\n# Auto-detect files and setup\n# scheme_type auto-detected from stages (NVT from first stage)\n# Stage 3 uses NPT ensemble - warning will be logged\nmanager = NAMDEquilibrationManager(work_dir)\nresult = manager.setup_namd_equilibration(\n    stage_params_list=stages,\n    output_name=\"equilibration_example_04\",\n    namd_executable=\"namd3\"\n)\n\nprint(f\"\\n\u2713 Setup complete!\")\nprint(f\"  Config files: {len(result['config_files'])}\")\nprint(f\"  Run script: {result['run_script'].name}\")\n</code></pre>"},{"location":"api/equilibration/#example-5-custom-four-stage-protocol","title":"Example 5: Custom Four-Stage Protocol","text":"<pre><code>from pathlib import Path\nfrom gatewizard.tools.equilibration import NAMDEquilibrationManager\n\n# Point to system folder\nwork_dir = Path(__file__).parent / \"popc_membrane\"\nsystem_files = {\n    'prmtop': str(work_dir / 'system.prmtop'),\n    'inpcrd': str(work_dir / 'system.inpcrd'),\n    'pdb': str(work_dir / 'system.pdb'),\n    'bilayer_pdb': str(work_dir / 'bilayer_protein_protonated_prepared_lipid.pdb')\n\ncustom_protocol = [\n    {\n        'name': 'Initial Equilibration',\n        'time_ns': 0.25,\n        'steps': 250000,\n        'ensemble': 'NVT',\n        'temperature': 310.15,\n        'timestep': 1.0,\n        'minimize_steps': 10000,\n        'constraints': {\n            'protein_backbone': 10.0,\n            'protein_sidechain': 5.0,\n            'lipid_head': 5.0,\n            'lipid_tail': 5.0,\n            'water': 0.0,\n            'ions': 10.0,\n            'other': 0.0\n        }\n    },\n    {\n        'name': 'Pressure Equilibration',\n        'time_ns': 0.5,\n        'steps': 500000,\n        'ensemble': 'NPT',\n        'temperature': 310.15,\n        'pressure': 1.0,\n        'timestep': 1.0,\n        'constraints': {\n            'protein_backbone': 5.0,\n            'protein_sidechain': 2.5,\n            'lipid_head': 2.5,\n            'lipid_tail': 2.5,\n            'water': 0.0,\n            'ions': 0.0,\n            'other': 0.0\n        }\n    },\n    {\n        'name': 'Membrane Relaxation',\n        'time_ns': 1.0,\n        'steps': 500000,\n        'ensemble': 'NPAT',\n        'temperature': 310.15,\n        'pressure': 1.0,\n        'surface_tension': 0.0,\n        'timestep': 2.0,\n        'constraints': {\n            'protein_backbone': 2.0,\n            'protein_sidechain': 1.0,\n            'lipid_head': 1.0,\n            'lipid_tail': 0.5,\n            'water': 0.0,\n            'ions': 0.0,\n            'other': 0.0\n        }\n    },\n    {\n        'name': 'Production Preparation',\n        'time_ns': 2.0,\n        'steps': 1000000,\n        'ensemble': 'NPAT',\n        'temperature': 310.15,\n        'pressure': 1.0,\n        'surface_tension': 0.0,\n        'timestep': 2.0,\n        'constraints': {\n            'protein_backbone': 0.5,\n            'protein_sidechain': 0.0,\n            'lipid_head': 0.0,\n            'lipid_tail': 0.0,\n            'water': 0.0,\n            'ions': 0.0,\n            'other': 0.0\n        }\n    }\n]\n\n# Auto-detect and setup\n# scheme_type auto-detected from stages (NVT from first stage)\n# Stages 2-4 use different ensembles - warnings will be logged\nmanager = NAMDEquilibrationManager(work_dir)\nresult = manager.setup_namd_equilibration(\n    stage_params_list=custom_protocol,\n    output_name=\"equilibration_example_05\",\n    namd_executable=\"namd3\"\n)\n\nprint(f\"\\n\u2713 Setup complete!\")\nprint(f\"  Total stages: {len(custom_protocol)}\")\nprint(f\"  Total time: {sum(s['time_ns'] for s in custom_protocol):.1f} ns\")\nprint(f\"\\nTo run:\")\nprint(f\"  cd {result['namd_dir']}\")\nprint(f\"  ./run_equilibration.sh\")\n</code></pre>"},{"location":"api/equilibration/#example-6-complete-charmm-gui-7-stage-protocol-in-npt-ensemble","title":"Example 6: Complete CHARMM-GUI 7-Stage Protocol in NPT ensemble","text":"<pre><code>from pathlib import Path\nfrom gatewizard.tools.equilibration import NAMDEquilibrationManager\n\n# System folder\nwork_dir = Path(__file__).parent / \"popc_membrane\"\n\nstages = [\n    {\n        'name': 'Equilibration 1',\n        'time_ns': 0.125,\n        'steps': 125000,\n        'ensemble': 'NPT',\n        'temperature': 303.15,\n        'minimize_steps': 10000,\n        'timestep': 1.0,\n        'constraints': {\n            'protein_backbone': 10.0,\n            'protein_sidechain': 5.0,\n            'lipid_head': 2.5,\n            'lipid_tail': 2.5,\n            'water': 0.0,\n            'ions': 10.0,\n            'other': 0.0\n        }\n    },\n    {\n        'name': 'Equilibration 2',\n        'time_ns': 0.125,\n        'steps': 125000,\n        'ensemble': 'NPT',\n        'temperature': 303.15,\n        'timestep': 1.0,\n        'constraints': {\n            'protein_backbone': 5.0,\n            'protein_sidechain': 2.5,\n            'lipid_head': 2.5,\n            'lipid_tail': 2.5,\n            'water': 0.0,\n            'ions': 0.0,\n            'other': 0.0\n        }\n    },\n    {\n        'name': 'Equilibration 3',\n        'time_ns': 0.125,\n        'steps': 125000,\n        'ensemble': 'NPT',\n        'temperature': 303.15,\n        'pressure': 1.0,\n        'surface_tension': 0.0,\n        'timestep': 1.0,\n        'constraints': {\n            'protein_backbone': 2.5,\n            'protein_sidechain': 1.0,\n            'lipid_head': 1.0,\n            'lipid_tail': 1.0,\n            'water': 0.0,\n            'ions': 0.0,\n            'other': 0.0\n        }\n    },\n    {\n        'name': 'Equilibration 4',\n        'time_ns': 0.5,\n        'steps': 250000,\n        'ensemble': 'NPT',\n        'temperature': 303.15,\n        'pressure': 1.0,\n        'surface_tension': 0.0,\n        'timestep': 2.0,\n        'constraints': {\n            'protein_backbone': 1.0,\n            'protein_sidechain': 0.5,\n            'lipid_head': 0.5,\n            'lipid_tail': 0.5,\n            'water': 0.0,\n            'ions': 0.0,\n            'other': 0.0\n        }\n    },\n    {\n        'name': 'Equilibration 5',\n        'time_ns': 0.5,\n        'steps': 250000,\n        'ensemble': 'NPT',\n        'temperature': 303.15,\n        'pressure': 1.0,\n        'surface_tension': 0.0,\n        'timestep': 2.0,\n        'constraints': {\n            'protein_backbone': 0.5,\n            'protein_sidechain': 0.1,\n            'lipid_head': 0.1,\n            'lipid_tail': 0.1,\n            'water': 0.0,\n            'ions': 0.0,\n            'other': 0.0\n        }\n    },\n    {\n        'name': 'Equilibration 6',\n        'time_ns': 0.5,\n        'steps': 250000,\n        'ensemble': 'NPT',\n        'temperature': 303.15,\n        'pressure': 1.0,\n        'surface_tension': 0.0,\n        'timestep': 2.0,\n        'constraints': {\n            'protein_backbone': 0.1,\n            'protein_sidechain': 0.0,\n            'lipid_head': 0.0,\n            'lipid_tail': 0.0,\n            'water': 0.0,\n            'ions': 0.0,\n            'other': 0.0\n        }\n    },\n    {\n        'name': 'Production',\n        'time_ns': 10.0,\n        'steps': 5000000,\n        'ensemble': 'NPT',\n        'temperature': 303.15,\n        'pressure': 1.0,\n        'surface_tension': 0.0,\n        'timestep': 2.0,\n        'constraints': {\n            'protein_backbone': 0.0,\n            'protein_sidechain': 0.0,\n            'lipid_head': 0.0,\n            'lipid_tail': 0.0,\n            'water': 0.0,\n            'ions': 0.0,\n            'other': 0.0\n        }\n    }\n]\n\n# Auto-detect and setup\n# scheme_type auto-detected from first stage's ensemble\nmanager = NAMDEquilibrationManager(work_dir)\nresult = manager.setup_namd_equilibration(\n    stage_params_list=stages,\n    output_name=\"equilibration_example_06\",\n    namd_executable=\"namd3\"\n)\n\nprint(f\"\\n\u2713 Complete! Generated {len(result['config_files'])} configuration files\")\nprint(f\"  Total equilibration: {sum(s['time_ns'] for s in stages[:-1]):.3f} ns\")\nprint(f\"  Production: {stages[-1]['time_ns']:.1f} ns\")\n</code></pre>"},{"location":"api/equilibration/#example-7-custom-template-selection","title":"Example 7: Custom Template Selection","text":"<p>This example demonstrates explicit template control for advanced workflows:</p> <pre><code>from pathlib import Path\nfrom gatewizard.tools.equilibration import NAMDEquilibrationManager\n\n# System folder\nwork_dir = Path(__file__).parent / \"popc_membrane\"\n\nsystem_files = {\n    'prmtop': str(work_dir / 'system.prmtop'),\n    'inpcrd': str(work_dir / 'system.inpcrd'),\n    'pdb': str(work_dir / 'system.pdb'),\n    'bilayer_pdb': str(work_dir / 'bilayer_protein_protonated_prepared_lipid.pdb')\n}\n\n# Use explicit templates to skip intermediate stages\nstages = [\n    {\n        'name': 'Strong Restraints Phase',\n        'ensemble': 'NPT',\n        'custom_template': 'step6.1_equilibration.inp',  # Use stage 1 template\n        'time_ns': 0.25,\n        'timestep': 1.0,\n        'temperature': 310.15,\n        'pressure': 1.0,\n        'minimize_steps': 10000,\n        'constraints': {\n            'protein_backbone': 10.0,\n            'protein_sidechain': 5.0,\n            'lipid_head': 5.0,\n            'lipid_tail': 5.0,\n            'water': 0.0,\n            'ions': 10.0,\n            'other': 0.0\n        }\n    },\n    {\n        'name': 'Medium Restraints Phase',\n        'ensemble': 'NPT',\n        'custom_template': 'step6.3_equilibration.inp',  # Skip to stage 3 template\n        'time_ns': 0.5,\n        'timestep': 1.0,\n        'temperature': 310.15,\n        'pressure': 1.0,\n        'constraints': {\n            'protein_backbone': 5.0,\n            'protein_sidechain': 2.5,\n            'lipid_head': 2.5,\n            'lipid_tail': 2.5,\n            'water': 0.0,\n            'ions': 0.0,\n            'other': 0.0\n        }\n    },\n    {\n        'name': 'Light Restraints Phase',\n        'ensemble': 'NPAT',\n        'custom_template': 'step6.5_equilibration.inp',  # Use stage 5 template\n        'time_ns': 1.0,\n        'timestep': 2.0,\n        'temperature': 310.15,\n        'pressure': 1.0,\n        'surface_tension': 0.0,\n        'constraints': {\n            'protein_backbone': 1.0,\n            'protein_sidechain': 0.5,\n            'lipid_head': 0.5,\n            'lipid_tail': 0.0,\n            'water': 0.0,\n            'ions': 0.0,\n            'other': 0.0\n        }\n    }\n]\n\n# Setup with custom template selection\nmanager = NAMDEquilibrationManager(work_dir)\nresult = manager.setup_namd_equilibration(\n    system_files=system_files,\n    stage_params_list=stages,\n    output_name=\"equilibration_example_07\",\n    namd_executable=\"namd3\"\n)\n\nprint(f\"\\n\u2713 Setup complete with custom templates!\")\nprint(f\"  Stage 1: Using template step6.1\")\nprint(f\"  Stage 2: Using template step6.3 (skipped step6.2)\")\nprint(f\"  Stage 3: Using template step6.5 (skipped step6.4)\")\n</code></pre> <p>When to use custom templates:</p> <ul> <li>Skip intermediate stages: Jump from step6.1 \u2192 step6.3 \u2192 step6.5</li> <li>Repeat a stage: Use step6.2 multiple times with different parameters</li> <li>Mix templates: Combine templates from different equilibration phases</li> <li>Test protocols: Experiment with different template combinations</li> </ul>"},{"location":"api/equilibration/#best-practices","title":"Best Practices","text":""},{"location":"api/equilibration/#restraint-progression","title":"Restraint Progression","text":"<p>Recommended restraint schedule (kcal/mol/\u00c5\u00b2):</p> Component Stage 1 Stage 2 Stage 3 Stage 4 Production Protein backbone 10.0 5.0 2.5 1.0 0.0 Protein sidechain 5.0 2.5 1.0 0.5 0.0 Lipid heads 5.0 2.5 1.0 0.5 0.0 Lipid tails 5.0 2.5 1.0 0.0 0.0 Ions 10.0 0.0 0.0 0.0 0.0 Water 0.0 0.0 0.0 0.0 0.0 <p>Guidelines:</p> <ul> <li>Start with strong restraints (10.0) on protein backbone and ions</li> <li>Gradually reduce restraints over 3-6 stages</li> <li>Always keep water unrestrained (0.0)</li> <li>Release ions early (after stage 1)</li> <li>Release lipid tails before heads</li> <li>Final stage should have minimal or zero restraints</li> </ul>"},{"location":"api/equilibration/#timestep-progression","title":"Timestep Progression","text":"Stage Timestep Restraints Notes 1-2 1.0 fs Strong (10.0-5.0) Initial equilibration, constrained 3-4 1.0-2.0 fs Medium (2.5-1.0) Transition to larger timestep 5+ 2.0 fs Light (&lt; 1.0) Standard production timestep <p>Rules:</p> <ul> <li>Use 1.0 fs with strong restraints (&gt; 5.0 kcal/mol/\u00c5\u00b2)</li> <li>Switch to 2.0 fs when restraints &lt; 2.5 kcal/mol/\u00c5\u00b2</li> <li>NAMD supports 2.0 fs with SHAKE/SETTLE for bonds to hydrogen</li> <li>Never use &gt; 2.0 fs for equilibration</li> </ul>"},{"location":"api/equilibration/#stage-lengths","title":"Stage Lengths","text":"<p>Minimum recommended times:</p> Ensemble Stage Purpose Min Time Typical Time NVT Initial heating 0.1 ns 0.125-0.25 ns NPT Pressure equilibration 0.1 ns 0.125-0.5 ns NPAT Membrane equilibration 0.5 ns 0.5-2.0 ns Production Data collection 10 ns 50-500 ns <p>Total equilibration time:</p> <ul> <li>Minimum: 1.0 ns (3-4 stages)</li> <li>Standard: 2.0 ns (6 stages, CHARMM-GUI protocol)</li> <li>Thorough: 3-5 ns (custom research protocols)</li> </ul>"},{"location":"api/equilibration/#ensemble-selection","title":"Ensemble Selection","text":"<p>For membrane protein systems:</p> <p>Start with NVT (0.1-0.25 ns)</p> <ul> <li>Heat system from 0 K to target temperature</li> <li>Strong restraints on protein and ions</li> <li>Fixed box dimensions</li> </ul> <p>Switch to NPT (0.1-0.5 ns)</p> <ul> <li>Equilibrate pressure (isotropic)</li> <li>Medium restraints</li> <li>Box can change size uniformly</li> </ul> <p>Finish with NPAT (0.5-2.0 ns)</p> <ul> <li>Equilibrate membrane (anisotropic pressure)</li> <li>Light restraints</li> <li>Lateral box dimensions independent from Z-axis</li> <li>Recommended for membrane systems</li> </ul>"},{"location":"api/equilibration/#minimization","title":"Minimization","text":"<ul> <li>Use minimize_steps only in first stage</li> <li>Typical value: 5000-10000 steps</li> <li>Removes bad contacts/clashes</li> <li>Always minimize before MD</li> </ul>"},{"location":"api/equilibration/#gpu-acceleration","title":"GPU Acceleration","text":"<pre><code># Enable GPU acceleration (default)\nstage = {\n    'use_gpu': True,\n    'gpu_id': 0,      # First GPU\n    'num_gpus': 1,    # Single GPU\n    'cpu_cores': 1    # Minimal CPU usage with GPU. Recommended &gt; 4 depending on the system\u00b4s size.\n}\n</code></pre>"},{"location":"api/equilibration/#output-structure","title":"Output Structure","text":"<pre><code>{output_name}/\n\u2514\u2500\u2500 namd/\n    \u251c\u2500\u2500 system.prmtop              # Copied AMBER topology\n    \u251c\u2500\u2500 system.inpcrd              # Copied AMBER coordinates  \n    \u251c\u2500\u2500 system.pdb                 # Copied system PDB (for structure/restraints)\n    \u251c\u2500\u2500 bilayer_*_lipid.pdb        # Copied bilayer PDB (for CRYST1 box info only)\n    \u251c\u2500\u2500 step1.conf                 # Stage 1 config\n    \u251c\u2500\u2500 step2.conf                 # Stage 2 config\n    \u251c\u2500\u2500 ...\n    \u251c\u2500\u2500 run_equilibration.sh       # Executable run script\n    \u251c\u2500\u2500 protocol_summary.json      # Protocol metadata\n    \u251c\u2500\u2500 restraints/\n        \u251c\u2500\u2500 step1_equilibration_restraints.pdb   # Stage 1 restraints\n        \u251c\u2500\u2500 step2_equilibration_restraints.pdb   # Stage 2 restraints\n    \u2514\u2500\u2500 logs/\n        \u251c\u2500\u2500 step1.log              # Stage 1 output\n        \u251c\u2500\u2500 step2.log              # Stage 2 output\n        \u2514\u2500\u2500 ...\n</code></pre> <p>Generated Files:</p> File Purpose <code>system.pdb</code> System structure for NAMD simulations and restraints <code>bilayer_*_lipid.pdb</code> Original bilayer file (kept for reference, CRYST1 info read from this) <code>stepN.conf</code> NAMD configuration for stage N <code>stepN_restraints.txt</code> Harmonic restraints for stage N <code>run_equilibration.sh</code> Bash script to run all stages sequentially <code>protocol_summary.json</code> Protocol metadata (stages, parameters, files) <code>logs/stepN.log</code> NAMD output log for stage N <p>Important Notes:</p> <ul> <li><code>system.pdb</code> is the actual system file used for simulations and restraint generation</li> <li><code>bilayer_*_lipid.pdb</code> is kept with its original name for reference and CRYST1 box dimensions</li> <li>Both files are copied to the output directory but serve different purposes</li> </ul> <p>Run Script Features:</p> <ul> <li>Sequential execution of all stages</li> <li>Automatic dependency management (restart files)</li> <li>Progress tracking</li> <li>Error handling</li> <li>Timing information</li> </ul>"},{"location":"api/equilibration/#internal-methods-advanced","title":"Internal Methods (Advanced)","text":""},{"location":"api/equilibration/#method-generate_restraints_file","title":"Method: generate_restraints_file()","text":"<p>Generates restraint PDB files with B-factors encoding restraint forces for each atom type.</p> <pre><code>generate_restraints_file(\n    system_pdb: Path,\n    constraints: Dict[str, float],\n    output_file: Path,\n    stage_name: str = \"\"\n) -&gt; None\n</code></pre> <p>Parameters:</p> Parameter Type Description <code>system_pdb</code> <code>Path</code> Path to the system.pdb file (full system: protein + lipids + water + ions) <code>constraints</code> <code>Dict[str, float]</code> Dictionary of restraint forces (kcal/mol/\u00c5\u00b2) for each atom type <code>output_file</code> <code>Path</code> Path for output restraints PDB file <code>stage_name</code> <code>str</code> Stage name for logging (optional) <p>Behavior:</p> <p>Reads the system.pdb file (NOT protein.pdb - includes all atoms)</p> <p>A. Classifies each atom by type:</p> <ul> <li><code>protein_backbone</code>: CA, C, N, O atoms in protein residues</li> <li><code>protein_sidechain</code>: Heavy sidechain atoms in protein residues</li> <li><code>lipid_head</code>: P, O atoms in lipid head groups</li> <li><code>lipid_tail</code>: C atoms in lipid tails</li> <li><code>water</code>: H2O molecules (TIP3, HOH, WAT, SOL)</li> <li><code>ions</code>: Na+, Cl-, K+, Ca2+, Mg2+, etc.</li> <li><code>other</code>: Ligands and other molecules</li> </ul> <p>B. Assigns B-factor values based on constraints dictionary</p> <p>C. Writes restraints PDB file with modified B-factors</p> <p>D. Logs detailed statistics: total atoms, counts per type, force values</p> <p>Example Output Log: <pre><code>INFO - Generated restraints file: step1_equilibration_restraints.pdb\nINFO - Source PDB: system.pdb\nINFO - Stage: Equilibration 1\nINFO - Total atoms processed: 45678\nINFO -   protein_backbone: 1234 atoms, force = 10.0 kcal/mol/\u00c5\u00b2\nINFO -   protein_sidechain: 2345 atoms, force = 5.0 kcal/mol/\u00c5\u00b2\nINFO -   lipid_head: 512 atoms, force = 5.0 kcal/mol/\u00c5\u00b2\nINFO -   lipid_tail: 3456 atoms, force = 5.0 kcal/mol/\u00c5\u00b2\nINFO -   ions: 89 atoms, force = 10.0 kcal/mol/\u00c5\u00b2\n</code></pre></p>"},{"location":"api/equilibration/#method-generate_charmm_gui_config_file","title":"Method: generate_charmm_gui_config_file()","text":"<p>Generates NAMD configuration files using CHARMM-GUI templates with GateWizard customizations.</p> <pre><code>generate_charmm_gui_config_file(\n    stage_name: str,\n    stage_params: Dict[str, Any],\n    stage_index: int,\n    system_files: Dict[str, str],\n    scheme_type: str,\n    previous_stage_name: Optional[str] = None,\n    all_stage_settings: Optional[Dict[str, Dict[str, Any]]] = None,\n    force_scheme_type: bool = False\n) -&gt; str\n</code></pre> <p>Parameters:</p> Parameter Type Description <code>stage_name</code> <code>str</code> Name of the equilibration stage <code>stage_params</code> <code>Dict[str, Any]</code> Stage parameters dictionary <code>stage_index</code> <code>int</code> Stage index (0-based) <code>system_files</code> <code>Dict[str, str]</code> System file paths <code>scheme_type</code> <code>str</code> CHARMM-GUI scheme type (NVT, NPT, NPAT, NPgT) <code>previous_stage_name</code> <code>Optional[str]</code> Previous stage name for restart files <code>all_stage_settings</code> <code>Optional[Dict]</code> All stages settings for context <code>force_scheme_type</code> <code>bool</code> [NEW] If True, always use <code>scheme_type</code> for all stages (GUI mode) <p>Returns: NAMD configuration file content as string</p> <p>Behavior:</p> <p>API Mode (force_scheme_type=False, default):</p> <ul> <li>Each stage can specify its own <code>ensemble</code> field</li> <li>Template folder is selected based on the stage's ensemble value</li> <li>Allows mixing NVT/NPT/NPAT templates across stages</li> <li>Warning logged when stage ensemble differs from protocol scheme_type</li> </ul> <p>GUI Mode (force_scheme_type=True):</p> <ul> <li>ALL stages use the global <code>scheme_type</code> for template selection</li> <li>Individual stage <code>ensemble</code> values are ignored for template selection</li> <li>Ensures CHARMM-GUI protocol consistency when selected from GUI dropdown</li> <li>Example: If \"NPT\" scheme selected, all stages use NPT templates (02_NPT folder)</li> </ul> <p>Template Selection Logic:</p> <ol> <li>If <code>custom_template</code> specified \u2192 use that template file</li> <li>If <code>force_scheme_type=True</code> \u2192 use <code>scheme_type</code> for folder selection</li> <li>If <code>force_scheme_type=False</code> \u2192 use stage's <code>ensemble</code> for folder selection</li> <li>Templates loaded from: <code>charmm_gui_templates/{scheme_folder}/{template_file}</code></li> </ol> <p>Scheme to Folder Mapping:</p> <ul> <li><code>NVT</code> \u2192 <code>01_NVT/</code></li> <li><code>NPT</code> \u2192 <code>02_NPT/</code></li> <li><code>NPAT</code> \u2192 <code>03_NPAT/</code></li> <li><code>NPgT</code> \u2192 <code>04_NPgT/</code></li> </ul> <p>Example (API Mode): <pre><code># Stage 1 uses NVT template, Stage 2 uses NPT template\nconfig1 = manager.generate_charmm_gui_config_file(\n    stage_name=\"Heating\",\n    stage_params={'ensemble': 'NVT', ...},\n    stage_index=0,\n    system_files=files,\n    scheme_type='NVT',\n    force_scheme_type=False  # API mode - use stage's ensemble\n)\n\nconfig2 = manager.generate_charmm_gui_config_file(\n    stage_name=\"Pressure Eq\",\n    stage_params={'ensemble': 'NPT', ...},  # Different ensemble\n    stage_index=1,\n    system_files=files,\n    scheme_type='NVT',  # Protocol default is NVT\n    force_scheme_type=False  # Stage uses NPT template (warning logged)\n)\n</code></pre></p> <p>Example (GUI Mode): <pre><code># User selected \"NPT\" scheme in GUI dropdown\n# ALL stages use NPT templates regardless of individual ensemble values\nconfig1 = manager.generate_charmm_gui_config_file(\n    stage_name=\"Stage 1\",\n    stage_params={'ensemble': 'NVT', ...},  # Ignored for template selection\n    stage_index=0,\n    system_files=files,\n    scheme_type='NPT',  # From GUI dropdown\n    force_scheme_type=True  # GUI mode - enforce scheme_type\n)\n# Uses template from: 02_NPT/step6.1_equilibration.inp\n\nconfig2 = manager.generate_charmm_gui_config_file(\n    stage_name=\"Stage 2\",\n    stage_params={'ensemble': 'NVT', ...},  # Ignored for template selection\n    stage_index=1,\n    system_files=files,\n    scheme_type='NPT',  # From GUI dropdown\n    force_scheme_type=True  # GUI mode - enforce scheme_type\n)\n# Uses template from: 02_NPT/step6.2_equilibration.inp\n</code></pre></p> <p>Rationale for force_scheme_type:</p> <p>The <code>force_scheme_type</code> parameter was added to support two different use cases:</p> <ol> <li> <p>GUI Users: Select a CHARMM-GUI scheme (NPT, NPAT, etc.) and expect all stages to use templates from that scheme folder for consistency with CHARMM-GUI protocols.</p> </li> <li> <p>API Users: Have flexibility to mix different ensemble templates across stages for custom equilibration protocols (e.g., NVT \u2192 NPT \u2192 NPAT progression).</p> </li> </ol>"},{"location":"api/equilibration/#common-issues","title":"Common Issues","text":""},{"location":"api/equilibration/#missing-cryst1-record","title":"Missing CRYST1 Record","text":"<p>Error: Box dimensions not found in PDB file</p> <p>Solution: Ensure <code>bilayer_pdb</code> contains CRYST1 record: <pre><code>head bilayer_protein_protonated_prepared_lipid.pdb\n# Should show: CRYST1   70.335   70.833   85.067  90.00  90.00  90.00 P 1\n</code></pre></p> <p>Correct file:</p> <ul> <li>From packmol-memgen <code>--parametrize</code> step</li> <li>Named <code>bilayer_*_lipid.pdb</code></li> <li>Contains proper PDB header with CRYST1</li> <li>Not an intermediate Packmol file</li> </ul>"},{"location":"api/equilibration/#restraint-file-errors","title":"Restraint File Errors","text":"<p>Error: Cannot generate restraint file OR restraints only applied to protein</p> <p>Solution: Ensure system.pdb is used (not protein.pdb):</p> <ul> <li>The restraints generation requires the full system.pdb file</li> <li>This file must contain: protein + lipids + water + ions</li> <li>Do NOT use protein.pdb (protein-only) for restraint generation</li> <li>Check that system.pdb exists in the working directory or input folder</li> <li>Verify atom names match AMBER topology</li> <li>Verify segnames/chains are present (PROA, MEMB, SOLV)</li> </ul> <p>Common mistake: Using protein.pdb instead of system.pdb results in:</p> <ul> <li>No restraints applied to lipids (lipid_head, lipid_tail)</li> <li>No restraints applied to ions</li> <li>Membrane collapse during equilibration</li> <li>System instability</li> </ul> <p>Fix: The GUI now automatically uses system.pdb from the output directory where files are copied. If you see restraints being generated with protein.pdb, check:</p> <ol> <li>Is system.pdb present in the input folder?</li> <li>Is system.pdb copied to the output directory?</li> <li>Check the log for \"Using PDB file for restraints generation: ...\"</li> </ol>"},{"location":"api/equilibration/#timestep-too-large","title":"Timestep Too Large","text":"<p>Error: NAMD crashes with \"Atoms moving too fast\"</p> <p>Solution: Reduce timestep or increase restraints:</p> <ul> <li>Use 1.0 fs with restraints &gt; 5.0 kcal/mol/\u00c5\u00b2</li> <li>Switch to 2.0 fs only when restraints &lt; 2.5 kcal/mol/\u00c5\u00b2</li> <li>Add minimization step if starting from poor geometry</li> </ul>"},{"location":"api/equilibration/#ensemble-switching","title":"Ensemble Switching","text":"<p>Error: System unstable when switching NPT \u2192 NPAT</p> <p>Solution: Ensure pressure is equilibrated first:</p> <ul> <li>Run NPT for at least 0.25 ns before NPAT</li> <li>Check box dimensions are stable in NPT</li> <li>Use medium restraints during transition</li> <li>Don't switch ensemble and reduce restraints simultaneously</li> </ul>"},{"location":"api/equilibration/#see-also","title":"See Also","text":"<ul> <li>User Guide - Complete usage guide</li> <li>Examples - Working code examples</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"api/preparation/","title":"Preparation Module","text":"<p>Module for predicting pKa values and managing protonation states in protein structures. This module includes:</p> <ul> <li>pKa prediction and analysis</li> <li>Protonation state assignment based on pH</li> <li>Disulfide bond detection and application</li> <li>Protein capping with ACE/NME groups</li> <li>pH-dependent protein structure preparation</li> </ul>"},{"location":"api/preparation/#import","title":"Import","text":"<pre><code>from gatewizard.core.propka import PropkaAnalyzer\nfrom gatewizard.utils.protein_capping import ProteinCapper\n</code></pre>"},{"location":"api/preparation/#class-propkaanalyzer","title":"Class: PropkaAnalyzer","text":"<p>Main class for running Propka analysis and managing protein protonation states.</p>"},{"location":"api/preparation/#constructor","title":"Constructor","text":"<pre><code>PropkaAnalyzer(propka_version: str = \"3\")\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>propka_version</code> <code>str</code> <code>\"3\"</code> Version of Propka to use <p>Returns: <code>PropkaAnalyzer</code> instance</p> <p>Example: <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer(propka_version=\"3\")\nprint(f\"Using PROPKA version: {analyzer.propka_version}\")\n</code></pre></p>"},{"location":"api/preparation/#core-methods","title":"Core Methods","text":""},{"location":"api/preparation/#method-run_analysis","title":"Method: run_analysis()","text":"<p>Run Propka analysis on a PDB file to predict pKa values.</p> <pre><code>run_analysis(pdb_file: str, output_dir: Optional[str] = None) -&gt; str\n</code></pre> <p>Parameters:</p> Parameter Type Required Description <code>pdb_file</code> <code>str</code> Yes Path to input PDB file <code>output_dir</code> <code>str</code> No Directory for output files. If None, uses input file's directory <p>Returns: <code>str</code> - Path to generated <code>.pka</code> file</p> <p>Raises:</p> <ul> <li><code>FileNotFoundError</code> - If input PDB file doesn't exist</li> <li><code>PropkaError</code> - If Propka execution fails</li> </ul> <p>Output Files:</p> <ul> <li><code>{basename}.pka</code> - Full Propka output file</li> </ul> <p>Example: <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\npka_file = analyzer.run_analysis(\"protein.pdb\")\n# Returns: \"protein.pka\"\n</code></pre></p>"},{"location":"api/preparation/#method-extract_summary","title":"Method: extract_summary()","text":"<p>Extract the summary section from a Propka output file.</p> <pre><code>extract_summary(\n    propka_file: str,\n    output_file: Optional[str] = None,\n    output_dir: Optional[str] = None\n) -&gt; str\n</code></pre> <p>Parameters:</p> Parameter Type Required Description <code>propka_file</code> <code>str</code> Yes Path to <code>.pka</code> file from <code>run_analysis()</code> <code>output_file</code> <code>str</code> No Custom name for output file <code>output_dir</code> <code>str</code> No Directory for output file <p>Returns: <code>str</code> - Path to summary file</p> <p>Raises: - <code>PropkaError</code> - If summary section not found in <code>.pka</code> file</p> <p>Output Files: - <code>{basename}_summary_of_prediction.txt</code> - Extracted summary section</p> <p>Example: <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\n\n# First run analysis to generate the .pka file\nanalyzer.run_analysis(\"protein.pdb\")\n\n# Then extract summary\nsummary_file = analyzer.extract_summary(\"protein.pka\")\n# Returns: \"protein_summary_of_prediction.txt\"\n</code></pre></p>"},{"location":"api/preparation/#method-parse_summary","title":"Method: parse_summary()","text":"<p>Parse summary file and extract residue information as structured data.</p> <pre><code>parse_summary(summary_file: Optional[str] = None) -&gt; List[Dict[str, Any]]\n</code></pre> <p>Parameters:</p> Parameter Type Required Description <code>summary_file</code> <code>str</code> No Path to summary file. If None, uses last extracted summary <p>Returns: <code>List[Dict[str, Any]]</code> - List of residue dictionaries</p> <p>Dictionary Structure:</p> Key Type Description Example <code>\"residue\"</code> <code>str</code> Residue/ligand name <code>\"ASP\"</code>, <code>\"HIS\"</code>, <code>\"P5S\"</code>, <code>\"LPE\"</code> <code>\"res_id\"</code> <code>int</code> Residue number (0 for ligands) <code>42</code>, <code>156</code>, <code>0</code> <code>\"chain\"</code> <code>str</code> Chain identifier <code>\"A\"</code>, <code>\"B\"</code> <code>\"pka\"</code> <code>float</code> Predicted pKa value <code>3.85</code>, <code>6.45</code>, <code>10.83</code> <code>\"atom\"</code> <code>str</code> Atom name (for ligands only) <code>\"\"</code>, <code>\"N\"</code>, <code>\"CAX\"</code>, <code>\"O15\"</code> <code>\"atom_type\"</code> <code>str</code> Atom type classification <code>\"\"</code>, <code>\"N31\"</code>, <code>\"OCO\"</code>, <code>\"OP\"</code> <code>\"model_pka\"</code> <code>float</code> or <code>None</code> Model pKa value <code>3.80</code>, <code>6.00</code>, <code>10.00</code> <p>Understanding Protein vs. Ligand Entries:</p> <p>PROPKA analyzes both protein residues and ligand molecules for ionizable groups:</p> <p>For Protein Residues:</p> <ul> <li><code>res_id</code>: Actual residue number (12, 52, 115, etc.)</li> <li><code>atom</code>: Empty string (protein residues are treated at residue level)</li> <li><code>atom_type</code>: Empty string</li> <li>Example: <code>ASP 52 A</code> means Aspartate at position 52 in chain A</li> </ul> <p>For Ligand Atoms:</p> <ul> <li><code>res_id</code>: Set to 0 (ligands don't have meaningful residue numbers)</li> <li><code>atom</code>: Specific atom name in the ligand (<code>N</code>, <code>CAX</code>, <code>O15</code>, etc.)</li> <li><code>atom_type</code>: Atom type classification (<code>N31</code>, <code>OCO</code>, <code>OP</code>, etc.)</li> <li>Example: <code>P5S N A</code> means atom N in ligand P5S in chain A</li> </ul> <p>PROPKA Summary Format: <pre><code>       Group      pKa  model-pKa   ligand atom-type\n   ASP  52 A     4.33       3.80                      \u2190 Protein residue\n   GLU  65 A     4.87       4.50                      \u2190 Protein residue\n   HIS  77 A     6.07       6.50                      \u2190 Protein residue\n   N+    8 A     7.66       8.00                      \u2190 N-terminus\n   P5S   N A    10.83      10.00                N31   \u2190 Ligand atom\n   LPE   N A     9.87      10.00                N31   \u2190 Ligand atom\n   Y01 CAX A     4.62       4.50                OCO   \u2190 Ligand atom\n   P5S O15 A     5.46       6.00                 OP   \u2190 Ligand atom\n</code></pre></p> <p>Common Atom Type Classifications:</p> <ul> <li>N31 - Tertiary amine nitrogen (sp\u00b3, 3 bonds)</li> <li>N33 - Quaternary nitrogen (sp\u00b3, 4 bonds, charged)</li> <li>OCO - Carboxyl oxygen (in -COO\u207b)</li> <li>OP - Phosphate oxygen (in -PO\u2084\u00b2\u207b)</li> <li>O3 - Hydroxyl oxygen (sp\u00b3)</li> <li>S3 - Thiol sulfur (sp\u00b3)</li> </ul> <p>Raises:</p> <ul> <li><code>FileNotFoundError</code> - If summary file doesn't exist</li> <li><code>PropkaError</code> - If no ionizable residues found</li> </ul> <p>Example: <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\n\n# First run analysis and extract summary to generate the summary file\nanalyzer.run_analysis(\"protein.pdb\")\nanalyzer.extract_summary(\"protein.pka\")\n\n# Now parse the summary file\nresidues = analyzer.parse_summary(\"protein_summary_of_prediction.txt\")\nprint(residues)\n# Returns: [\n#     # Protein residues:\n#     {'residue': 'ASP', 'res_id': 52, 'chain': 'A', 'pka': 4.33, \n#      'atom': '', 'atom_type': '', 'model_pka': 3.8},\n#     {'residue': 'GLU', 'res_id': 65, 'chain': 'A', 'pka': 3.87, \n#      'atom': '', 'atom_type': '', 'model_pka': 4.5},\n#     \n#     # Ligand atoms:\n#     {'residue': 'P5S', 'res_id': 0, 'chain': 'A', 'pka': 10.83, \n#      'atom': 'N', 'atom_type': 'N31', 'model_pka': 10.0},\n#     {'residue': 'LPE', 'res_id': 0, 'chain': 'A', 'pka': 9.87, \n#      'atom': 'N', 'atom_type': 'N31', 'model_pka': 10.0},\n#     {'residue': 'Y01', 'res_id': 0, 'chain': 'A', 'pka': 4.62, \n#      'atom': 'CAX', 'atom_type': 'OCO', 'model_pka': 4.5},\n#     {'residue': 'P5S', 'res_id': 0, 'chain': 'A', 'pka': 5.46, \n#      'atom': 'O15', 'atom_type': 'OP', 'model_pka': 6.0},\n#     ...\n# ]\n\n# Separate protein residues from ligand atoms\nprotein_residues = [r for r in residues if r['res_id'] &gt; 0]\nligand_atoms = [r for r in residues if r['res_id'] == 0]\n\nprint(f\"Found {len(protein_residues)} ionizable protein residues\")\nprint(f\"Found {len(ligand_atoms)} ionizable ligand atoms\")\n\n# Analyze ligands\nfor lig in ligand_atoms:\n    print(f\"Ligand {lig['residue']} atom {lig['atom']} ({lig['atom_type']}): \"\n          f\"pKa = {lig['pka']:.2f}\")\n\n# Group by ligand type\nfrom collections import defaultdict\nligands_by_type = defaultdict(list)\nfor lig in ligand_atoms:\n    ligands_by_type[lig['residue']].append(lig)\n\nfor ligand_name, atoms in ligands_by_type.items():\n    print(f\"\\n{ligand_name}: {len(atoms)} ionizable atoms\")\n    for atom in atoms:\n        print(f\"  {atom['atom']:6s} pKa={atom['pka']:5.2f} ({atom['atom_type']})\")\n</code></pre></p> <p>Output: <pre><code>...\nFound 272 ionizable protein residues\nFound 22 ionizable ligand atoms\nLigand P5S atom N (N31): pKa = 10.83\nLigand LPE atom N (N31): pKa = 9.87\nLigand OJ0 atom N02 (N33): pKa = 8.82\nLigand P5S atom C (OCO): pKa = 4.16\nLigand Y01 atom CAX (OCO): pKa = 4.62\nLigand Y01 atom CAX (OCO): pKa = 4.56\nLigand Y01 atom CAX (OCO): pKa = 5.05\nLigand Y01 atom CAX (OCO): pKa = 4.52\nLigand Y01 atom CAX (OCO): pKa = 4.68\nLigand Y01 atom CAX (OCO): pKa = 4.65\nLigand P5S atom O15 (OP): pKa = 5.46\nLigand LPE atom O31 (OP): pKa = 5.15\nLigand PCW atom O1P (OP): pKa = 6.08\nLigand LPE atom O31 (OP): pKa = 6.46\nLigand PCW atom O1P (OP): pKa = 5.62\nLigand PCW atom O1P (OP): pKa = 7.02\nLigand LPE atom O32 (OP): pKa = 6.01\nLigand LPE atom O31 (OP): pKa = 6.54\nLigand LPE atom O32 (OP): pKa = 6.30\nLigand LPE atom O32 (OP): pKa = 6.81\nLigand PCW atom O1P (OP): pKa = 6.17\nLigand PCW atom O1P (OP): pKa = 4.64\n\nP5S: 3 ionizable atoms\n  N      pKa=10.83 (N31)\n  C      pKa= 4.16 (OCO)\n  O15    pKa= 5.46 (OP)\n\nLPE: 7 ionizable atoms\n  N      pKa= 9.87 (N31)\n  O31    pKa= 5.15 (OP)\n  O31    pKa= 6.46 (OP)\n  O32    pKa= 6.01 (OP)\n  O31    pKa= 6.54 (OP)\n  O32    pKa= 6.30 (OP)\n  O32    pKa= 6.81 (OP)\n\nOJ0: 1 ionizable atoms\n  N02    pKa= 8.82 (N33)\n\nY01: 6 ionizable atoms\n  CAX    pKa= 4.62 (OCO)\n  CAX    pKa= 4.56 (OCO)\n  CAX    pKa= 5.05 (OCO)\n  CAX    pKa= 4.52 (OCO)\n  CAX    pKa= 4.68 (OCO)\n  CAX    pKa= 4.65 (OCO)\n\nPCW: 5 ionizable atoms\n  O1P    pKa= 6.08 (OP)\n  O1P    pKa= 5.62 (OP)\n  O1P    pKa= 7.02 (OP)\n  O1P    pKa= 6.17 (OP)\n  O1P    pKa= 4.64 (OP)\n</code></pre></p>"},{"location":"api/preparation/#method-apply_protonation_states","title":"Method: apply_protonation_states()","text":"<p>Apply predicted protonation states to a PDB file based on pH and Propka results.</p> <pre><code>apply_protonation_states(\n    input_pdb: str,\n    output_pdb: str,\n    ph: float,\n    custom_states: Optional[Dict[str, str]] = None,\n    residues: Optional[List[Dict[str, Any]]] = None\n) -&gt; Dict[str, int]\n</code></pre> <p>Parameters:</p> Parameter Type Required Description <code>input_pdb</code> <code>str</code> Yes Path to input PDB file <code>output_pdb</code> <code>str</code> Yes Path for output PDB file with modified residue names <code>ph</code> <code>float</code> Yes Target pH value for protonation state prediction <code>custom_states</code> <code>Dict[str, str]</code> No Custom state overrides (format: <code>{\"ASP42\": \"ASH\"}</code> or <code>{\"ASP42_A\": \"ASH\"}</code>) <code>residues</code> <code>List[Dict]</code> No Residue list. If None, uses last parsed results <p>Returns: <code>Dict[str, int]</code> - Statistics dictionary</p> <p>Return Dictionary:</p> Key Type Description <code>\"residue_changes\"</code> <code>int</code> Number of unique residues modified <code>\"record_changes\"</code> <code>int</code> Total number of PDB records (atoms) modified <p>Raises:</p> <ul> <li><code>FileNotFoundError</code> - If input PDB file doesn't exist</li> <li><code>PropkaError</code> - If no residue data available (need to run <code>parse_summary()</code> first)</li> </ul> <p>Protonation State Logic:</p> <p>The method automatically determines protonation states based on pKa vs pH:</p> Residue Condition State AMBER Code ASP pH &lt; pKa Protonated ASH ASP pH \u2265 pKa Deprotonated ASP GLU pH &lt; pKa Protonated GLH GLU pH \u2265 pKa Deprotonated GLU HIS pH &lt; pKa Protonated HIP HIS pH \u2265 pKa Neutral (\u03b5) HIE LYS pH &lt; pKa Protonated LYS LYS pH \u2265 pKa Neutral LYN CYS pH &lt; pKa Free thiol CYS CYS pH \u2265 pKa Deprotonated CYM <p>Important Notes:</p> <ul> <li>This method only modifies residue names in the PDB file (e.g., ASP \u2192 ASH, HIS \u2192 HIP)</li> <li>It does NOT add or remove hydrogen atoms</li> <li>For MD simulations, you may need additional preparation:</li> <li>Use <code>pdb4amber</code> or LEaP to add missing hydrogens</li> <li>Use system preparation tools to add solvent and parameterize</li> </ul> <p>Custom States Format:</p> <p>Custom states can be specified with or without chain identifiers:</p> <ul> <li><code>{\"ASP12\": \"ASH\"}</code> - Applies to all chains</li> <li><code>{\"ASP12_A\": \"ASH\"}</code> - Applies only to chain A</li> <li><code>{\"HIS15\": \"HID\"}</code> - Use delta-protonated histidine instead of epsilon</li> </ul> <p>Example: <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\npka_file = analyzer.run_analysis(\"protein.pdb\")\nsummary_file = analyzer.extract_summary(pka_file)\nresidues = analyzer.parse_summary(summary_file)\n\n# Basic usage - automatic protonation at pH 7.4\nstats = analyzer.apply_protonation_states(\n    input_pdb=\"protein.pdb\",\n    output_pdb=\"protein_ph7.4.pdb\",\n    ph=7.4,\n    residues=residues\n)\nprint(f\"Modified {stats['residue_changes']} residues ({stats['record_changes']} atoms)\")\n\n# With custom states - override specific residues\ncustom = {\n    \"ASP12\": \"ASH\",    # Want to protonate original ASP12\n    \"GLU13\": \"GLH\",    # Want to protonate original GLU13\n    \"HIS15\": \"HID\"     # Want delta-protonated original HIS15\n}\n\nstats = analyzer.apply_protonation_states(\n    input_pdb=\"protein.pdb\",\n    output_pdb=\"protein_custom.pdb\",\n    ph=7.4,\n    custom_states=custom,\n    residues=residues\n)\n</code></pre></p>"},{"location":"api/preparation/#method-get_default_protonation_state","title":"Method: get_default_protonation_state()","text":"<p>Get the default protonation state for a residue at a given pH.</p> <pre><code>get_default_protonation_state(\n    residue: Dict[str, Any],\n    ph: float\n) -&gt; str\n</code></pre> <p>Parameters:</p> Parameter Type Required Description <code>residue</code> <code>Dict[str, Any]</code> Yes Residue dictionary from <code>parse_summary()</code> <code>ph</code> <code>float</code> Yes Target pH value <p>Returns: <code>str</code> - Three-letter AMBER residue code</p> <p>Example: <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\npka_file = analyzer.run_analysis(\"protein.pdb\")\nsummary_file = analyzer.extract_summary(pka_file)\nresidues = analyzer.parse_summary(summary_file)\n\nfor res in residues:\n    states = [analyzer.get_default_protonation_state(res, ph=p) for p in [2.0, 7.0, 11.0]]\n    print(f\"{res['residue']}{res['res_id']} (pKa={res['pka']:.2f}): \"\n          f\"pH2={states[0]}, pH7={states[1]}, pH11={states[2]}\")\n</code></pre></p>"},{"location":"api/preparation/#protonation-state-methods","title":"Protonation State Methods","text":""},{"location":"api/preparation/#method-get_available_states","title":"Method: get_available_states()","text":"<p>Get available protonation states for a residue type.</p> <pre><code>get_available_states(residue_type: str) -&gt; Dict[str, str]\n</code></pre> <p>Parameters:</p> Parameter Type Required Description <code>residue_type</code> <code>str</code> Yes Three-letter residue code (e.g., \"ASP\", \"HIS\") <p>Returns: <code>Dict[str, str]</code> - Dictionary of available states</p> <p>Example: <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\nhis_states = analyzer.get_available_states(\"HIS\")\nprint(his_states)\n# Output: {'neutral_epsilon': 'HIE', 'neutral_delta': 'HID', 'protonated': 'HIP'}\n</code></pre></p>"},{"location":"api/preparation/#amber-compatible-residue-names","title":"AMBER-Compatible Residue Names","text":"Standard Protonated Deprotonated Notes ASP ASH ASP Aspartic acid GLU GLH GLU Glutamic acid HIS HIP HIE/HID HIP=both N protonated, HIE=\u03b5, HID=\u03b4 LYS LYS LYN Lysine ARG ARG - Arginine (always protonated in AMBER) CYS CYS CYM Cysteine (free thiol) CYS - CYX Cysteine in disulfide bond TYR TYR TYM Tyrosine"},{"location":"api/preparation/#disulfide-bond-methods","title":"Disulfide Bond Methods","text":""},{"location":"api/preparation/#method-detect_disulfide_bonds","title":"Method: detect_disulfide_bonds()","text":"<p>Automatically detect potential disulfide bonds based on sulfur-sulfur distance.</p> <pre><code>detect_disulfide_bonds(\n    pdb_file: str,\n    distance_threshold: float = 2.5\n) -&gt; List[Tuple[Tuple[str, int], Tuple[str, int]]]\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>pdb_file</code> <code>str</code> Required Path to PDB file <code>distance_threshold</code> <code>float</code> <code>2.5</code> Maximum S-S distance in \u00c5ngstr\u00f6ms <p>Returns: List of bond pairs: <code>[((res_name, res_id), (res_name, res_id)), ...]</code></p> <p>Algorithm: 1. Extracts all cysteine SG (sulfur gamma) atoms from PDB 2. Calculates pairwise distances between all SG atoms 3. Identifies pairs within the distance threshold 4. Returns list of bonded residue pairs</p> <p>Example: <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\n# Detect with default 2.5 \u00c5 threshold\nbonds = analyzer.detect_disulfide_bonds(\"protein.pdb\")\nprint(f\"Found {len(bonds)} disulfide bonds:\")\n\nfor bond in bonds:\n    (res1_name, res1_id), (res2_name, res2_id) = bond\n    print(f\"  {res1_name}{res1_id} \u2194 {res2_name}{res2_id}\")\n# Output:\n# Found 1 disulfide bonds:\n#   CYS18 \u2194 CYS34\n\n# Use stricter threshold\nbonds_strict = analyzer.detect_disulfide_bonds(\"protein.pdb\", distance_threshold=2.0)\nprint(f\"Strict (2.0 \u00c5): {len(bonds_strict)} bonds\")\n\n# Output:\n# Strict (2.0 \u00c5): 0 bonds\n</code></pre></p>"},{"location":"api/preparation/#method-apply_disulfide_bonds","title":"Method: apply_disulfide_bonds()","text":"<p>Apply disulfide bond assignments by renaming CYS \u2192 CYX for bonded cysteines.</p> <pre><code>apply_disulfide_bonds(\n    input_pdb: str,\n    output_pdb: str,\n    disulfide_bonds: Optional[List[Tuple[Tuple[str, int], Tuple[str, int]]]] = None,\n    auto_detect: bool = True\n) -&gt; int\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>input_pdb</code> <code>str</code> Required Input PDB file path <code>output_pdb</code> <code>str</code> Required Output PDB file path <code>disulfide_bonds</code> <code>List[Tuple]</code> <code>None</code> Pre-detected bonds (auto-detect if None) <code>auto_detect</code> <code>bool</code> <code>True</code> Auto-detect if bonds not provided <p>Returns: <code>int</code> - Number of disulfide bonds applied (NOT the number of atoms changed)</p> <p>What it does: 1. Identifies cysteines involved in disulfide bonds 2. Changes residue name from CYS to CYX in all ATOM/HETATM records 3. Preserves all other PDB information (coordinates, chains, etc.) 4. Returns count of bonds (e.g., 1 bond = 2 cysteines = ~20 atom records changed)</p> <p>Example: <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\n# Auto-detect and apply\nnum_bonds = analyzer.apply_disulfide_bonds(\n    input_pdb=\"protein.pdb\",\n    output_pdb=\"protein_ss_auto.pdb\"\n)\nprint(f\"\u2713 Applied {num_bonds} disulfide bonds\")\n\n# Use pre-detected bonds with custom threshold\nbonds = analyzer.detect_disulfide_bonds(\"protein.pdb\", distance_threshold=2.3)\nnum_bonds = analyzer.apply_disulfide_bonds(\n    input_pdb=\"protein.pdb\",\n    output_pdb=\"protein_ss_custom.pdb\",\n    disulfide_bonds=bonds,\n    auto_detect=False\n)\n</code></pre></p> <p>Integration with Protonation Workflow:</p> <p>Disulfide bonds should be applied after protonation states:</p> <p>Example: <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\npka_file = analyzer.run_analysis(\"protein.pdb\")\nsummary_file = analyzer.extract_summary(pka_file)\nresidues = analyzer.parse_summary(summary_file)\n# Step 1: Apply protonation states\nstats = analyzer.apply_protonation_states(\n    input_pdb=\"protein.pdb\",\n    output_pdb=\"protein_ph7.pdb\",\n    ph=7.4,\n    residues=residues,\n)\n\n# Step 2: Apply disulfide bonds to protonated structure\nnum_bonds = analyzer.apply_disulfide_bonds(\n    input_pdb=\"protein_ph7.pdb\",\n    output_pdb=\"protein_ph7_ss.pdb\"\n)\n</code></pre></p>"},{"location":"api/preparation/#utility-methods","title":"Utility Methods","text":""},{"location":"api/preparation/#method-get_residue_statistics","title":"Method: get_residue_statistics()","text":"<p>Get statistics about the protonable residues.</p> <pre><code>get_residue_statistics() -&gt; Dict[str, int]\n</code></pre> <p>Returns: <code>Dict[str, int]</code> - Dictionary with residue type counts</p> <p>Example: <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\npka_file = analyzer.run_analysis(\"protein.pdb\")\nsummary_file = analyzer.extract_summary(pka_file)\nresidues = analyzer.parse_summary(summary_file)\n\nstats = analyzer.get_residue_statistics()\nfor res_type, count in stats.items():\n    print(f\"{res_type}: {count}\")\n# Output:\n# ASP: 2\n# GLU: 2\n# HIS: 1\n# CYS: 3\n# TYR: 1\n# LYS: 1\n# ARG: 2\n# N+: 1\n</code></pre></p>"},{"location":"api/preparation/#method-get_ph_titration_curve","title":"Method: get_ph_titration_curve()","text":"<p>Generate titration curves for all protonable residues.</p> <pre><code>get_ph_titration_curve(\n    ph_range: Tuple[float, float] = (0, 14),\n    ph_step: float = 0.5\n) -&gt; Dict[str, List[Tuple[float, str]]]\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>ph_range</code> <code>Tuple[float, float]</code> <code>(0, 14)</code> pH range as (min, max) <code>ph_step</code> <code>float</code> <code>0.5</code> Step size for pH values <p>Returns: <code>Dict[str, List[Tuple[float, str]]]</code> - Mapping of residue IDs to (pH, state) tuples</p> <p>Example: <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\npka_file = analyzer.run_analysis(\"protein.pdb\")\nsummary_file = analyzer.extract_summary(pka_file)\nresidues = analyzer.parse_summary(summary_file)\n\ncurves = analyzer.get_ph_titration_curve(ph_range=(4, 10), ph_step=1.0)\n\nfor residue_id, curve in curves.items():\n    print(f\"\\n{residue_id}:\")\n    for ph, state in curve:\n        print(f\"  pH {ph:.1f}: {state}\")\n</code></pre></p> <p>Plotting Example:</p> <p>You can visualize titration curves using matplotlib. For readability, it's best to plot only specific residues of interest:</p> <pre><code>from gatewizard.core.propka import PropkaAnalyzer\nimport matplotlib.pyplot as plt\n\nanalyzer = PropkaAnalyzer()\npka_file = analyzer.run_analysis(\"protein.pdb\")\nsummary_file = analyzer.extract_summary(pka_file)\nresidues = analyzer.parse_summary(summary_file)\n\n# Get titration curves\ncurves = analyzer.get_ph_titration_curve(ph_range=(0, 14), ph_step=0.5)\n\n# State encoding for plotting (1 = protonated, 0 = deprotonated)\nstate_map = {'ASH': 1, 'ASP': 0, 'GLH': 1, 'GLU': 0, \n             'HIP': 1, 'HIE': 0, 'HID': 0, 'LYS': 1, 'LYN': 0,\n             'CYS': 0, 'CYM': 0, 'TYR': 0, 'TYM': 0, 'ARG': 1}\n\n# Option 1: Select specific residues by name\nselected_residues = ['ASP12', 'GLU13', 'LYS16']\nfiltered_curves = {k: v for k, v in curves.items() if k in selected_residues}\n\n# Option 2: Select by residue type (e.g., only histidines)\n# filtered_curves = {k: v for k, v in curves.items() if k.startswith('HIS')}\n\n# Option 3: Select residues with pKa near physiological pH (6-8)\n# pka_dict = {f\"{r['residue']}{r['res_id']}_{r['chain']}\": r['pka'] \n#             for r in residues if r['res_id'] &gt; 0}\n# filtered_curves = {k: v for k, v in curves.items() \n#                    if k in pka_dict and 6 &lt;= pka_dict[k] &lt;= 8}\n\n# Plot selected curves\nfig, ax = plt.subplots(figsize=(10, 6))\n\nfor residue_id, curve in filtered_curves.items():\n    ph_values = [ph for ph, _ in curve]\n    protonation = [state_map.get(state, 0.5) for _, state in curve]\n    ax.plot(ph_values, protonation, marker='o', label=residue_id, \n            linewidth=2, markersize=6, alpha=0.8)\n\nax.axvline(x=7.4, color='gray', linestyle='--', linewidth=1.5, \n           alpha=0.5, label='pH 7.4 (physiological)')\nax.set_xlabel('pH', fontsize=12)\nax.set_ylabel('Protonation State (1=protonated, 0=deprotonated)', fontsize=12)\nax.set_title('Protein Titration Curves', fontsize=14)\nax.set_ylim(-0.1, 1.1)\nax.grid(True, alpha=0.3)\nax.legend(fontsize=10)\nplt.tight_layout()\nplt.savefig('propka_titration_curves.png', dpi=300, bbox_inches='tight')\nplt.show()\n\nprint(f\"Plotted {len(filtered_curves)} out of {len(curves)} total residues\")\n# Output\n# Plotted 3 out of 13 total residues\n</code></pre> <p>Example Output:</p> <p></p> <p>Figure: Titration curves for selected residues showing protonation state transitions across pH range. The vertical dashed line indicates physiological pH (7.4).</p> <p>Alternative: Plot pKa Distribution with Protonation States:</p> <pre><code>import matplotlib.pyplot as plt\nimport numpy as np\n\nanalyzer = PropkaAnalyzer()\npka_file = analyzer.run_analysis(\"protein.pdb\")\nsummary_file = analyzer.extract_summary(pka_file)\nresidues = analyzer.parse_summary(summary_file)\n\n# Filter protein residues only\nprotein_residues = [r for r in residues if r['res_id'] &gt; 0]\n\n# Set target pH for protonation state analysis\ntarget_ph = 5.0  # Change this to analyze different pH\n\n# Group by residue type and calculate protonation states\nresidue_data = {}\nfor res in protein_residues:\n    res_type = res['residue']\n    if res_type not in residue_data:\n        residue_data[res_type] = {'pka': [], 'protonated': [], 'state': []}\n\n    residue_data[res_type]['pka'].append(res['pka'])\n\n    # Determine protonation state at target pH\n    state = analyzer.get_default_protonation_state(res, ph=target_ph)\n    residue_data[res_type]['state'].append(state)\n\n    # Check if protonated (pH &lt; pKa =&gt; protonated)\n    is_protonated = target_ph &lt; res['pka']\n    residue_data[res_type]['protonated'].append(is_protonated)\n\n# Prepare data for plotting\nres_names = []\npka_values_list = []\nprotonation_list = []\ncolors_list = []\n\ncolor_map = {'ASP': '#e74c3c', 'GLU': \"#f92f94\", 'HIS': \"#72e183\", \n             'LYS': \"#60cae7\", 'CYS': '#9b59b6', 'TYR': \"#5b76f8\", \n             'ARG': '#f39c12', 'N+': '#95a5a6', 'C-': '#34495e'}\n\nfor res_type in sorted(residue_data.keys()):\n    res_names.append(res_type)\n    pka_values_list.append(residue_data[res_type]['pka'])\n    protonation_list.append(residue_data[res_type]['protonated'])\n    colors_list.append(color_map.get(res_type, '#7f8c8d'))\n\n# Create figure with two subplots\nfig, (ax1, ax2) = plt.subplots(2, 1, figsize=(12, 10), \n                                gridspec_kw={'height_ratios': [2, 1]})\n\n# --- Top plot: pKa distribution with protonation states ---\nbp = ax1.boxplot(pka_values_list, labels=res_names, patch_artist=True,\n                 showmeans=True, meanline=False,\n                 medianprops={'color': 'black', 'linewidth': 2},\n                 meanprops={'marker': 'D', 'markerfacecolor': 'red', \n                           'markeredgecolor': 'darkred', 'markersize': 6})\n\n# Color each box\nfor patch, color in zip(bp['boxes'], colors_list):\n    patch.set_facecolor(color)\n    patch.set_alpha(0.6)\n\n# Add individual points colored by protonation state\nfor i, (res_type, pka_vals, prot_states) in enumerate(zip(res_names, pka_values_list, protonation_list)):\n    x = np.random.normal(i+1, 0.04, size=len(pka_vals))\n    # Protonated = filled circles, Deprotonated = open circles\n    for xi, pka, is_prot in zip(x, pka_vals, prot_states):\n        if is_prot:\n            ax1.scatter(xi, pka, s=50, color=colors_list[i], alpha=0.7, \n                       edgecolors='black', linewidth=1, marker='o', zorder=3)\n        else:\n            ax1.scatter(xi, pka, s=50, facecolors='none', edgecolors=colors_list[i], \n                       alpha=0.7, linewidth=2, marker='o', zorder=3)\n\n# Add pH reference line\nax1.axhline(y=target_ph, color='red', linestyle='--', linewidth=2.5, \n           alpha=0.8, label=f'pH {target_ph} (target)', zorder=2)\n\nax1.set_ylabel('pKa', fontsize=13, fontweight='bold')\nax1.set_title(f'pKa Distribution and Protonation States at pH {target_ph}', \n              fontsize=15, fontweight='bold')\nax1.grid(True, alpha=0.3, axis='y', linestyle=':')\nax1.legend(loc='upper right', fontsize=11)\nax1.set_ylim(0, 20)\n\n# Add legend for protonation states\nfrom matplotlib.patches import Patch\nfrom matplotlib.lines import Line2D\nlegend_elements = [\n    Line2D([0], [0], marker='o', color='w', markerfacecolor='gray', \n           markersize=10, markeredgecolor='black', linewidth=1, \n           label='Protonated (pH &lt; pKa)'),\n    Line2D([0], [0], marker='o', color='w', markerfacecolor='none', \n           markersize=10, markeredgecolor='gray', linewidth=2, \n           label='Deprotonated (pH \u2265 pKa)')\n]\nax1.legend(handles=legend_elements, loc='upper left', fontsize=10)\n\n# --- Bottom plot: Protonation fraction bar chart ---\nprotonation_fractions = []\nfor prot_states in protonation_list:\n    if len(prot_states) &gt; 0:\n        fraction = sum(prot_states) / len(prot_states)\n    else:\n        fraction = 0\n    protonation_fractions.append(fraction)\n\nbars = ax2.bar(range(1, len(res_names)+1), protonation_fractions, \n               color=colors_list, alpha=0.7, edgecolor='black', linewidth=1.5)\n\n# Add percentage labels on bars\nfor i, (bar, frac) in enumerate(zip(bars, protonation_fractions)):\n    height = bar.get_height()\n    ax2.text(bar.get_x() + bar.get_width()/2., height + 0.02,\n             f'{frac*100:.0f}%', ha='center', va='bottom', fontsize=10, fontweight='bold')\n\nax2.set_xlabel('Residue Type', fontsize=13, fontweight='bold')\nax2.set_ylabel('Protonated Fraction', fontsize=13, fontweight='bold')\nax2.set_title(f'Protonation State Distribution at pH {target_ph}', fontsize=14, fontweight='bold')\nax2.set_xticks(range(1, len(res_names)+1))\nax2.set_xticklabels(res_names)\nax2.set_ylim(0, 1.1)\nax2.axhline(y=0.5, color='gray', linestyle=':', linewidth=1, alpha=0.5)\nax2.grid(True, alpha=0.3, axis='y', linestyle=':')\n\nplt.tight_layout()\nplt.savefig('propka_pka_distribution.png', dpi=600, bbox_inches='tight')\nplt.show()\n\n# Print statistics\nprint(f\"\\npKa Statistics and Protonation States at pH {target_ph}:\")\nprint(\"=\" * 80)\nfor res_type, data in sorted(residue_data.items()):\n    pka_vals = data['pka']\n    n_prot = sum(data['protonated'])\n    n_total = len(pka_vals)\n    prot_frac = n_prot / n_total if n_total &gt; 0 else 0\n\n    print(f\"\\n{res_type:4s}: n={n_total:2d}  \"\n          f\"pKa range=[{min(pka_vals):5.2f}, {max(pka_vals):5.2f}]  \"\n          f\"mean={np.mean(pka_vals):5.2f}\")\n    print(f\"      Protonated: {n_prot}/{n_total} ({prot_frac*100:.0f}%)  \"\n          f\"Deprotonated: {n_total-n_prot}/{n_total} ({(1-prot_frac)*100:.0f}%)\")\n    print(f\"      States: {', '.join(set(data['state']))}\")\n</code></pre> <p>Example Output:</p> <p></p> <p>Figure: (Top) pKa distribution by residue type with protonation states at pH 5.0. Filled circles indicate protonated residues (pH &lt; pKa), open circles indicate deprotonated residues (pH \u2265 pKa). The red dashed line shows the target pH. (Bottom) Fraction of each residue type that is protonated at pH 5.0.</p>"},{"location":"api/preparation/#protein-capping","title":"Protein Capping","text":"<p>Module: <code>gatewizard.utils.protein_capping</code></p> <p>Protein capping adds ACE (N-acetyl) and NME (N-methylamide) groups to protein termini to:</p> <ul> <li>Neutralize charges at termini</li> <li>Improve Propka analysis accuracy</li> <li>Better represent membrane protein environments</li> <li>Mimic peptide bond continuation in protein fragments</li> </ul>"},{"location":"api/preparation/#class-proteincapper","title":"Class: ProteinCapper","text":"<pre><code>from gatewizard.utils.protein_capping import ProteinCapper, cap_protein\n\ncapper = ProteinCapper()\n</code></pre>"},{"location":"api/preparation/#method-remove_hydrogens_and_cap","title":"Method: remove_hydrogens_and_cap()","text":"<p>Main method to add ACE/NME caps and track residue renumbering.</p> <pre><code>remove_hydrogens_and_cap(\n    input_file: Union[str, Path],\n    output_file: Optional[Union[str, Path]] = None,\n    target_dir: Optional[Union[str, Path]] = None\n) -&gt; Tuple[str, Dict]\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>input_file</code> <code>str/Path</code> Required Input PDB file <code>output_file</code> <code>str/Path</code> <code>None</code> Output file (auto-generated if None) <code>target_dir</code> <code>str/Path</code> <code>None</code> Directory for mapping file <p>Returns: <code>Tuple[str, Dict]</code></p> <ul> <li><code>str</code> - Path to capped PDB file</li> <li><code>Dict</code> - Residue mapping dictionary</li> </ul> <p>Residue Mapping Dictionary:</p> <pre><code>{\n    (original_resname, chain, original_resid): (new_resname, chain, new_resid),\n    ...\n}\n</code></pre> <p>What Happens During Capping:</p> <pre><code>Before: MET1 - ALA2 - ... - GLY50\nAfter:  ACE1 - MET2 - ALA3 - ... - GLY51 - NME52\n</code></pre> <p>All residue numbers shift by +1, and ACE/NME caps are added.</p> <p>Example: <pre><code>from gatewizard.utils.protein_capping import ProteinCapper\n\ncapper = ProteinCapper()\n\n# Add caps and get mapping\ncapped_file, residue_mapping = capper.remove_hydrogens_and_cap(\n    input_file=\"protein.pdb\",\n    output_file=\"protein_capped.pdb\",\n    target_dir=\"output\"\n)\n\nprint(f\"\u2713 Capped protein: {capped_file}\")\nprint(f\"\u2713 Residue mapping: {len(residue_mapping)} residues tracked\")\n\n# Show first few mappings\nfor (orig_resname, chain, orig_resid), (new_resname, new_chain, new_resid) in list(residue_mapping.items())[:5]:\n    print(f\"  {orig_resname}{orig_resid} (Chain {chain}) \u2192 {new_resname}{new_resid}\")\n# Output:\n#  LEU1 (Chain A) \u2192 LEU2\n#  PRO2 (Chain A) \u2192 PRO3\n#  ALA3 (Chain A) \u2192 ALA4\n#  GLY4 (Chain A) \u2192 GLY5\n#  ILE5 (Chain A) \u2192 ILE6\n</code></pre></p>"},{"location":"api/preparation/#convenience-function-cap_protein","title":"Convenience Function: cap_protein()","text":"<p>Simplified wrapper for protein capping.</p> <pre><code>from gatewizard.utils.protein_capping import cap_protein\n\ncapped_file, mapping = cap_protein(\n    input_file=\"protein.pdb\",\n    output_file=\"protein_capped.pdb\"\n)\n</code></pre>"},{"location":"api/preparation/#pdb4amber-integration","title":"pdb4amber Integration","text":"<p>Important Distinction:</p> Method Runs pdb4amber? Output GUI \"Apply States &amp; Run pdb4amber\" button \u2705 YES (automatic) AMBER-ready PDB with hydrogens API <code>apply_protonation_states()</code> \u274c NO (manual) Only residue name changes API <code>apply_disulfide_bonds()</code> \u274c NO (manual) Only CYS\u2192CYX changes <p>The API methods only modify residue names in PDB files. For MD simulations, you must run pdb4amber separately:</p> <p>Option 1: Command Line <pre><code>pdb4amber -i protein_protonated_ss.pdb -o protein_prepared.pdb\n</code></pre></p> <p>Option 2: Python subprocess <pre><code>import subprocess\n\nresult = subprocess.run([\n    \"pdb4amber\",\n    \"-i\", \"protein_protonated_ss.pdb\",\n    \"-o\", \"protein_prepared.pdb\"\n], capture_output=True, text=True, check=True)\n</code></pre></p>"},{"location":"api/preparation/#acenme-cap-hetatm-fix","title":"ACE/NME Cap HETATM Fix","text":"<p>Critical Note: When using protein capping (ACE/NME), pdb4amber converts cap ATOM records to HETATM records, which can cause compatibility issues with downstream tools like packmol-memgen.</p> <p>The Problem: <pre><code># Before pdb4amber (correct for caps):\nATOM      1  C   ACE A   1      12.640  -9.437  14.871  1.00  0.00      A\nATOM      2  CH3 ACE A   1      12.660 -10.927  15.173  1.00  0.00      A\n\n# After pdb4amber (incorrect - becomes heteroatom):\nHETATM    1  C   ACE A   1      12.640  -9.437  14.871  1.00  0.00           C\nHETATM    2  CH3 ACE A   1      12.660 -10.927  15.173  1.00  0.00           C\n</code></pre></p>"},{"location":"api/preparation/#method-run_pdb4amber_with_cap_fix","title":"Method: run_pdb4amber_with_cap_fix()","text":"<p>Run pdb4amber to add hydrogens and prepare PDB for AMBER, with optional ACE/NME cap HETATM fix.</p> <pre><code>run_pdb4amber_with_cap_fix(\n    input_pdb: str,\n    output_pdb: str,\n    fix_caps: bool = True,\n    pdb4amber_options: Optional[Dict[str, Any]] = None\n) -&gt; Dict[str, Any]\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>input_pdb</code> <code>str</code> Required Path to input PDB file <code>output_pdb</code> <code>str</code> Required Path for output PDB file <code>fix_caps</code> <code>bool</code> <code>True</code> If True, automatically converts ACE/NME HETATM\u2192ATOM after pdb4amber <code>pdb4amber_options</code> <code>Dict[str, Any]</code> <code>None</code> Optional dictionary of pdb4amber command-line options <p>Returns: <code>Dict[str, Any]</code> - Result dictionary with execution details</p> <p>Return Dictionary:</p> Key Type Description <code>\"success\"</code> <code>bool</code> Whether pdb4amber execution succeeded <code>\"output_file\"</code> <code>str</code> Path to the output PDB file <code>\"hetatm_fixed\"</code> <code>int</code> Number of HETATM records converted to ATOM (0 if fix_caps=False) <code>\"stdout\"</code> <code>str</code> Standard output from pdb4amber command <code>\"stderr\"</code> <code>str</code> Standard error from pdb4amber command <p>Raises:</p> <ul> <li><code>FileNotFoundError</code> - If input PDB file doesn't exist</li> <li><code>RuntimeError</code> - If pdb4amber command fails or is not found</li> </ul> <p>What This Method Does:</p> <p>Runs pdb4amber: Executes the AmberTools pdb4amber utility to:</p> <ul> <li>Prepare PDB structure for AMBER force field</li> <li>Remove problematic records</li> <li>Renumber atoms and residues if needed</li> </ul> <p>Optionally Fixes ACE/NME Caps (if <code>fix_caps=True</code>):</p> <ul> <li>Detects ACE (N-acetyl) and NME (N-methylamide) cap residues</li> <li>Converts their HETATM records back to ATOM records</li> <li>This fixes compatibility issues with tools like packmol-memgen</li> </ul> <p>The ACE/NME Cap HETATM Problem:</p> <p>When protein capping is used, pdb4amber incorrectly converts cap ATOM records to HETATM:</p> <pre><code># Before pdb4amber (correct):\nATOM      1  C   ACE A   1      12.640  -9.437  14.871  1.00  0.00           C\nATOM      2  CH3 ACE A   1      12.660 -10.927  15.173  1.00  0.00           C\n\n# After pdb4amber (incorrect - becomes heteroatom):\nHETATM    1  C   ACE A   1      12.640  -9.437  14.871  1.00  0.00           C\nHETATM    2  CH3 ACE A   1      12.660 -10.927  15.173  1.00  0.00           C\n</code></pre> <p>This causes compatibility issues because:</p> <ul> <li>packmol-memgen expects caps as ATOM records</li> <li>Other MD preparation tools may skip HETATM records</li> <li>Caps should be treated as part of the protein chain</li> </ul> <p>pdb4amber_options Dictionary:</p> <p>You can pass custom pdb4amber command-line options:</p> <pre><code>options = {\n    \"reduce\": True,        # Use reduce for hydrogen addition (default: True)\n    \"dry\": False,          # Keep water molecules (default: False)\n    \"keep-altlocs\": False, # Remove alternative locations (default: False)\n    \"strip-waters\": True,  # Remove water molecules (default: True)\n}\n</code></pre> <p>Example - Basic Usage:</p> <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\n\n# Run pdb4amber with automatic cap fix (recommended for capped proteins)\nresult = analyzer.run_pdb4amber_with_cap_fix(\n    input_pdb=\"protein_capped_ph7_ss.pdb\",\n    output_pdb=\"protein_prepared.pdb\",\n    fix_caps=True  # Default: automatically fix ACE/NME caps\n)\n\nif result['success']:\n    print(f\"\u2713 pdb4amber completed successfully\")\n    print(f\"\u2713 Output: {result['output_file']}\")\n    if result['hetatm_fixed'] &gt; 0:\n        print(f\"\u2713 Fixed {result['hetatm_fixed']} HETATM records for ACE/NME caps\")\nelse:\n    print(f\"\u2717 pdb4amber failed\")\n    print(f\"Error: {result['stderr']}\")\n</code></pre> <p>Example - Without Cap Fix:</p> <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\n\n# Run pdb4amber without cap fix (for uncapped proteins)\nresult = analyzer.run_pdb4amber_with_cap_fix(\n    input_pdb=\"protein_uncapped_ph7_ss.pdb\",\n    output_pdb=\"protein_prepared.pdb\",\n    fix_caps=False  # No cap fix needed\n)\n\nprint(f\"Success: {result['success']}\")\nprint(f\"HETATM records fixed: {result['hetatm_fixed']}\")  # Will be 0\n</code></pre> <p>Example - With Custom pdb4amber Options:</p> <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\n\n# Run with custom pdb4amber options\ncustom_options = {\n    \"dry\": False,          # Keep crystallographic waters\n    \"keep-altlocs\": True,  # Keep alternative locations\n}\n\nresult = analyzer.run_pdb4amber_with_cap_fix(\n    input_pdb=\"protein_capped_ph7_ss.pdb\",\n    output_pdb=\"protein_prepared.pdb\",\n    fix_caps=True,\n    pdb4amber_options=custom_options\n)\n\nprint(f\"pdb4amber output:\\n{result['stdout']}\")\n</code></pre> <p>Integration with Complete Workflow:</p> <pre><code>from gatewizard.core.propka import PropkaAnalyzer\nfrom gatewizard.utils.protein_capping import ProteinCapper\n\n# Step 1: Add caps\ncapper = ProteinCapper()\ncapped_file, mapping = capper.remove_hydrogens_and_cap(\"protein.pdb\")\n\n# Step 2: Run Propka analysis\nanalyzer = PropkaAnalyzer()\npka_file = analyzer.run_analysis(capped_file)\nsummary_file = analyzer.extract_summary(pka_file)\nresidues = analyzer.parse_summary(summary_file)\n\n# Step 3: Apply protonation states\nanalyzer.apply_protonation_states(\n    input_pdb=capped_file,\n    output_pdb=\"protein_capped_ph7.pdb\",\n    ph=7.4,\n    residues=residues\n)\n\n# Step 4: Apply disulfide bonds\nbonds = analyzer.detect_disulfide_bonds(capped_file)\nanalyzer.apply_disulfide_bonds(\n    input_pdb=\"protein_capped_ph7.pdb\",\n    output_pdb=\"protein_capped_ph7_ss.pdb\",\n    disulfide_bonds=bonds\n)\n\n# Step 5: Run pdb4amber with automatic cap fix\nresult = analyzer.run_pdb4amber_with_cap_fix(\n    input_pdb=\"protein_capped_ph7_ss.pdb\",\n    output_pdb=\"protein_prepared.pdb\",\n    fix_caps=True  # Critical for capped proteins!\n)\n\nprint(f\"\u2713 Final AMBER-ready structure: {result['output_file']}\")\n</code></pre> <p>GUI Behavior:</p> <p>When using the GUI:</p> <ul> <li>The \"Apply States &amp; Run pdb4amber\" button automatically uses this method</li> <li>Automatically detects when capping was used (checks capping checkbox)</li> <li>Sets <code>fix_caps=True</code> if capping was applied</li> <li>Reports number of fixed HETATM records in success message</li> <li>Displays pdb4amber output in the GUI log</li> </ul> <p>Important Notes:</p> <p>\u26a0\ufe0f When to use fix_caps=True:</p> <ul> <li>When you used protein capping (ACE/NME groups added)</li> <li>When planning to use packmol-memgen or similar tools</li> <li>When you need caps to be part of the protein chain (ATOM records)</li> </ul> <p>\u26a0\ufe0f When to use fix_caps=False:</p> <ul> <li>When no capping was applied</li> <li>When you want standard pdb4amber behavior</li> <li>When working with uncapped protein structures</li> </ul> <p>\u26a0\ufe0f Requirements:</p> <ul> <li>Requires AmberTools installation (pdb4amber command must be available)</li> <li>Input PDB should already have correct protonation states and disulfide bonds applied</li> </ul>"},{"location":"api/preparation/#complete-workflow-examples","title":"Complete Workflow Examples","text":""},{"location":"api/preparation/#advanced-workflow-with-protonation-and-disulfide-bonds","title":"Advanced Workflow with Protonation and Disulfide Bonds","text":"<pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\n\n# Step 1: Run Propka analysis\npka_file = analyzer.run_analysis(\"protein.pdb\", output_dir=\"output\")\nsummary_file = analyzer.extract_summary(pka_file, output_dir=\"output\")\nresidues = analyzer.parse_summary(summary_file)\nprint(f\"\u2713 Found {len(residues)} ionizable residues\")\n\n# Step 2: Detect disulfide bonds\nbonds = analyzer.detect_disulfide_bonds(\"protein.pdb\", distance_threshold=2.5)\nprint(f\"\u2713 Detected {len(bonds)} disulfide bonds\")\n\n# Step 3: Apply protonation states\nstats = analyzer.apply_protonation_states(\n    input_pdb=\"protein.pdb\",\n    output_pdb=\"output/protein_ph7.pdb\",\n    ph=7.4,\n    residues=residues\n)\nprint(f\"\u2713 Protonation: {stats['residue_changes']} residues, \"\n      f\"{stats['record_changes']} PDB records changed\")\n\n# Step 4: Apply disulfide bonds\nnum_bonds = analyzer.apply_disulfide_bonds(\n    input_pdb=\"output/protein_ph7.pdb\",\n    output_pdb=\"output/protein_ph7_ss.pdb\",\n    disulfide_bonds=bonds,\n    auto_detect=False\n)\nprint(f\"\u2713 Applied {num_bonds} disulfide bonds (CYS \u2192 CYX)\")\n</code></pre>"},{"location":"api/preparation/#workflow-with-protein-capping","title":"Workflow with Protein Capping","text":"<pre><code>from gatewizard.core.propka import PropkaAnalyzer\nfrom gatewizard.utils.protein_capping import ProteinCapper\n\n# Step 1: Add ACE/NME caps\ncapper = ProteinCapper()\ncapped_file, residue_mapping = capper.remove_hydrogens_and_cap(\n    input_file=\"protein.pdb\",\n    output_file=\"protein_capped.pdb\",\n    target_dir=\"output\"\n)\nprint(f\"\u2713 Capped protein: {len(residue_mapping)} residues tracked\")\n\n# Step 2: Run Propka on capped structure\nanalyzer = PropkaAnalyzer()\npka_file = analyzer.run_analysis(capped_file, output_dir=\"output\")\nsummary_file = analyzer.extract_summary(pka_file, output_dir=\"output\")\nresidues = analyzer.parse_summary(summary_file)\n\n# Step 3: Detect disulfide bonds\nbonds = analyzer.detect_disulfide_bonds(capped_file)\n\n# Step 4: Apply protonation\nstats = analyzer.apply_protonation_states(\n    input_pdb=capped_file,\n    output_pdb=\"output/protein_capped_ph7.pdb\",\n    ph=7.4,\n    residues=residues\n)\n\n# Step 5: Apply disulfide bonds\nnum_bonds = analyzer.apply_disulfide_bonds(\n    input_pdb=\"output/protein_capped_ph7.pdb\",\n    output_pdb=\"output/protein_capped_ph7_ss.pdb\",\n    disulfide_bonds=bonds,\n    auto_detect=False\n)\n\n# Step 6: Run pdb4amber with automatic ACE/NME HETATM fix\nresult = analyzer.run_pdb4amber_with_cap_fix(\n    input_pdb=\"output/protein_capped_ph7_ss.pdb\",\n    output_pdb=\"output/protein_prepared.pdb\",\n    fix_caps=True  # Automatically fix ACE/NME HETATM records\n)\n\nprint(f\"\u2713 pdb4amber completed: {result['output_file']}\")\nif result['hetatm_fixed'] &gt; 0:\n    print(f\"\u2713 Fixed {result['hetatm_fixed']} HETATM records for ACE/NME caps\")\nprint(f\"\u2713 Final structure ready: protein_prepared.pdb\")\n</code></pre>"},{"location":"api/preparation/#multiple-ph-variants","title":"Multiple pH Variants","text":"<pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\nanalyzer = PropkaAnalyzer()\n\n# Run analysis once\npka_file = analyzer.run_analysis(\"protein.pdb\", output_dir=\"output\")\nsummary_file = analyzer.extract_summary(pka_file, output_dir=\"output\")\nresidues = analyzer.parse_summary(summary_file)\nbonds = analyzer.detect_disulfide_bonds(\"protein.pdb\")\n\n# Generate structures for different pH values\nfor ph in [5.0, 6.0, 7.0, 7.4, 8.0, 9.0]:\n    # Apply protonation\n    stats = analyzer.apply_protonation_states(\n        input_pdb=\"protein.pdb\",\n        output_pdb=f\"output/protein_ph{ph:.1f}.pdb\",\n        ph=ph,\n        residues=residues\n    )\n\n    # Apply disulfide bonds\n    analyzer.apply_disulfide_bonds(\n        input_pdb=f\"output/protein_ph{ph:.1f}.pdb\",\n        output_pdb=f\"output/protein_ph{ph:.1f}_ss.pdb\",\n        disulfide_bonds=bonds,\n        auto_detect=False\n    )\n\n    print(f\"pH {ph:.1f}: {stats['residue_changes']} residues modified, \"\n          f\"{len(bonds)} S-S bonds\")\n</code></pre>"},{"location":"api/preparation/#advanced-topics","title":"Advanced Topics","text":""},{"location":"api/preparation/#residue-mapping-after-capping","title":"Residue Mapping After Capping","text":"<p>When proteins are capped, residue numbers change (all shift by +1). Use the mapping dictionary to translate:</p> <pre><code>import re\nfrom gatewizard.core.propka import PropkaAnalyzer\nfrom gatewizard.utils.protein_capping import ProteinCapper\n\n# Step 1: Add ACE/NME caps to get residue mapping\ncapper = ProteinCapper()\ncapped_file, residue_mapping = capper.remove_hydrogens_and_cap(\n    input_file=\"protein.pdb\",\n    output_file=\"protein_capped.pdb\",\n    target_dir=\"output\"\n)\nprint(f\"\u2713 Capped protein with {len(residue_mapping)} residues tracked\")\n\n# Step 2: Run Propka analysis on capped structure\nanalyzer = PropkaAnalyzer()\npka_file = analyzer.run_analysis(capped_file, output_dir=\"output\")\nsummary_file = analyzer.extract_summary(pka_file, output_dir=\"output\")\nresidues = analyzer.parse_summary(summary_file)\nprint(f\"\u2713 Analyzed {len(residues)} ionizable residues\")\n\n# Step 3: Define custom states using ORIGINAL (uncapped) numbering\noriginal_custom_states = {\n    \"ASP12\": \"ASH\",  # Force protonate ASP at original position 12\n    \"GLU13\": \"GLH\"   # Force protonate GLU at original position 13\n}\n\n# Step 4: Translate to NEW numbering after capping (all shifted by +1)\ncustom_states_new = {}\nfor orig_spec, state in original_custom_states.items():\n    match = re.match(r'([A-Z]+)(\\d+)(?:_([A-Z]))?', orig_spec)\n    if match:\n        resname, resid, chain = match.groups()\n        resid = int(resid)\n        chain = chain or \"A\"\n\n        # Look up the new numbering from mapping\n        original_key = (resname, chain, resid)\n        if original_key in residue_mapping:\n            new_resname, new_chain, new_resid = residue_mapping[original_key]\n            new_spec = f\"{new_resname}{new_resid}_{new_chain}\"\n            custom_states_new[new_spec] = state\n            print(f\"  Mapped {orig_spec} \u2192 {new_spec} ({state})\")\n        else:\n            print(f\"  Warning: {orig_spec} not found in mapping\")\n\n# Step 5: Apply protonation states using the TRANSLATED custom states\nstats = analyzer.apply_protonation_states(\n    input_pdb=capped_file,\n    output_pdb=\"output/protein_capped_custom.pdb\",\n    ph=7.4,\n    custom_states=custom_states_new,  # Use translated states\n    residues=residues\n)\nprint(f\"\u2713 Applied protonation: {stats['residue_changes']} residues modified\")\n</code></pre> <p>Example Output: <pre><code>\u2713 Capped protein with 50 residues tracked\n\u2713 Analyzed 12 ionizable residues\n  Mapped ASP12 \u2192 ASP13_A (ASH)\n  Mapped GLU13 \u2192 GLU14_A (GLH)\n\u2713 Applied protonation: 12 residues modified\n</code></pre></p>"},{"location":"api/preparation/#custom-protonation-states","title":"Custom Protonation States","text":"<p>Override automatic pH-based protonation with custom states for specific residues:</p> <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\n# Step 1: Run standard Propka workflow\nanalyzer = PropkaAnalyzer()\npka_file = analyzer.run_analysis(\"protein.pdb\", output_dir=\"output\")\nsummary_file = analyzer.extract_summary(pka_file, output_dir=\"output\")\nresidues = analyzer.parse_summary(summary_file)\nprint(f\"\u2713 Analyzed {len(residues)} ionizable residues\")\n\n# Step 2: Specify custom states to override automatic pH-based assignment\ncustom_states = {\n    \"ASP12_A\": \"ASH\",  # Force protonated aspartate in chain A\n    \"HIS15_A\": \"HID\",  # Force delta-protonated histidine (instead of HIE or HIP)\n    \"GLU22\": \"GLH\"     # Force protonated in all chains\n}\n\n# Step 3: Apply protonation with custom overrides\nstats = analyzer.apply_protonation_states(\n    input_pdb=\"protein.pdb\",\n    output_pdb=\"output/protein_custom.pdb\",\n    ph=7.4,\n    custom_states=custom_states,\n    residues=residues\n)\nprint(f\"\u2713 Modified {stats['residue_changes']} residues ({stats['record_changes']} atoms)\")\nprint(f\"  Custom states applied: {len(custom_states)}\")\n\n# Step 4: Verify the changes\nfor spec, state in custom_states.items():\n    print(f\"  {spec} \u2192 {state}\")\n</code></pre> <p>Example Output: <pre><code>\u2713 Analyzed 13 ionizable residues\n\u2713 Modified 3 residues (44 atoms)\n  Custom states applied: 3\n  ASP12_A \u2192 ASH\n  HIS15_A \u2192 HID\n  GLU22 \u2192 GLH\n</code></pre></p> <p>Use Cases:</p> <ul> <li>Force specific protonation for catalytic residues</li> <li>Match experimental conditions or known structures</li> <li>Test different protonation hypotheses</li> <li>Override PROPKA predictions based on domain knowledge</li> </ul>"},{"location":"api/preparation/#filtering-and-analysis","title":"Filtering and Analysis","text":"<p>Identify residues with unusual pKa shifts that may indicate important interactions:</p> <pre><code>from gatewizard.core.propka import PropkaAnalyzer\n\n# Step 1: Run Propka analysis\nanalyzer = PropkaAnalyzer()\npka_file = analyzer.run_analysis(\"protein.pdb\", output_dir=\"output\")\nsummary_file = analyzer.extract_summary(pka_file, output_dir=\"output\")\nresidues = analyzer.parse_summary(summary_file)\n\n# Step 2: Define expected model pKa values\n# NOTE: These are typical model pKa values for reference only.\n# For reliable interpretation, use validated reference values appropriate for your system\n# (e.g., from experimental data, literature, or established databases like PROPKA's model values)\nexpected_pka = {\n    'ASP': 3.9, 'GLU': 4.3, 'HIS': 6.0,\n    'LYS': 10.5, 'ARG': 12.5, 'CYS': 8.3, 'TYR': 10.1\n}\n\n# Step 3: Find residues with significant pKa shifts (&gt;1.0 units)\nprint(\"Residues with unusual pKa shifts (&gt;1.0 units):\")\nprint(\"=\" * 70)\n\nshifted_residues = []\nfor res in residues:\n    # Only analyze protein residues (skip ligands)\n    if res['res_id'] == 0:\n        continue\n\n    res_name = res['residue']\n    if res_name in expected_pka:\n        pka_diff = abs(res['pka'] - expected_pka[res_name])\n        if pka_diff &gt; 1.0:\n            shifted_residues.append({\n                'id': f\"{res_name}{res['res_id']}_{res['chain']}\",\n                'type': res_name,\n                'pka': res['pka'],\n                'expected': expected_pka[res_name],\n                'shift': res['pka'] - expected_pka[res_name]\n            })\n            print(f\"{res_name}{res['res_id']:3d} (Chain {res['chain']}): \"\n                  f\"pKa={res['pka']:5.2f} (expected ~{expected_pka[res_name]:.1f}, \"\n                  f\"shift={res['pka'] - expected_pka[res_name]:+.1f})\")\n\nprint(f\"\\nSummary: Found {len(shifted_residues)} residues with significant pKa shifts\")\n\n# Step 4: Categorize by shift direction\nupshifted = [r for r in shifted_residues if r['shift'] &gt; 1.0]\ndownshifted = [r for r in shifted_residues if r['shift'] &lt; -1.0]\n\nprint(f\"  Upshifted (more basic): {len(upshifted)}\")\nprint(f\"  Downshifted (more acidic): {len(downshifted)}\")\n\n# Step 5: Find extreme cases (&gt;2.0 units shift)\nextreme_shifts = [r for r in shifted_residues if abs(r['shift']) &gt; 2.0]\nif extreme_shifts:\n    print(f\"\\n\u26a0 Extreme shifts (&gt;2.0 units): {len(extreme_shifts)}\")\n    for r in extreme_shifts:\n        print(f\"  {r['id']}: {r['shift']:+.2f} units\")\n</code></pre> <p>Example Output: <pre><code>Residues with unusual pKa shifts (&gt;1.0 units):\n======================================================================\nASP 42 (Chain A): pKa= 6.23 (expected ~3.9, shift=+2.3)\nGLU 58 (Chain A): pKa= 2.15 (expected ~4.3, shift=-2.2)\nHIS 77 (Chain A): pKa= 8.45 (expected ~6.0, shift=+2.5)\nLYS115 (Chain A): pKa= 8.32 (expected ~10.5, shift=-2.2)\nCYS128 (Chain A): pKa=10.87 (expected ~8.3, shift=+2.6)\n\nSummary: Found 5 residues with significant pKa shifts\n  Upshifted (more basic): 3\n  Downshifted (more acidic): 2\n\n\u26a0 Extreme shifts (&gt;2.0 units): 5\n  ASP42_A: +2.33 units\n  GLU58_A: -2.15 units\n  HIS77_A: +2.45 units\n  LYS115_A: -2.18 units\n  CYS128_A: +2.57 units\n</code></pre></p> <p>Interpretation:</p> <ul> <li>Large upshifts (more basic): May indicate buried residues, salt bridges, or hydrogen bonding networks</li> <li>Large downshifts (more acidic): May indicate proximity to positive charges or unusual electrostatic environments</li> <li>Extreme shifts (&gt;2 units): Often mark functionally important residues like active sites, binding pockets, or structural switches</li> </ul>"},{"location":"api/preparation/#important-notes","title":"Important Notes","text":""},{"location":"api/preparation/#output-directory-behavior","title":"Output Directory Behavior","text":"<p>\u26a0\ufe0f Important: When using <code>output_dir</code>, the code automatically:</p> <ul> <li>Creates the directory if it doesn't exist</li> <li>Converts input file paths to absolute paths</li> <li>Places all output files in the specified directory</li> </ul>"},{"location":"api/preparation/#pdb-records-vs-residues","title":"PDB Records vs Residues","text":"<p>\u26a0\ufe0f Important distinction:</p> <ul> <li>Residue changes: Number of unique residues modified</li> <li>PDB record changes: Number of ATOM/HETATM lines modified</li> </ul> <p>Example: Changing 1 histidine residue with 10 atoms:</p> <ul> <li><code>residue_changes</code> = 1</li> <li><code>record_changes</code> = 10</li> </ul>"},{"location":"api/preparation/#dictionary-key-names","title":"Dictionary Key Names","text":"<p>\u26a0\ufe0f Common Mistake: The parsed residues use these exact key names:</p> <ul> <li>\u2713 Correct: <code>res['residue']</code> (not <code>res['residue_name']</code>)</li> <li>\u2713 Correct: <code>res['res_id']</code> (not <code>res['residue_number']</code>)</li> <li>\u2713 Correct: <code>res['chain']</code> (not <code>res['chain_id']</code>)</li> <li>\u2713 Correct: <code>res['atom']</code> (atom name for ligands, empty for protein residues)</li> <li>\u2713 Correct: <code>res['atom_type']</code> (atom type classification like 'N31', 'OCO', 'OP')</li> </ul> <p>Note on Ligands:</p> <ul> <li>Protein residues have <code>res_id &gt; 0</code>, <code>atom == ''</code>, <code>atom_type == ''</code></li> <li>Ligand atoms have <code>res_id == 0</code>, <code>atom</code> contains atom name, <code>atom_type</code> contains classification</li> <li>Use <code>res_id</code> to distinguish: <code>if res['res_id'] &gt; 0:</code> \u2192 protein, else \u2192 ligand</li> </ul>"},{"location":"api/preparation/#output-files","title":"Output Files","text":"<p>The analysis generates several files: - <code>*.pka</code> - Full Propka output - <code>*_summary_of_prediction.txt</code> - Extracted summary section - <code>*_protonated.pdb</code> - After applying protonation states - <code>*_ss.pdb</code> - After applying disulfide bonds - <code>*_gatewizard_residue_mapping.txt</code> - Residue mapping (if capping used)</p>"},{"location":"images/","title":"Documentation Images","text":"<p>This directory contains all images used in the GateWizard documentation.</p>"},{"location":"images/#directory-structure","title":"Directory Structure","text":"<pre><code>docs/images/\n\u251c\u2500\u2500 api/              # Images for API reference documentation\n\u2502   \u251c\u2500\u2500 propka_titration_curves.png\n\u2502   \u251c\u2500\u2500 propka_pka_distribution.png\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 user-guide/       # Images for user guide\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 installation/     # Images for installation guide\n\u2502   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 troubleshooting/  # Images for troubleshooting\n    \u2514\u2500\u2500 ...\n</code></pre>"},{"location":"images/#guidelines","title":"Guidelines","text":""},{"location":"images/#file-naming-convention","title":"File Naming Convention","text":"<ul> <li>Use lowercase with underscores: <code>module_feature_description.png</code></li> <li>Be descriptive: <code>propka_titration_curves.png</code> instead of <code>figure1.png</code></li> <li>Include module/section prefix for organization</li> </ul>"},{"location":"images/#image-formats","title":"Image Formats","text":"<ul> <li>PNG: Preferred for plots, screenshots, diagrams (lossless compression)</li> <li>SVG: For vector graphics, logos, diagrams (scalable)</li> <li>JPG: For photos only (lossy compression)</li> </ul>"},{"location":"images/#image-dimensions","title":"Image Dimensions","text":"<ul> <li>Plots/Figures: 1200-2400px wide (for high-DPI displays)</li> <li>Screenshots: Actual size or scaled to fit documentation width</li> <li>Icons: 64px, 128px, or 256px square</li> </ul>"},{"location":"images/#dpi-requirements","title":"DPI Requirements","text":"<ul> <li>Save matplotlib figures at 300 DPI for publication quality</li> <li>Use <code>plt.savefig('filename.png', dpi=300, bbox_inches='tight')</code></li> </ul>"},{"location":"images/#referencing-images-in-markdown","title":"Referencing Images in Markdown","text":""},{"location":"images/#relative-path-format","title":"Relative Path Format","text":"<p>From <code>docs/api/preparation.md</code>: <pre><code>![Alt Text](../images/api/propka_titration_curves.png)\n</code></pre></p> <p>From <code>docs/user-guide.md</code>: <pre><code>![Alt Text](images/user-guide/example.png)\n</code></pre></p>"},{"location":"images/#with-caption","title":"With Caption","text":"<pre><code>![Titration Curves](../images/api/propka_titration_curves.png)\n\n*Figure: Description of the figure with relevant details.*\n</code></pre>"},{"location":"images/#inline-with-width-control","title":"Inline with Width Control","text":"<pre><code>&lt;img src=\"../images/api/propka_titration_curves.png\" alt=\"Titration Curves\" width=\"800\"&gt;\n</code></pre>"},{"location":"images/#image-optimization","title":"Image Optimization","text":"<p>Before committing images: - Compress PNG files: <code>optipng -o7 *.png</code> or <code>pngcrush</code> - Keep file sizes &lt; 500KB when possible - For large plots, consider linking to full-resolution version</p>"},{"location":"images/#adding-new-images","title":"Adding New Images","text":"<ol> <li>Generate your image/figure</li> <li>Save to appropriate subdirectory in <code>docs/images/</code></li> <li>Follow naming convention</li> <li>Reference in documentation using relative path</li> <li>Add caption/description below image</li> <li>Commit both image and documentation update</li> </ol>"},{"location":"images/ORGANIZATION_GUIDE/","title":"Image Organization Guide for GateWizard Documentation","text":""},{"location":"images/ORGANIZATION_GUIDE/#directory-structure-created","title":"\u2705 Directory Structure Created","text":"<pre><code>docs/\n\u251c\u2500\u2500 images/\n\u2502   \u251c\u2500\u2500 README.md                    # Complete guidelines\n\u2502   \u251c\u2500\u2500 api/                         # API reference figures\n\u2502   \u2502   \u2514\u2500\u2500 PLACEHOLDER_propka_titration_curves.txt\n\u2502   \u251c\u2500\u2500 user-guide/                  # User guide screenshots\n\u2502   \u251c\u2500\u2500 installation/                # Installation process images\n\u2502   \u251c\u2500\u2500 troubleshooting/             # Troubleshooting diagrams\n\u2502   \u2514\u2500\u2500 examples/                    # Example outputs\n</code></pre>"},{"location":"images/ORGANIZATION_GUIDE/#how-to-add-figures-to-documentation","title":"\ud83d\udcdd How to Add Figures to Documentation","text":""},{"location":"images/ORGANIZATION_GUIDE/#1-generate-your-figure","title":"1. Generate Your Figure","text":"<p>When creating figures with matplotlib, save them directly to the docs/images directory:</p> <pre><code>import matplotlib.pyplot as plt\n\n# ... your plotting code ...\n\n# Save to appropriate subdirectory\nplt.savefig('docs/images/api/propka_titration_curves.png', \n            dpi=300, bbox_inches='tight')\n</code></pre>"},{"location":"images/ORGANIZATION_GUIDE/#2-reference-in-markdown","title":"2. Reference in Markdown","text":"<p>In your markdown file (e.g., <code>docs/api/preparation.md</code>), add:</p> <pre><code>![Titration Curves](../images/api/propka_titration_curves.png)\n\n*Figure: Description of the figure.*\n</code></pre> <p>Path Notes: - From <code>docs/api/preparation.md</code> \u2192 use <code>../images/api/filename.png</code> - From <code>docs/user-guide.md</code> \u2192 use <code>images/user-guide/filename.png</code> - From <code>docs/index.md</code> \u2192 use <code>images/filename.png</code></p>"},{"location":"images/ORGANIZATION_GUIDE/#3-file-naming-convention","title":"3. File Naming Convention","text":"<p>\u2705 Good: - <code>propka_titration_curves.png</code> - <code>system_builder_workflow.png</code> - <code>equilibration_namd_setup.png</code></p> <p>\u274c Avoid: - <code>figure1.png</code> - <code>Screenshot 2025-01-15.png</code> - <code>Untitled.png</code></p>"},{"location":"images/ORGANIZATION_GUIDE/#image-best-practices","title":"\ud83c\udfa8 Image Best Practices","text":""},{"location":"images/ORGANIZATION_GUIDE/#for-matplotlib-figures","title":"For Matplotlib Figures","text":"<pre><code>fig, ax = plt.subplots(figsize=(10, 6))\n# ... plotting code ...\nplt.tight_layout()\nplt.savefig('docs/images/api/figure_name.png', \n            dpi=300,                      # High resolution\n            bbox_inches='tight',          # No whitespace\n            facecolor='white',            # White background\n            edgecolor='none')             # No border\n</code></pre>"},{"location":"images/ORGANIZATION_GUIDE/#recommended-dimensions","title":"Recommended Dimensions","text":"<ul> <li>Standard plot: 10\u00d76 inches at 300 DPI = 3000\u00d71800 pixels</li> <li>Wide plot: 12\u00d76 inches at 300 DPI = 3600\u00d71800 pixels</li> <li>Square plot: 8\u00d78 inches at 300 DPI = 2400\u00d72400 pixels</li> </ul>"},{"location":"images/ORGANIZATION_GUIDE/#image-optimization","title":"Image Optimization","text":"<p>After generating, optionally compress: <pre><code># PNG optimization (lossless)\noptipng -o7 docs/images/api/*.png\n\n# Or using pngcrush\npngcrush -brute input.png output.png\n</code></pre></p>"},{"location":"images/ORGANIZATION_GUIDE/#organization-by-section","title":"\ud83d\udcc2 Organization by Section","text":""},{"location":"images/ORGANIZATION_GUIDE/#api-reference-docsimagesapi","title":"API Reference (<code>docs/images/api/</code>)","text":"<ul> <li>Method outputs</li> <li>Class diagrams</li> <li>Algorithm visualizations</li> <li>Example results</li> </ul>"},{"location":"images/ORGANIZATION_GUIDE/#user-guide-docsimagesuser-guide","title":"User Guide (<code>docs/images/user-guide/</code>)","text":"<ul> <li>GUI screenshots</li> <li>Workflow diagrams</li> <li>Tutorial images</li> </ul>"},{"location":"images/ORGANIZATION_GUIDE/#installation-docsimagesinstallation","title":"Installation (<code>docs/images/installation/</code>)","text":"<ul> <li>Installation steps</li> <li>Environment setup</li> <li>Dependency diagrams</li> </ul>"},{"location":"images/ORGANIZATION_GUIDE/#troubleshooting-docsimagestroubleshooting","title":"Troubleshooting (<code>docs/images/troubleshooting/</code>)","text":"<ul> <li>Error screenshots</li> <li>Solution diagrams</li> <li>Before/after comparisons</li> </ul>"},{"location":"images/ORGANIZATION_GUIDE/#examples-docsimagesexamples","title":"Examples (<code>docs/images/examples/</code>)","text":"<ul> <li>Complete workflow outputs</li> <li>Sample results</li> <li>Use case demonstrations</li> </ul>"},{"location":"images/ORGANIZATION_GUIDE/#advanced-usage","title":"\ud83d\udd17 Advanced Usage","text":""},{"location":"images/ORGANIZATION_GUIDE/#with-captions-and-alt-text","title":"With Captions and Alt Text","text":"<pre><code>![Titration curves for ASP12, GLU13, and CYS38](../images/api/propka_titration_curves.png)\n\n*Figure 1: Protonation state transitions across pH 2-12 for selected residues. \nThe vertical dashed line indicates physiological pH (7.4). ASP12 and GLU13 \ntransition at low pH, while CYS38 remains deprotonated across the range.*\n</code></pre>"},{"location":"images/ORGANIZATION_GUIDE/#controlling-size-with-html","title":"Controlling Size with HTML","text":"<pre><code>&lt;p align=\"center\"&gt;\n  &lt;img src=\"../images/api/propka_titration_curves.png\" \n       alt=\"Titration Curves\" \n       width=\"800\"&gt;\n&lt;/p&gt;\n&lt;p align=\"center\"&gt;&lt;em&gt;Figure 1: Protein titration curves&lt;/em&gt;&lt;/p&gt;\n</code></pre>"},{"location":"images/ORGANIZATION_GUIDE/#side-by-side-images","title":"Side-by-Side Images","text":"<pre><code>| Before | After |\n|--------|-------|\n| ![Before](../images/examples/before.png) | ![After](../images/examples/after.png) |\n</code></pre>"},{"location":"images/ORGANIZATION_GUIDE/#quick-checklist","title":"\ud83d\udccb Quick Checklist","text":"<p>When adding a new figure:</p> <ul> <li>[ ] Image saved in appropriate <code>docs/images/</code> subdirectory</li> <li>[ ] Filename uses lowercase with underscores</li> <li>[ ] Saved at 300 DPI for quality</li> <li>[ ] Referenced in markdown with correct relative path</li> <li>[ ] Alt text provided for accessibility</li> <li>[ ] Caption/description added below image</li> <li>[ ] File size reasonable (&lt; 1MB preferred)</li> <li>[ ] Image added to git and committed</li> </ul>"},{"location":"images/ORGANIZATION_GUIDE/#current-example","title":"\ud83d\udd0d Current Example","text":"<p>Updated <code>docs/api/preparation.md</code> with: - Image reference: <code>![Titration Curves](../images/api/propka_titration_curves.png)</code> - Location: Line ~743 - Expected image: <code>docs/images/api/propka_titration_curves.png</code></p> <p>To create the actual image, run the plotting code from the example and save with: <pre><code>plt.savefig('docs/images/api/propka_titration_curves.png', dpi=300, bbox_inches='tight')\n</code></pre></p>"},{"location":"images/QUICK_START/","title":"Quick Reference: Adding Figures to Documentation","text":""},{"location":"images/QUICK_START/#file-structure","title":"File Structure","text":"<pre><code>docs/\n\u251c\u2500\u2500 api/preparation.md                      (your markdown file)\n\u2514\u2500\u2500 images/\n    \u2514\u2500\u2500 api/\n        \u2514\u2500\u2500 propka_titration_curves.png     (your image)\n</code></pre>"},{"location":"images/QUICK_START/#in-your-python-code","title":"In Your Python Code","text":"<pre><code># Generate figure\nplt.savefig('docs/images/api/propka_titration_curves.png', \n            dpi=300, bbox_inches='tight')\n</code></pre>"},{"location":"images/QUICK_START/#in-your-markdown-docsapipreparationmd","title":"In Your Markdown (docs/api/preparation.md)","text":"<pre><code>![Titration Curves](../images/api/propka_titration_curves.png)\n\n*Figure: Description here.*\n</code></pre>"},{"location":"images/QUICK_START/#path-rules","title":"Path Rules","text":"<ul> <li>From <code>docs/api/file.md</code> \u2192 use <code>../images/api/image.png</code> (go up one level)</li> <li>From <code>docs/file.md</code> \u2192 use <code>images/api/image.png</code> (same level)</li> <li>From <code>docs/section/file.md</code> \u2192 use <code>../images/api/image.png</code> (go up one level)</li> </ul>"},{"location":"images/QUICK_START/#thats-it","title":"That's it! \ud83c\udf89","text":""}]}